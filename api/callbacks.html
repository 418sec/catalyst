


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Callbacks &mdash; Catalyst 20.12.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="../_static/pygments.css" type="text/css" /> -->
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Contrib" href="contrib.html" />
    <link rel="prev" title="Optuna integration" href="../faq/optuna.html" /> 

  
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-167094275-1"></script>
  <script src="../_static/js/googleanalytics.min.js"></script>
  
  <script src="../_static/js/modernizr.min.js"></script>

  <!-- Preload the theme fonts -->

<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://catalyst-team.com/" aria-label="Catalyst"></a>

      <div class="main-menu">
        <ul>

          <li>
            <div class="ecosystem-dropdown">
              <a id="dropdownMenuButtonEcosystem" data-toggle="ecosystem-dropdown">
                Ecosystem
              </a>
              <div class="ecosystem-dropdown-menu">
                <a class="nav-dropdown-item" href="https://alchemy.host">
                  <span class=dropdown-title>Alchemy</span>
                  <p>Experiments logging & visualization</p>
                </a>
                <a class="nav-dropdown-item" href="https://github.com/catalyst-team/catalyst">
                  <span class=dropdown-title>Catalyst</span>
                  <p>Accelerated deep learning R&D</p>
                </a>
                <a class="nav-dropdown-item" href="https://github.com/catalyst-team/reaction">
                  <span class=dropdown-title>Reaction</span>
                  <p>Convenient deep learning models serving</p>
                </a>
              </div>
            </div>
          </li>

          <li>
            <div class="projects-dropdown">
              <a id="dropdownMenuButtonProjects" data-toggle="projects-dropdown">
                Projects
              </a>
              <div class="projects-dropdown-menu">
                <a class="nav-dropdown-item" href="https://github.com/catalyst-team/codestyle">
                  <span class=dropdown-title>Codestyle</span>
                  <p>Joint R&D codestyle</p>
                </a>
                <a class="nav-dropdown-item" href="https://github.com/catalyst-team/neuro">
                  <span class=dropdown-title>Catalyst.Neuro</span>
                  <p>Catalyst.Team and TReNDS collaborative project</p>
                </a>
                <a class="nav-dropdown-item" href="https://github.com/catalyst-team/classification">
                  <span class=dropdown-title>Classification</span>
                  <p>Image classification pipeline with transfer learning</p>
                </a>
                <a class="nav-dropdown-item" href="https://github.com/catalyst-team/detection">
                  <span class=dropdown-title>Detection</span>
                  <p>Object detection pipeline</p>
                </a>
                <a class="nav-dropdown-item" href="https://github.com/catalyst-team/segmentation">
                  <span class=dropdown-title>Segmentation</span>
                  <p>Image semantic segmentation pipeline</p>
                </a>
                <a class="nav-dropdown-item" href="https://github.com/catalyst-team/gan">
                  <span class=dropdown-title>Catalyst.GAN</span>
                  <p>GAN pipelines</p>
                </a>
              </div>
            </div>
          </li>

          <li>
            <a href="https://github.com/catalyst-team/dl-course">Deep learning course</a>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>

  </div>
</div>


<body class="catalyst-body">

   

    

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="catalyst-left-menu" id="catalyst-left-menu">
      <div class="catalyst-side-scroll">
        <div class="catalyst-menu catalyst-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="catalyst-left-menu-search">
            

            
              
              
                <div class="version">
                  <a href="https://catalyst-team.github.io/catalyst/versions.html">20.12</a>
                </div>
              
            

            


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

            
          </div>

          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Catalyst</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/quickstart.html">Quickstart 101</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/catalyst-team/catalyst#minimal-examples">Minimal examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/migrating_from_other.html">Migrating from other libraries</a></li>
<li class="toctree-l1"><a class="reference external" href="https://medium.com/pytorch/catalyst-101-accelerated-pytorch-bd766a556d92?source=friends_link&amp;sk=d3dd9b2b23500eca046361187b4619ff">Catalyst 101 — Accelerated PyTorch</a></li>
<li class="toctree-l1"><a class="reference external" href="https://medium.com/pytorch/catalyst-102-core-trinity-experiment-runner-and-callback-54adc384b57c?source=friends_link&amp;sk=2aff824412e2f653587a30cd853b030c">Catalyst 102 — Core Trinity</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/ddp.html">Distributed training tutorial</a></li>
</ul>
<p class="caption"><span class="caption-text">Core</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../core/experiment.html">Experiment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/runner.html">Runner</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/callback.html">Callback</a></li>
</ul>
<p class="caption"><span class="caption-text">FAQ</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../faq/intro.html">How to make X?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/data.html">Dataflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/lr_finder.html">[WIP] Learning Rate Finder</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/dp.html">DataParallel training (cpu, single/multi-gpu)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/amp.html">Mixed precision training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/ddp.html">Distributed training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/slurm.html">Slurm training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/tpu.html">TPU training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/multi_components.html">Multiple components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/early_stopping.html">Early stopping</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/checkpointing.html">Model checkpointing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/debugging.html">Model debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/inference.html">Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/finetuning.html">[WIP] Finetuning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/stages.html">[WIP] Multi-stage experiments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/config_api.html">[WIP] Config API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/optuna.html">Optuna integration</a></li>
</ul>
<p class="caption"><span class="caption-text">Contribution guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/catalyst-team/catalyst/blob/master/CONTRIBUTING.md">How to start</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/catalyst-team/codestyle">Codestyle</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/catalyst-team/catalyst#acknowledgments">Acknowledgments</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Callbacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="contrib.html">Contrib</a></li>
<li class="toctree-l1"><a class="reference internal" href="core.html">Core</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html">Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="experiments.html">Experiments</a></li>
<li class="toctree-l1"><a class="reference internal" href="metrics.html">Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="registry.html">Registry</a></li>
<li class="toctree-l1"><a class="reference internal" href="runners.html">Runners</a></li>
<li class="toctree-l1"><a class="reference internal" href="settings.html">Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="tools.html">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="typing.html">Typing</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">Utilities</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <div class="catalyst-container">
      <div class="catalyst-page-level-bar" id="catalyst-page-level-bar">
        <div class="catalyst-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="catalyst-breadcrumbs">
    
      <li>
        <a href="../index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
      <li>Callbacks</li>
    
    
      <li class="catalyst-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/catalyst-team/catalyst/blob/master/docs/api/callbacks.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="catalyst-shortcuts-wrapper" id="catalyst-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="catalyst-content-wrap" class="catalyst-content-wrap">
        <div class="catalyst-content-left">
          
          <div class="rst-content">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="catalyst-article" class="catalyst-article">
              
  <div class="section" id="callbacks">
<h1>Callbacks<a class="headerlink" href="#callbacks" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#module-catalyst.callbacks" id="id1">Main</a></p>
<ul>
<li><p><a class="reference internal" href="#module-catalyst.callbacks.batch_overfit" id="id2">BatchOverfitCallback</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.callbacks.checkpoint" id="id3">Checkpoint</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.callbacks.control_flow" id="id4">Control Flow</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.callbacks.criterion" id="id5">Criterion</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.callbacks.early_stop" id="id6">Early Stop</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.callbacks.exception" id="id7">Exception</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.callbacks.logging" id="id8">Logging</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.callbacks.metric" id="id9">Metric</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.callbacks.optimizer" id="id10">Optimizer</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.callbacks.periodic_loader" id="id11">PeriodicLoaderCallback</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.callbacks.pruning" id="id12">Pruning</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.callbacks.quantization" id="id13">Quantization</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.callbacks.scheduler" id="id14">Scheduler</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.callbacks.timer" id="id15">Timer</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.callbacks.tracing" id="id16">Tracing</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.callbacks.validation" id="id17">Validation</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#module-catalyst.callbacks.metrics" id="id18">Metrics</a></p>
<ul>
<li><p><a class="reference internal" href="#module-catalyst.callbacks.metrics.accuracy" id="id19">Accuracy</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.callbacks.metrics.auc" id="id20">AUC</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.callbacks.metrics.cmc_score" id="id21">CMC score</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.callbacks.metrics.dice" id="id22">Dice</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.callbacks.metrics.f1_score" id="id23">F1 score</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.callbacks.metrics.iou" id="id24">IOU</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.callbacks.metrics.mrr" id="id25">MRR</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.callbacks.metrics.perplexity" id="id26">Perplexity</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.callbacks.metrics.precision" id="id27">Precision</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.callbacks.metrics.recall" id="id28">Recall</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.callbacks.metrics.ppv_tpr_f1" id="id29">Global precision, recall and F1-score</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#module-catalyst.contrib.callbacks" id="id30">Contrib</a></p>
<ul>
<li><p><a class="reference internal" href="#module-catalyst.contrib.callbacks.alchemy_logger" id="id31">AlchemyLogger</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.contrib.callbacks.confusion_matrix_logger" id="id32">ConfusionMatrixCallback</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.contrib.callbacks.cutmix_callback" id="id33">CutmixCallback</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.contrib.callbacks.gradnorm_logger" id="id34">GradNormLogger</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.contrib.callbacks.inference_callback" id="id35">InferCallback</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.contrib.callbacks.kornia_transform" id="id36">BatchTransformCallback</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.contrib.callbacks.mask_inference" id="id37">InferMaskCallback</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.contrib.callbacks.draw_masks_callback" id="id38">DrawMasksCallback</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.contrib.callbacks.mixup_callback" id="id39">MixupCallback</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.contrib.callbacks.neptune_logger" id="id40">NeptuneLogger</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.contrib.callbacks.optuna_callback" id="id41">OptunaCallback</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.contrib.callbacks.telegram_logger" id="id42">TelegramLogger</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.contrib.callbacks.wandb_logger" id="id43">WandbLogger</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="module-catalyst.callbacks">
<span id="main"></span><h2><a class="toc-backref" href="#id1">Main</a><a class="headerlink" href="#module-catalyst.callbacks" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-catalyst.callbacks.batch_overfit">
<span id="batchoverfitcallback"></span><h3><a class="toc-backref" href="#id2">BatchOverfitCallback</a><a class="headerlink" href="#module-catalyst.callbacks.batch_overfit" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.batch_overfit.BatchOverfitCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.batch_overfit.</code><code class="sig-name descname">BatchOverfitCallback</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/batch_overfit.html#BatchOverfitCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.batch_overfit.BatchOverfitCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>Callback for ovefitting loaders with specified number of batches.
By default we use <code class="docutils literal notranslate"><span class="pre">1</span></code> batch for loader.</p>
<p>For example, if you have <code class="docutils literal notranslate"><span class="pre">train</span></code>, <code class="docutils literal notranslate"><span class="pre">train_additional</span></code>,
<code class="docutils literal notranslate"><span class="pre">valid</span></code> and <code class="docutils literal notranslate"><span class="pre">valid_additional</span></code> loaders and wan’t to overfit
<code class="docutils literal notranslate"><span class="pre">train</span></code> on first 1 batch,
<code class="docutils literal notranslate"><span class="pre">train_additional</span></code> on first 2 batches,
<code class="docutils literal notranslate"><span class="pre">valid</span></code> - on first 20% of batches
and <code class="docutils literal notranslate"><span class="pre">valid_additional</span></code> - on 50% batches:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">catalyst.dl</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">SupervisedRunner</span><span class="p">,</span> <span class="n">BatchOverfitCallback</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">runner</span> <span class="o">=</span> <span class="n">SupervisedRunner</span><span class="p">()</span>
<span class="n">runner</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
    <span class="o">...</span>
    <span class="n">loaders</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span>
        <span class="s2">&quot;train_additional&quot;</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span>
        <span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span>
        <span class="s2">&quot;valid_additional&quot;</span><span class="p">:</span><span class="o">...</span>
    <span class="p">}</span>
    <span class="o">...</span>
    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span>
        <span class="o">...</span>
        <span class="n">BatchOverfitCallback</span><span class="p">(</span>
            <span class="n">train_additional</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">valid</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
            <span class="n">valid_additional</span><span class="o">=</span><span class="mf">0.5</span>
        <span class="p">),</span>
        <span class="o">...</span>
    <span class="p">]</span>
    <span class="o">...</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Minimal working example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">DataLoader</span><span class="p">,</span> <span class="n">TensorDataset</span>
<span class="kn">from</span> <span class="nn">catalyst</span> <span class="kn">import</span> <span class="n">dl</span>

<span class="c1"># data</span>
<span class="n">num_samples</span><span class="p">,</span> <span class="n">num_features</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e4</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e1</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_samples</span><span class="p">,</span> <span class="n">num_features</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_samples</span><span class="p">)</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">TensorDataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">loaders</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="n">loader</span><span class="p">,</span> <span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="n">loader</span><span class="p">}</span>

<span class="c1"># model, criterion, optimizer, scheduler</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">num_features</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">criterion</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">()</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>
<span class="n">scheduler</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">lr_scheduler</span><span class="o">.</span><span class="n">MultiStepLR</span><span class="p">(</span><span class="n">optimizer</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>

<span class="c1"># model training</span>
<span class="n">runner</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">SupervisedRunner</span><span class="p">()</span>
<span class="n">runner</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
    <span class="n">criterion</span><span class="o">=</span><span class="n">criterion</span><span class="p">,</span>
    <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
    <span class="n">scheduler</span><span class="o">=</span><span class="n">scheduler</span><span class="p">,</span>
    <span class="n">loaders</span><span class="o">=</span><span class="n">loaders</span><span class="p">,</span>
    <span class="n">logdir</span><span class="o">=</span><span class="s2">&quot;./logdir&quot;</span><span class="p">,</span>
    <span class="n">num_epochs</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">dl</span><span class="o">.</span><span class="n">BatchOverfitCallback</span><span class="p">(</span><span class="n">train</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">valid</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)]</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="catalyst.callbacks.batch_overfit.BatchOverfitCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/batch_overfit.html#BatchOverfitCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.batch_overfit.BatchOverfitCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> – loader names and their number of batches to overfit.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.batch_overfit.BatchOverfitCallback.on_epoch_end">
<code class="sig-name descname">on_epoch_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/batch_overfit.html#BatchOverfitCallback.on_epoch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.batch_overfit.BatchOverfitCallback.on_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Unwraps loaders for current epoch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.batch_overfit.BatchOverfitCallback.on_epoch_start">
<code class="sig-name descname">on_epoch_start</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/batch_overfit.html#BatchOverfitCallback.on_epoch_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.batch_overfit.BatchOverfitCallback.on_epoch_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Wraps loaders for current epoch.
If number-of-batches for loader is not provided then the first batch
from loader will be used for overfitting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-catalyst.callbacks.checkpoint">
<span id="checkpoint"></span><h3><a class="toc-backref" href="#id3">Checkpoint</a><a class="headerlink" href="#module-catalyst.callbacks.checkpoint" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.checkpoint.CheckpointCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.checkpoint.</code><code class="sig-name descname">CheckpointCallback</code><span class="sig-paren">(</span><em class="sig-param">save_n_best: int = 1</em>, <em class="sig-param">resume: str = None</em>, <em class="sig-param">resume_dir: str = None</em>, <em class="sig-param">metrics_filename: str = '_metrics.json'</em>, <em class="sig-param">load_on_stage_start: Union[str</em>, <em class="sig-param">Dict[str</em>, <em class="sig-param">str]] = None</em>, <em class="sig-param">load_on_stage_end: Union[str</em>, <em class="sig-param">Dict[str</em>, <em class="sig-param">str]] = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/checkpoint.html#CheckpointCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.checkpoint.CheckpointCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.checkpoint.BaseCheckpointCallback" title="catalyst.callbacks.checkpoint.BaseCheckpointCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.checkpoint.BaseCheckpointCallback</span></code></a></p>
<p>Checkpoint callback to save/restore your
model/criterion/optimizer/scheduler.</p>
<dl class="method">
<dt id="catalyst.callbacks.checkpoint.CheckpointCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">save_n_best: int = 1</em>, <em class="sig-param">resume: str = None</em>, <em class="sig-param">resume_dir: str = None</em>, <em class="sig-param">metrics_filename: str = '_metrics.json'</em>, <em class="sig-param">load_on_stage_start: Union[str</em>, <em class="sig-param">Dict[str</em>, <em class="sig-param">str]] = None</em>, <em class="sig-param">load_on_stage_end: Union[str</em>, <em class="sig-param">Dict[str</em>, <em class="sig-param">str]] = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/checkpoint.html#CheckpointCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.checkpoint.CheckpointCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_n_best</strong> – number of best checkpoint to keep,
if <code class="docutils literal notranslate"><span class="pre">0</span></code> then  store only last state of model and
<code class="docutils literal notranslate"><span class="pre">load_on_stage_end</span></code> should be one of
<code class="docutils literal notranslate"><span class="pre">last</span></code> or <code class="docutils literal notranslate"><span class="pre">last_full</span></code>.</p></li>
<li><p><strong>resume</strong> – path to checkpoint to load
and initialize runner state</p></li>
<li><p><strong>resume_dir</strong> – directory with checkpoints,
if specified in combination with <code class="docutils literal notranslate"><span class="pre">resume</span></code>
than resume checkpoint will be loaded from <code class="docutils literal notranslate"><span class="pre">resume_dir</span></code></p></li>
<li><p><strong>metrics_filename</strong> – filename to save metrics
in checkpoint folder.
Must ends on <code class="docutils literal notranslate"><span class="pre">.json</span></code> or <code class="docutils literal notranslate"><span class="pre">.yml</span></code></p></li>
<li><p><strong>load_on_stage_start</strong> (<em>str</em><em> or </em><em>Dict</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em>) – <p>load specified
state/model at stage start.</p>
<p>If passed <strong>string</strong> then will be performed initialization from
specified state (<code class="docutils literal notranslate"><span class="pre">best</span></code>/<code class="docutils literal notranslate"><span class="pre">best_full</span></code>/<code class="docutils literal notranslate"><span class="pre">last</span></code>/<code class="docutils literal notranslate"><span class="pre">last_full</span></code>)
or checkpoint file.</p>
<p>If passed <strong>dict</strong> then will be performed initialization only
for specified parts - model, criterion, optimizer, scheduler.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># possible checkpoints to use:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#   &quot;best&quot;/&quot;best_full&quot;/&quot;last&quot;/&quot;last_full&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#   or path to specific checkpoint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">to_load</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="s2">&quot;path/to/checkpoint.pth&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="s2">&quot;criterion&quot;</span><span class="p">:</span> <span class="s2">&quot;best&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="s2">&quot;optimizer&quot;</span><span class="p">:</span> <span class="s2">&quot;last_full&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="s2">&quot;scheduler&quot;</span><span class="p">:</span> <span class="s2">&quot;best_full&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">CheckpointCallback</span><span class="p">(</span><span class="n">load_on_stage_start</span><span class="o">=</span><span class="n">to_load</span><span class="p">)</span>
</pre></div>
</div>
<p>All other keys instead of <code class="docutils literal notranslate"><span class="pre">&quot;model&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;criterion&quot;</span></code>,
<code class="docutils literal notranslate"><span class="pre">&quot;optimizer&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;scheduler&quot;</span></code> will be ignored.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">None</span></code> or an empty dict (or dict without mentioned
above keys) then no action is required at stage start and:</p>
<ul>
<li><p>Config API - will be used best state of model</p></li>
<li><p>Notebook API - no action will be performed (will be
used the last state)</p></li>
</ul>
<p><strong>NOTE:</strong> Loading will be performed on all stages except first.</p>
<p><strong>NOTE:</strong> Criterion, optimizer and scheduler are optional keys
and should be loaded from full checkpoint.</p>
<p>Model state can be loaded from any checkpoint.</p>
<p>When dict contains keys for model and some other part
(for example <code class="docutils literal notranslate"><span class="pre">{&quot;model&quot;:</span> <span class="pre">&quot;last&quot;,</span> <span class="pre">&quot;optimizer&quot;:</span> <span class="pre">&quot;last&quot;}</span></code>)
and they match in prefix (<code class="docutils literal notranslate"><span class="pre">&quot;best&quot;</span></code> and
<code class="docutils literal notranslate"><span class="pre">&quot;best_full&quot;</span></code>) then will be loaded full checkpoint
because it contains required states.</p>
</p></li>
<li><p><strong>load_on_stage_end</strong> (<em>str</em><em> or </em><em>Dict</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em>) – <p>load specified
state/model at stage end.</p>
<p>If passed <strong>string</strong> then will be performed initialization from
specified state (<code class="docutils literal notranslate"><span class="pre">best</span></code>/<code class="docutils literal notranslate"><span class="pre">best_full</span></code>/<code class="docutils literal notranslate"><span class="pre">last</span></code>/<code class="docutils literal notranslate"><span class="pre">last_full</span></code>)
or checkpoint file.</p>
<p>If passed <strong>dict</strong> then will be performed initialization only
for specified parts - model, criterion, optimizer, scheduler.
Logic for dict is the same as for <code class="docutils literal notranslate"><span class="pre">load_on_stage_start</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">None</span></code> then no action is required at stage end
and will be used the last runner.</p>
<p><strong>NOTE:</strong> Loading will be performed always at stage end.</p>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.checkpoint.CheckpointCallback.on_epoch_end">
<code class="sig-name descname">on_epoch_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/checkpoint.html#CheckpointCallback.on_epoch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.checkpoint.CheckpointCallback.on_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Collect and save checkpoint after epoch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.checkpoint.CheckpointCallback.on_stage_end">
<code class="sig-name descname">on_stage_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/checkpoint.html#CheckpointCallback.on_stage_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.checkpoint.CheckpointCallback.on_stage_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Show information about best checkpoints during the stage and
load model specified in <code class="docutils literal notranslate"><span class="pre">load_on_stage_end</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.checkpoint.CheckpointCallback.on_stage_start">
<code class="sig-name descname">on_stage_start</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/checkpoint.html#CheckpointCallback.on_stage_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.checkpoint.CheckpointCallback.on_stage_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup model for stage.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If CheckpointCallback initialized with
<code class="docutils literal notranslate"><span class="pre">resume</span></code> (as path to checkpoint file)
or <code class="docutils literal notranslate"><span class="pre">resume</span></code> (as filename)
and <code class="docutils literal notranslate"><span class="pre">resume_dir</span></code> (as directory with file)
then will be performed loading checkpoint.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.checkpoint.CheckpointCallback.process_checkpoint">
<code class="sig-name descname">process_checkpoint</code><span class="sig-paren">(</span><em class="sig-param">logdir: Union[str, pathlib.Path], checkpoint: Dict, is_best: bool, main_metric: str = 'loss', minimize_metric: bool = True</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/checkpoint.html#CheckpointCallback.process_checkpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.checkpoint.CheckpointCallback.process_checkpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Save checkpoint and metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logdir</strong> (<em>str</em><em> or </em><em>Path object</em>) – directory for storing checkpoints</p></li>
<li><p><strong>checkpoint</strong> – dict with checkpoint data</p></li>
<li><p><strong>is_best</strong> – indicator to save best checkpoint,
if true then will be saved two additional checkpoints -
<code class="docutils literal notranslate"><span class="pre">best</span></code> and <code class="docutils literal notranslate"><span class="pre">best_full</span></code>.</p></li>
<li><p><strong>main_metric</strong> – metric to use for selecting the best model</p></li>
<li><p><strong>minimize_metric</strong> – indicator for selecting best metric,
if true then best metric will be the metric with
the lowest value, otherwise with the greatest value.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.checkpoint.CheckpointCallback.process_metrics">
<code class="sig-name descname">process_metrics</code><span class="sig-paren">(</span><em class="sig-param">last_valid_metrics: Dict[str, float]</em><span class="sig-paren">)</span> &#x2192; Dict<a class="reference internal" href="../_modules/catalyst/callbacks/checkpoint.html#CheckpointCallback.process_metrics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.checkpoint.CheckpointCallback.process_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Add last validation metrics to list of previous validation metrics
and keep <code class="docutils literal notranslate"><span class="pre">save_n_best</span></code> metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>last_valid_metrics</strong> – dict with metrics
from last validation step.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>processed metrics</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>OrderedDict</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.checkpoint.CheckpointCallback.truncate_checkpoints">
<code class="sig-name descname">truncate_checkpoints</code><span class="sig-paren">(</span><em class="sig-param">minimize_metric: bool</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/checkpoint.html#CheckpointCallback.truncate_checkpoints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.checkpoint.CheckpointCallback.truncate_checkpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Keep <code class="docutils literal notranslate"><span class="pre">save_n_best</span></code> checkpoints based on main metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>minimize_metric</strong> – if <code class="docutils literal notranslate"><span class="pre">True</span></code> then keep
<code class="docutils literal notranslate"><span class="pre">save_n_best</span></code> checkpoints with the lowest/highest values
of the main metric.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="catalyst.callbacks.checkpoint.IterationCheckpointCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.checkpoint.</code><code class="sig-name descname">IterationCheckpointCallback</code><span class="sig-paren">(</span><em class="sig-param">save_n_last: int = 1</em>, <em class="sig-param">period: int = 100</em>, <em class="sig-param">stage_restart: bool = True</em>, <em class="sig-param">metrics_filename: str = '_metrics_iter.json'</em>, <em class="sig-param">load_on_stage_end: str = 'best_full'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/checkpoint.html#IterationCheckpointCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.checkpoint.IterationCheckpointCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.checkpoint.BaseCheckpointCallback" title="catalyst.callbacks.checkpoint.BaseCheckpointCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.checkpoint.BaseCheckpointCallback</span></code></a></p>
<p>Iteration checkpoint callback to save your model/criterion/optimizer.</p>
<dl class="method">
<dt id="catalyst.callbacks.checkpoint.IterationCheckpointCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">save_n_last: int = 1</em>, <em class="sig-param">period: int = 100</em>, <em class="sig-param">stage_restart: bool = True</em>, <em class="sig-param">metrics_filename: str = '_metrics_iter.json'</em>, <em class="sig-param">load_on_stage_end: str = 'best_full'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/checkpoint.html#IterationCheckpointCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.checkpoint.IterationCheckpointCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_n_last</strong> – number of last checkpoint to keep</p></li>
<li><p><strong>period</strong> – save the checkpoint every <cite>period</cite></p></li>
<li><p><strong>stage_restart</strong> – restart counter every stage or not</p></li>
<li><p><strong>metrics_filename</strong> – filename to save metrics
in checkpoint folder. Must ends on <code class="docutils literal notranslate"><span class="pre">.json</span></code> or <code class="docutils literal notranslate"><span class="pre">.yml</span></code></p></li>
<li><p><strong>load_on_stage_end</strong> – name of the model to load
at the end of the stage.
You can use <code class="docutils literal notranslate"><span class="pre">best</span></code>, <code class="docutils literal notranslate"><span class="pre">best_full</span></code> (default)
to load the best model according to validation metrics,
or <code class="docutils literal notranslate"><span class="pre">last</span></code> <code class="docutils literal notranslate"><span class="pre">last_full</span></code> to use just the last one.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.checkpoint.IterationCheckpointCallback.on_batch_end">
<code class="sig-name descname">on_batch_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/checkpoint.html#IterationCheckpointCallback.on_batch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.checkpoint.IterationCheckpointCallback.on_batch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Save checkpoint based on batches count.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.checkpoint.IterationCheckpointCallback.on_stage_end">
<code class="sig-name descname">on_stage_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/checkpoint.html#IterationCheckpointCallback.on_stage_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.checkpoint.IterationCheckpointCallback.on_stage_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Load model specified in <code class="docutils literal notranslate"><span class="pre">load_on_stage_end</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.checkpoint.IterationCheckpointCallback.on_stage_start">
<code class="sig-name descname">on_stage_start</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/checkpoint.html#IterationCheckpointCallback.on_stage_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.checkpoint.IterationCheckpointCallback.on_stage_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset iterations counter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.checkpoint.IterationCheckpointCallback.process_checkpoint">
<code class="sig-name descname">process_checkpoint</code><span class="sig-paren">(</span><em class="sig-param">logdir: Union[str, pathlib.Path], checkpoint: Dict, batch_metrics: Dict[str, float]</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/checkpoint.html#IterationCheckpointCallback.process_checkpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.checkpoint.IterationCheckpointCallback.process_checkpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Save checkpoint and metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logdir</strong> (<em>str</em><em> or </em><em>Path object</em>) – directory for storing checkpoints</p></li>
<li><p><strong>checkpoint</strong> – dict with checkpoint data</p></li>
<li><p><strong>batch_metrics</strong> – dict with metrics based on a few batches</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.checkpoint.IterationCheckpointCallback.process_metrics">
<code class="sig-name descname">process_metrics</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; Dict<a class="reference internal" href="../_modules/catalyst/callbacks/checkpoint.html#IterationCheckpointCallback.process_metrics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.checkpoint.IterationCheckpointCallback.process_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Update metrics with last <code class="docutils literal notranslate"><span class="pre">save_n_last</span></code> checkpoints.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>updated metrics</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.checkpoint.IterationCheckpointCallback.truncate_checkpoints">
<code class="sig-name descname">truncate_checkpoints</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/checkpoint.html#IterationCheckpointCallback.truncate_checkpoints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.checkpoint.IterationCheckpointCallback.truncate_checkpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Keep <code class="docutils literal notranslate"><span class="pre">save_n_best</span></code> checkpoints based on main metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>**kwargs</strong> – extra params</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="catalyst.callbacks.checkpoint.ICheckpointCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.checkpoint.</code><code class="sig-name descname">ICheckpointCallback</code><span class="sig-paren">(</span><em class="sig-param">order: int</em>, <em class="sig-param">node: int = &lt;CallbackNode.All: 0&gt;</em>, <em class="sig-param">scope: int = &lt;CallbackScope.Stage: 0&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/checkpoint.html#ICheckpointCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.checkpoint.ICheckpointCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>Checkpoint callback interface, abstraction over model checkpointing step.</p>
</dd></dl>

<dl class="class">
<dt id="catalyst.callbacks.checkpoint.BaseCheckpointCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.checkpoint.</code><code class="sig-name descname">BaseCheckpointCallback</code><span class="sig-paren">(</span><em class="sig-param">metrics_filename: str = '_metrics.json'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/checkpoint.html#BaseCheckpointCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.checkpoint.BaseCheckpointCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.checkpoint.ICheckpointCallback" title="catalyst.callbacks.checkpoint.ICheckpointCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.checkpoint.ICheckpointCallback</span></code></a></p>
<p>Base class for all checkpoint callbacks.</p>
<dl class="method">
<dt id="catalyst.callbacks.checkpoint.BaseCheckpointCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">metrics_filename: str = '_metrics.json'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/checkpoint.html#BaseCheckpointCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.checkpoint.BaseCheckpointCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>metrics_filename</strong> – filename to save metrics
in checkpoint folder. Must ends on <code class="docutils literal notranslate"><span class="pre">.json</span></code> or <code class="docutils literal notranslate"><span class="pre">.yml</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.checkpoint.BaseCheckpointCallback.on_exception">
<code class="sig-name descname">on_exception</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/checkpoint.html#BaseCheckpointCallback.on_exception"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.checkpoint.BaseCheckpointCallback.on_exception" title="Permalink to this definition">¶</a></dt>
<dd><p>Expection handler.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-catalyst.callbacks.control_flow">
<span id="control-flow"></span><h3><a class="toc-backref" href="#id4">Control Flow</a><a class="headerlink" href="#module-catalyst.callbacks.control_flow" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.control_flow.ControlFlowCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.control_flow.</code><code class="sig-name descname">ControlFlowCallback</code><span class="sig-paren">(</span><em class="sig-param">base_callback: catalyst.core.callback.Callback, epochs: Union[int, Sequence[int]] = None, ignore_epochs: Union[int, Sequence[int]] = None, loaders: Union[str, Sequence[str], Mapping[str, Union[int, Sequence[int]]]] = None, ignore_loaders: Union[str, Sequence[str], Mapping[str, Union[int, Sequence[int]]]] = None, filter_fn: Union[str, Callable[[str, int, str], bool]] = None, use_global_epochs: bool = False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/control_flow.html#ControlFlowCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.control_flow.ControlFlowCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.CallbackWrapper" title="catalyst.core.callback.CallbackWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.CallbackWrapper</span></code></a></p>
<p>Enable/disable callback execution on different
stages, loaders and epochs.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please run experiment with
<code class="xref py py-class docutils literal notranslate"><span class="pre">check</span> <span class="pre">option</span></code>
to check if everything works as expected with this callback.</p>
</div>
<p>For example, if you don’t want to compute loss on a validation
you can ignore
<code class="xref py py-class docutils literal notranslate"><span class="pre">CriterionCallback</span></code>,
for <strong>notebook API</strong> need to wrap callback:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">DataLoader</span><span class="p">,</span> <span class="n">TensorDataset</span>
<span class="kn">from</span> <span class="nn">catalyst.dl</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">SupervisedRunner</span><span class="p">,</span> <span class="n">AccuracyCallback</span><span class="p">,</span>
    <span class="n">CriterionCallback</span><span class="p">,</span> <span class="n">ControlFlowCallback</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">num_samples</span><span class="p">,</span> <span class="n">num_features</span> <span class="o">=</span> <span class="mi">10_000</span><span class="p">,</span> <span class="mi">10</span>
<span class="n">n_classes</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_samples</span><span class="p">,</span> <span class="n">num_features</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_classes</span><span class="p">,</span> <span class="p">[</span><span class="n">num_samples</span><span class="p">])</span>
<span class="n">loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">TensorDataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">loaders</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="n">loader</span><span class="p">,</span> <span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="n">loader</span><span class="p">}</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">num_features</span><span class="p">,</span> <span class="n">n_classes</span><span class="p">)</span>
<span class="n">criterion</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>
<span class="n">scheduler</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">lr_scheduler</span><span class="o">.</span><span class="n">MultiStepLR</span><span class="p">(</span><span class="n">optimizer</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>

<span class="n">runner</span> <span class="o">=</span> <span class="n">SupervisedRunner</span><span class="p">()</span>
<span class="n">runner</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
    <span class="n">criterion</span><span class="o">=</span><span class="n">criterion</span><span class="p">,</span>
    <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
    <span class="n">scheduler</span><span class="o">=</span><span class="n">scheduler</span><span class="p">,</span>
    <span class="n">loaders</span><span class="o">=</span><span class="n">loaders</span><span class="p">,</span>
    <span class="n">logdir</span><span class="o">=</span><span class="s2">&quot;./logdir&quot;</span><span class="p">,</span>
    <span class="n">num_epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">main_metric</span><span class="o">=</span><span class="s2">&quot;accuracy03&quot;</span><span class="p">,</span>
    <span class="n">minimize_metric</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span>
        <span class="n">AccuracyCallback</span><span class="p">(</span>
            <span class="n">accuracy_args</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
        <span class="p">),</span>
        <span class="n">ControlFlowCallback</span><span class="p">(</span>
            <span class="n">base_callback</span><span class="o">=</span><span class="n">CriterionCallback</span><span class="p">(),</span>
            <span class="n">ignore_loaders</span><span class="o">=</span><span class="s2">&quot;valid&quot;</span>  <span class="c1"># or loaders=&quot;train&quot;</span>
        <span class="p">)</span>
    <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<p>In <strong>config API</strong> need to use <code class="docutils literal notranslate"><span class="pre">_wrapper</span></code> argument:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">callbacks_params</span><span class="p">:</span>
  <span class="l l-Scalar l-Scalar-Plain">...</span>
  <span class="l l-Scalar l-Scalar-Plain">loss</span><span class="p p-Indicator">:</span>
    <span class="nt">_wrapper</span><span class="p">:</span>
       <span class="nt">callback</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ControlFlowCallback</span>
       <span class="nt">ignore_loaders</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">valid</span>
    <span class="nt">callback</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">CriterionCallback</span>
  <span class="l l-Scalar l-Scalar-Plain">...</span>
</pre></div>
</div>
<dl class="method">
<dt id="catalyst.callbacks.control_flow.ControlFlowCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">base_callback: catalyst.core.callback.Callback, epochs: Union[int, Sequence[int]] = None, ignore_epochs: Union[int, Sequence[int]] = None, loaders: Union[str, Sequence[str], Mapping[str, Union[int, Sequence[int]]]] = None, ignore_loaders: Union[str, Sequence[str], Mapping[str, Union[int, Sequence[int]]]] = None, filter_fn: Union[str, Callable[[str, int, str], bool]] = None, use_global_epochs: bool = False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/control_flow.html#ControlFlowCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.control_flow.ControlFlowCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_callback</strong> – callback to wrap</p></li>
<li><p><strong>epochs</strong> – <p>epochs where
need to <strong>enable</strong> callback, on other epochs
callback will be disabled.</p>
<p>If passed int/float then callback will be enabled
with period specified as epochs value
(epochs expression <code class="docutils literal notranslate"><span class="pre">epoch_number</span> <span class="pre">%</span> <span class="pre">epochs</span> <span class="pre">==</span> <span class="pre">0</span></code>)
and disabled on other epochs.</p>
<p>If passed list of epochs then will be executed callback
on specified epochs.</p>
<p>Default value is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</p></li>
<li><p><strong>ignore_epochs:</strong> – <p>epochs where: need to <strong>disable</strong> callback, on other epochs
callback will be enabled.</p>
<p>If passed int/float then callback will be disabled
with period specified as epochs value
(epochs expression <code class="docutils literal notranslate"><span class="pre">epoch_number</span> <span class="pre">%</span> <span class="pre">epochs</span> <span class="pre">!=</span> <span class="pre">0</span></code>)
and enabled on other epochs.</p>
<p>If passed list of epochs then will be disabled callback
on specified epochs.</p>
<p>Default value is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</p></li>
<li><p><strong>loaders</strong> (<em>str/Sequence</em><em>[</em><em>str</em><em>]</em><em>/Mapping</em><em>[</em><em>str</em><em>, </em><em>int/Sequence</em><em>[</em><em>str</em><em>]</em><em>]</em>) – <p>loaders where should be <strong>enabled</strong> callback, on
other loaders callback will be disabled.</p>
<p>If passed string object then will be disabled callback for
loader with specified name.</p>
<p>If passed list/tuple of strings then will be disabled callback
for loaders with specified names.</p>
<p>If passed dictionary where key is a string and values
int or list of integers then callback will be
disabled on epochs (dictionary value) for specified
loader (dictionary key).</p>
<p>Default value is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</p></li>
<li><p><strong>ignore_loaders</strong> (<em>str/Sequence</em><em>[</em><em>str</em><em>]</em><em>/Mapping</em><em>[</em><em>str</em><em>, </em><em>int/Sequence</em><em>[</em><em>str</em><em>]</em><em>]</em>) – <p>loader names where should be <strong>disabled</strong> callback, on
other loaders callback will be enabled.</p>
<p>If passed string object then will be disabled callback for
loader with specified name.</p>
<p>If passed list/tuple of strings then will be disabled callback
for loaders with specified names.</p>
<p>If passed dictionary where key is a string and values
int or list of integers then callback will be
disabled on epochs (dictionary value) for specified
loader (dictionary key).</p>
<p>Default value is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</p></li>
<li><p><strong>filter_fn</strong> (<em>str</em><em> or </em><em>Callable</em><em>[</em><em>[</em><em>str</em><em>, </em><em>int</em><em>, </em><em>str</em><em>]</em><em>, </em><em>bool</em><em>]</em>) – <p>function to use instead of <code class="docutils literal notranslate"><span class="pre">loaders</span></code> or <code class="docutils literal notranslate"><span class="pre">epochs</span></code> arguments.</p>
<p>If the object passed to a <code class="docutils literal notranslate"><span class="pre">filter_fn</span></code> is a string
then it will be interpreted as python code. Expected
lambda function with three arguments stage name (str),
epoch number (int), loader name (str) and this function
should return <code class="docutils literal notranslate"><span class="pre">True</span></code> if callback should be enabled
on some condition.</p>
<p>If passed callable object then it should accept
three arguments - stage name (str), epoch number (int),
loader name (str) and should return <code class="docutils literal notranslate"><span class="pre">True</span></code> if callback
should be enabled on some condition othervise should
return <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<p>Default value is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># enable callback on all loaders</span>
<span class="c1"># exept &quot;train&quot; loader every 2 epochs</span>
<span class="n">ControlFlowCallback</span><span class="p">(</span>
    <span class="o">...</span>
    <span class="n">filter_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">l</span><span class="p">:</span> <span class="n">l</span> <span class="o">!=</span> <span class="s2">&quot;train&quot;</span> <span class="ow">and</span> <span class="n">e</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span>
    <span class="o">...</span>
<span class="p">)</span>
<span class="c1"># or with string equivalent</span>
<span class="n">ControlFlowCallback</span><span class="p">(</span>
    <span class="o">...</span>
    <span class="n">filter_fn</span><span class="o">=</span><span class="s2">&quot;lambda s, e, l: l != &#39;train&#39; and e % 2 == 0&quot;</span>
    <span class="o">...</span>
<span class="p">)</span>
</pre></div>
</div>
</p></li>
<li><p><strong>use_global_epochs</strong> – if <code class="docutils literal notranslate"><span class="pre">True</span></code> then
will be used global epochs instead of epochs in
a stage, the default value is <code class="docutils literal notranslate"><span class="pre">False</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.control_flow.ControlFlowCallback.on_loader_end">
<code class="sig-name descname">on_loader_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/control_flow.html#ControlFlowCallback.on_loader_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.control_flow.ControlFlowCallback.on_loader_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset status of callback</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.control_flow.ControlFlowCallback.on_loader_start">
<code class="sig-name descname">on_loader_start</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/control_flow.html#ControlFlowCallback.on_loader_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.control_flow.ControlFlowCallback.on_loader_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if current epoch should be skipped.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-catalyst.callbacks.criterion">
<span id="criterion"></span><h3><a class="toc-backref" href="#id5">Criterion</a><a class="headerlink" href="#module-catalyst.callbacks.criterion" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.criterion.CriterionCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.criterion.</code><code class="sig-name descname">CriterionCallback</code><span class="sig-paren">(</span><em class="sig-param">input_key: Union[str, List[str], Dict[str, str]] = 'targets', output_key: Union[str, List[str], Dict[str, str]] = 'logits', prefix: str = 'loss', criterion_key: str = None, multiplier: float = 1.0, **metric_kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/criterion.html#CriterionCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.criterion.CriterionCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.metric.IBatchMetricCallback" title="catalyst.callbacks.metric.IBatchMetricCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.metric.IBatchMetricCallback</span></code></a></p>
<p>Callback for that measures loss with specified criterion.</p>
<dl class="method">
<dt id="catalyst.callbacks.criterion.CriterionCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">input_key: Union[str, List[str], Dict[str, str]] = 'targets', output_key: Union[str, List[str], Dict[str, str]] = 'logits', prefix: str = 'loss', criterion_key: str = None, multiplier: float = 1.0, **metric_kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/criterion.html#CriterionCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.criterion.CriterionCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_key</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>Dict</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em><em>]</em>) – key/list/dict
of keys that takes values from the input dictionary
If ‘__all__’, the whole input will be passed to the criterion
If None, empty dict will be passed to the criterion.</p></li>
<li><p><strong>output_key</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>Dict</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em><em>]</em>) – key/list/dict
of keys that takes values from the input dictionary
If ‘__all__’, the whole output will be passed to the criterion
If None, empty dict will be passed to the criterion.</p></li>
<li><p><strong>prefix</strong> – prefix for metrics and output key for loss
in <code class="docutils literal notranslate"><span class="pre">runner.batch_metrics</span></code> dictionary</p></li>
<li><p><strong>criterion_key</strong> – A key to take a criterion in case
there are several of them and they are in a dictionary format.</p></li>
<li><p><strong>multiplier</strong> – scale factor for the output loss.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.criterion.CriterionCallback.metric_fn">
<em class="property">property </em><code class="sig-name descname">metric_fn</code><a class="headerlink" href="#catalyst.callbacks.criterion.CriterionCallback.metric_fn" title="Permalink to this definition">¶</a></dt>
<dd><p>Criterion function.</p>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.criterion.CriterionCallback.on_stage_start">
<code class="sig-name descname">on_stage_start</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/criterion.html#CriterionCallback.on_stage_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.criterion.CriterionCallback.on_stage_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks that the current stage has correct criterion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-catalyst.callbacks.early_stop">
<span id="early-stop"></span><h3><a class="toc-backref" href="#id6">Early Stop</a><a class="headerlink" href="#module-catalyst.callbacks.early_stop" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.early_stop.CheckRunCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.early_stop.</code><code class="sig-name descname">CheckRunCallback</code><span class="sig-paren">(</span><em class="sig-param">num_batch_steps: int = 3</em>, <em class="sig-param">num_epoch_steps: int = 2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/early_stop.html#CheckRunCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.early_stop.CheckRunCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>Executes only a pipeline part from the <code class="docutils literal notranslate"><span class="pre">Experiment</span></code>.</p>
<p>Minimal working example (Notebook API):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">DataLoader</span><span class="p">,</span> <span class="n">TensorDataset</span>
<span class="kn">from</span> <span class="nn">catalyst</span> <span class="kn">import</span> <span class="n">dl</span>

<span class="c1"># data</span>
<span class="n">num_samples</span><span class="p">,</span> <span class="n">num_features</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e4</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e1</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_samples</span><span class="p">,</span> <span class="n">num_features</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_samples</span><span class="p">)</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">TensorDataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">loaders</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="n">loader</span><span class="p">,</span> <span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="n">loader</span><span class="p">}</span>

<span class="c1"># model, criterion, optimizer, scheduler</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">num_features</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">criterion</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">()</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>
<span class="n">scheduler</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">lr_scheduler</span><span class="o">.</span><span class="n">MultiStepLR</span><span class="p">(</span><span class="n">optimizer</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>

<span class="c1"># model training</span>
<span class="n">runner</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">SupervisedRunner</span><span class="p">()</span>
<span class="n">runner</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
    <span class="n">criterion</span><span class="o">=</span><span class="n">criterion</span><span class="p">,</span>
    <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
    <span class="n">scheduler</span><span class="o">=</span><span class="n">scheduler</span><span class="p">,</span>
    <span class="n">loaders</span><span class="o">=</span><span class="n">loaders</span><span class="p">,</span>
    <span class="n">logdir</span><span class="o">=</span><span class="s2">&quot;./logdir&quot;</span><span class="p">,</span>
    <span class="n">num_epochs</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span>
        <span class="n">dl</span><span class="o">.</span><span class="n">CheckRunCallback</span><span class="p">(</span><span class="n">num_batch_steps</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">num_epoch_steps</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="catalyst.callbacks.early_stop.CheckRunCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">num_batch_steps: int = 3</em>, <em class="sig-param">num_epoch_steps: int = 2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/early_stop.html#CheckRunCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.early_stop.CheckRunCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_batch_steps</strong> – number of batches to iterate in epoch</p></li>
<li><p><strong>num_epoch_steps</strong> – number of epoch to perform in a stage</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.early_stop.CheckRunCallback.on_batch_end">
<code class="sig-name descname">on_batch_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/early_stop.html#CheckRunCallback.on_batch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.early_stop.CheckRunCallback.on_batch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if iterated specified number of batches.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.early_stop.CheckRunCallback.on_epoch_end">
<code class="sig-name descname">on_epoch_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/early_stop.html#CheckRunCallback.on_epoch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.early_stop.CheckRunCallback.on_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if iterated specified number of epochs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="catalyst.callbacks.early_stop.EarlyStoppingCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.early_stop.</code><code class="sig-name descname">EarlyStoppingCallback</code><span class="sig-paren">(</span><em class="sig-param">patience: int</em>, <em class="sig-param">metric: str = 'loss'</em>, <em class="sig-param">minimize: bool = True</em>, <em class="sig-param">min_delta: float = 1e-06</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/early_stop.html#EarlyStoppingCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.early_stop.EarlyStoppingCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>Early exit based on metric.</p>
<p>Minimal working example (Notebook API):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">DataLoader</span><span class="p">,</span> <span class="n">TensorDataset</span>
<span class="kn">from</span> <span class="nn">catalyst</span> <span class="kn">import</span> <span class="n">dl</span>

<span class="c1"># data</span>
<span class="n">num_samples</span><span class="p">,</span> <span class="n">num_features</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e4</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e1</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_samples</span><span class="p">,</span> <span class="n">num_features</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_samples</span><span class="p">)</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">TensorDataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">loaders</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="n">loader</span><span class="p">,</span> <span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="n">loader</span><span class="p">}</span>

<span class="c1"># model, criterion, optimizer, scheduler</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">num_features</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">criterion</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">()</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>
<span class="n">scheduler</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">lr_scheduler</span><span class="o">.</span><span class="n">MultiStepLR</span><span class="p">(</span><span class="n">optimizer</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>

<span class="c1"># model training</span>
<span class="n">runner</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">SupervisedRunner</span><span class="p">()</span>
<span class="n">runner</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
  <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
  <span class="n">criterion</span><span class="o">=</span><span class="n">criterion</span><span class="p">,</span>
  <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
  <span class="n">scheduler</span><span class="o">=</span><span class="n">scheduler</span><span class="p">,</span>
  <span class="n">loaders</span><span class="o">=</span><span class="n">loaders</span><span class="p">,</span>
  <span class="n">logdir</span><span class="o">=</span><span class="s2">&quot;./logdir&quot;</span><span class="p">,</span>
  <span class="n">num_epochs</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
  <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
  <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span>
    <span class="n">dl</span><span class="o">.</span><span class="n">EarlyStoppingCallback</span><span class="p">(</span><span class="n">patience</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;loss&quot;</span><span class="p">,</span> <span class="n">minimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Example of usage in config API:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">stages</span><span class="p">:</span>
  <span class="l l-Scalar l-Scalar-Plain">...</span>
  <span class="l l-Scalar l-Scalar-Plain">stage_N</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">...</span>
    <span class="l l-Scalar l-Scalar-Plain">callbacks_params</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">...</span>
      <span class="l l-Scalar l-Scalar-Plain">early_stopping</span><span class="p p-Indicator">:</span>
        <span class="nt">callback</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">EarlyStoppingCallback</span>
        <span class="c1"># arguments for EarlyStoppingCallback</span>
        <span class="nt">patience</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">5</span>
        <span class="nt">metric</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my_metric</span>
        <span class="nt">minimize</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
  <span class="l l-Scalar l-Scalar-Plain">...</span>
</pre></div>
</div>
<dl class="method">
<dt id="catalyst.callbacks.early_stop.EarlyStoppingCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">patience: int</em>, <em class="sig-param">metric: str = 'loss'</em>, <em class="sig-param">minimize: bool = True</em>, <em class="sig-param">min_delta: float = 1e-06</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/early_stop.html#EarlyStoppingCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.early_stop.EarlyStoppingCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>patience</strong> – number of epochs with no improvement
after which training will be stopped.</p></li>
<li><p><strong>metric</strong> – metric name to use for early stopping, default
is <code class="docutils literal notranslate"><span class="pre">&quot;loss&quot;</span></code>.</p></li>
<li><p><strong>minimize</strong> – if <code class="docutils literal notranslate"><span class="pre">True</span></code> then expected that metric should
decrease and early stopping will be performed only when metric
stops decreasing. If <code class="docutils literal notranslate"><span class="pre">False</span></code> then expected
that metric should increase. Default value <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>min_delta</strong> – minimum change in the monitored metric
to qualify as an improvement, i.e. an absolute change
of less than min_delta, will count as no improvement,
default value is <code class="docutils literal notranslate"><span class="pre">1e-6</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.early_stop.EarlyStoppingCallback.on_epoch_end">
<code class="sig-name descname">on_epoch_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/early_stop.html#EarlyStoppingCallback.on_epoch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.early_stop.EarlyStoppingCallback.on_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if should be performed early stopping.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-catalyst.callbacks.exception">
<span id="exception"></span><h3><a class="toc-backref" href="#id7">Exception</a><a class="headerlink" href="#module-catalyst.callbacks.exception" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.exception.ExceptionCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.exception.</code><code class="sig-name descname">ExceptionCallback</code><a class="reference internal" href="../_modules/catalyst/callbacks/exception.html#ExceptionCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.exception.ExceptionCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>Handles python exceptions during run.</p>
<dl class="method">
<dt id="catalyst.callbacks.exception.ExceptionCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/exception.html#ExceptionCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.exception.ExceptionCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialisation for ExceptionCallback.</p>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.exception.ExceptionCallback.on_exception">
<code class="sig-name descname">on_exception</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/exception.html#ExceptionCallback.on_exception"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.exception.ExceptionCallback.on_exception" title="Permalink to this definition">¶</a></dt>
<dd><p>Exception handle hook.  # noqa: DAR401</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – experiment runner</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>Exception</strong> – if during exception handling,  # noqa: DAR402
    we still need to reraise exception</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-catalyst.callbacks.logging">
<span id="logging"></span><h3><a class="toc-backref" href="#id8">Logging</a><a class="headerlink" href="#module-catalyst.callbacks.logging" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.logging.ILoggerCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.logging.</code><code class="sig-name descname">ILoggerCallback</code><span class="sig-paren">(</span><em class="sig-param">order: int</em>, <em class="sig-param">node: int = &lt;CallbackNode.All: 0&gt;</em>, <em class="sig-param">scope: int = &lt;CallbackScope.Stage: 0&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/logging.html#ILoggerCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.logging.ILoggerCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>Logger callback interface, abstraction over logging step</p>
</dd></dl>

<dl class="class">
<dt id="catalyst.callbacks.logging.ConsoleLogger">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.logging.</code><code class="sig-name descname">ConsoleLogger</code><a class="reference internal" href="../_modules/catalyst/callbacks/logging.html#ConsoleLogger"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.logging.ConsoleLogger" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.logging.ILoggerCallback" title="catalyst.callbacks.logging.ILoggerCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.logging.ILoggerCallback</span></code></a></p>
<p>Logger callback,
translates <code class="docutils literal notranslate"><span class="pre">runner.*_metrics</span></code> to console and text file.</p>
<dl class="method">
<dt id="catalyst.callbacks.logging.ConsoleLogger.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/logging.html#ConsoleLogger.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.logging.ConsoleLogger.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Init <code class="docutils literal notranslate"><span class="pre">ConsoleLogger</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.logging.ConsoleLogger.on_epoch_end">
<code class="sig-name descname">on_epoch_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/logging.html#ConsoleLogger.on_epoch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.logging.ConsoleLogger.on_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Translate <code class="docutils literal notranslate"><span class="pre">runner.metric_manager</span></code> to console and text file
at the end of an epoch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner instance</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.logging.ConsoleLogger.on_stage_end">
<code class="sig-name descname">on_stage_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/logging.html#ConsoleLogger.on_stage_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.logging.ConsoleLogger.on_stage_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Called at the end of each stage.</p>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.logging.ConsoleLogger.on_stage_start">
<code class="sig-name descname">on_stage_start</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/logging.html#ConsoleLogger.on_stage_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.logging.ConsoleLogger.on_stage_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare <code class="docutils literal notranslate"><span class="pre">runner.logdir</span></code> for the current stage.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="catalyst.callbacks.logging.TensorboardLogger">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.logging.</code><code class="sig-name descname">TensorboardLogger</code><span class="sig-paren">(</span><em class="sig-param">metric_names: List[str] = None</em>, <em class="sig-param">log_on_batch_end: bool = True</em>, <em class="sig-param">log_on_epoch_end: bool = True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/logging.html#TensorboardLogger"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.logging.TensorboardLogger" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.logging.ILoggerCallback" title="catalyst.callbacks.logging.ILoggerCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.logging.ILoggerCallback</span></code></a></p>
<p>Logger callback, translates <code class="docutils literal notranslate"><span class="pre">runner.metric_manager</span></code> to tensorboard.</p>
<dl class="method">
<dt id="catalyst.callbacks.logging.TensorboardLogger.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">metric_names: List[str] = None</em>, <em class="sig-param">log_on_batch_end: bool = True</em>, <em class="sig-param">log_on_epoch_end: bool = True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/logging.html#TensorboardLogger.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.logging.TensorboardLogger.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metric_names</strong> – list of metric names to log,
if none - logs everything</p></li>
<li><p><strong>log_on_batch_end</strong> – logs per-batch metrics if set True</p></li>
<li><p><strong>log_on_epoch_end</strong> – logs per-epoch metrics if set True</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.logging.TensorboardLogger.on_batch_end">
<code class="sig-name descname">on_batch_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/logging.html#TensorboardLogger.on_batch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.logging.TensorboardLogger.on_batch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Translate batch metrics to tensorboard.</p>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.logging.TensorboardLogger.on_epoch_end">
<code class="sig-name descname">on_epoch_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/logging.html#TensorboardLogger.on_epoch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.logging.TensorboardLogger.on_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Translate epoch metrics to tensorboard.</p>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.logging.TensorboardLogger.on_loader_start">
<code class="sig-name descname">on_loader_start</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/logging.html#TensorboardLogger.on_loader_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.logging.TensorboardLogger.on_loader_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare tensorboard writers for the current stage.</p>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.logging.TensorboardLogger.on_stage_end">
<code class="sig-name descname">on_stage_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/logging.html#TensorboardLogger.on_stage_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.logging.TensorboardLogger.on_stage_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Close opened tensorboard writers.</p>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.logging.TensorboardLogger.on_stage_start">
<code class="sig-name descname">on_stage_start</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/logging.html#TensorboardLogger.on_stage_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.logging.TensorboardLogger.on_stage_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Stage start hook. Check <code class="docutils literal notranslate"><span class="pre">logdir</span></code> correctness.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="catalyst.callbacks.logging.VerboseLogger">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.logging.</code><code class="sig-name descname">VerboseLogger</code><span class="sig-paren">(</span><em class="sig-param">always_show: List[str] = None</em>, <em class="sig-param">never_show: List[str] = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/logging.html#VerboseLogger"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.logging.VerboseLogger" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.logging.ILoggerCallback" title="catalyst.callbacks.logging.ILoggerCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.logging.ILoggerCallback</span></code></a></p>
<p>Logs the params into console.</p>
<dl class="method">
<dt id="catalyst.callbacks.logging.VerboseLogger.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">always_show: List[str] = None</em>, <em class="sig-param">never_show: List[str] = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/logging.html#VerboseLogger.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.logging.VerboseLogger.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>always_show</strong> – list of metrics to always show
if None default is <code class="docutils literal notranslate"><span class="pre">[&quot;_timer/_fps&quot;]</span></code>
to remove always_show metrics set it to an empty list <code class="docutils literal notranslate"><span class="pre">[]</span></code></p></li>
<li><p><strong>never_show</strong> – list of metrics which will not be shown</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.logging.VerboseLogger.on_batch_end">
<code class="sig-name descname">on_batch_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/logging.html#VerboseLogger.on_batch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.logging.VerboseLogger.on_batch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Update tqdm progress bar at the end of each batch.</p>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.logging.VerboseLogger.on_exception">
<code class="sig-name descname">on_exception</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/logging.html#VerboseLogger.on_exception"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.logging.VerboseLogger.on_exception" title="Permalink to this definition">¶</a></dt>
<dd><p>Called if an Exception was raised.</p>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.logging.VerboseLogger.on_loader_end">
<code class="sig-name descname">on_loader_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/logging.html#VerboseLogger.on_loader_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.logging.VerboseLogger.on_loader_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Cleanup and close tqdm progress bar.</p>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.logging.VerboseLogger.on_loader_start">
<code class="sig-name descname">on_loader_start</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/logging.html#VerboseLogger.on_loader_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.logging.VerboseLogger.on_loader_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Init tqdm progress bar.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="catalyst.callbacks.logging.CSVLogger">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.logging.</code><code class="sig-name descname">CSVLogger</code><span class="sig-paren">(</span><em class="sig-param">metric_names: List[str] = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/logging.html#CSVLogger"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.logging.CSVLogger" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.logging.ILoggerCallback" title="catalyst.callbacks.logging.ILoggerCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.logging.ILoggerCallback</span></code></a></p>
<p>Logs metrics to csv file on epoch end</p>
<dl class="method">
<dt id="catalyst.callbacks.logging.CSVLogger.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">metric_names: List[str] = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/logging.html#CSVLogger.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.logging.CSVLogger.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>metric_names</strong> – list of metric names to log,
if none - logs everything</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.logging.CSVLogger.on_epoch_end">
<code class="sig-name descname">on_epoch_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/logging.html#CSVLogger.on_epoch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.logging.CSVLogger.on_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Logs metrics here</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – runner for experiment</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.logging.CSVLogger.on_loader_start">
<code class="sig-name descname">on_loader_start</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/logging.html#CSVLogger.on_loader_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.logging.CSVLogger.on_loader_start" title="Permalink to this definition">¶</a></dt>
<dd><p>On loader start action.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.logging.CSVLogger.on_stage_end">
<code class="sig-name descname">on_stage_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/logging.html#CSVLogger.on_stage_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.logging.CSVLogger.on_stage_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Closes loggers</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – runner for experiment</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-catalyst.callbacks.metric">
<span id="metric"></span><h3><a class="toc-backref" href="#id9">Metric</a><a class="headerlink" href="#module-catalyst.callbacks.metric" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.metric.IMetricCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.metric.</code><code class="sig-name descname">IMetricCallback</code><span class="sig-paren">(</span><em class="sig-param">prefix: str, input_key: Union[str, List[str], Dict[str, str]] = 'targets', output_key: Union[str, List[str], Dict[str, str]] = 'logits', multiplier: float = 1.0, **metrics_kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metric.html#IMetricCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metric.IMetricCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code>, <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>Callback abstraction for metric computation.</p>
<dl class="method">
<dt id="catalyst.callbacks.metric.IMetricCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">prefix: str, input_key: Union[str, List[str], Dict[str, str]] = 'targets', output_key: Union[str, List[str], Dict[str, str]] = 'logits', multiplier: float = 1.0, **metrics_kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metric.html#IMetricCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metric.IMetricCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prefix</strong> – key prefix to store computed
batch/loader/epoch metrics</p></li>
<li><p><strong>input_key</strong> – input key to use for metric calculation;
specifies our <cite>y_true</cite></p></li>
<li><p><strong>output_key</strong> – output key to use for metric calculation;
specifies our <cite>y_pred</cite></p></li>
<li><p><strong>multiplier</strong> – scalar for metric reweighting</p></li>
<li><p><strong>**metrics_kwargs</strong> – extra metric params
to pass for metric computation</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.metric.IMetricCallback.metric_fn">
<em class="property">abstract property </em><code class="sig-name descname">metric_fn</code><a class="headerlink" href="#catalyst.callbacks.metric.IMetricCallback.metric_fn" title="Permalink to this definition">¶</a></dt>
<dd><p>Specifies used metric function.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="catalyst.callbacks.metric.IBatchMetricCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.metric.</code><code class="sig-name descname">IBatchMetricCallback</code><span class="sig-paren">(</span><em class="sig-param">prefix: str, input_key: Union[str, List[str], Dict[str, str]] = 'targets', output_key: Union[str, List[str], Dict[str, str]] = 'logits', multiplier: float = 1.0, **metrics_kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metric.html#IBatchMetricCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metric.IBatchMetricCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.metric.IMetricCallback" title="catalyst.callbacks.metric.IMetricCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.metric.IMetricCallback</span></code></a></p>
<p>Batch-based metric callback.
Computes metric on batch and saves for logging.</p>
<dl class="method">
<dt id="catalyst.callbacks.metric.IBatchMetricCallback.on_batch_end">
<code class="sig-name descname">on_batch_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/metric.html#IBatchMetricCallback.on_batch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metric.IBatchMetricCallback.on_batch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes metrics and add them to batch metrics.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="catalyst.callbacks.metric.ILoaderMetricCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.metric.</code><code class="sig-name descname">ILoaderMetricCallback</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metric.html#ILoaderMetricCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metric.ILoaderMetricCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.metric.IMetricCallback" title="catalyst.callbacks.metric.IMetricCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.metric.IMetricCallback</span></code></a></p>
<p>Loader-based metric callback.
Stores input/output values during loaders run
and computes metric in the end.</p>
<dl class="method">
<dt id="catalyst.callbacks.metric.ILoaderMetricCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metric.html#ILoaderMetricCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metric.ILoaderMetricCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Init.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>**kwargs</strong> – <cite>IMetricCallback</cite> params.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.metric.ILoaderMetricCallback.on_batch_end">
<code class="sig-name descname">on_batch_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/metric.html#ILoaderMetricCallback.on_batch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metric.ILoaderMetricCallback.on_batch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores new input/output for the metric computation.</p>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.metric.ILoaderMetricCallback.on_loader_end">
<code class="sig-name descname">on_loader_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metric.html#ILoaderMetricCallback.on_loader_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metric.ILoaderMetricCallback.on_loader_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes loader-based metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.metric.ILoaderMetricCallback.on_loader_start">
<code class="sig-name descname">on_loader_start</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metric.html#ILoaderMetricCallback.on_loader_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metric.ILoaderMetricCallback.on_loader_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Reinitialises internal storage.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="catalyst.callbacks.metric.BatchMetricCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.metric.</code><code class="sig-name descname">BatchMetricCallback</code><span class="sig-paren">(</span><em class="sig-param">prefix: str, metric_fn: Callable, input_key: Union[str, List[str], Dict[str, str]] = 'targets', output_key: Union[str, List[str], Dict[str, str]] = 'logits', multiplier: float = 1.0, **metric_kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metric.html#BatchMetricCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metric.BatchMetricCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.metric.IBatchMetricCallback" title="catalyst.callbacks.metric.IBatchMetricCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.metric.IBatchMetricCallback</span></code></a></p>
<p>A callback that returns single metric on <cite>runner.on_batch_end</cite>.</p>
<dl class="method">
<dt id="catalyst.callbacks.metric.BatchMetricCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">prefix: str, metric_fn: Callable, input_key: Union[str, List[str], Dict[str, str]] = 'targets', output_key: Union[str, List[str], Dict[str, str]] = 'logits', multiplier: float = 1.0, **metric_kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metric.html#BatchMetricCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metric.BatchMetricCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Init.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prefix</strong> – key prefix to store computed
batch/loader/epoch metrics</p></li>
<li><p><strong>input_key</strong> – input key to use for metric calculation;
specifies our <cite>y_true</cite></p></li>
<li><p><strong>output_key</strong> – output key to use for metric calculation;
specifies our <cite>y_pred</cite></p></li>
<li><p><strong>multiplier</strong> – scalar for metric reweighting</p></li>
<li><p><strong>**metrics_kwargs</strong> – extra metric params
to pass for metric computation</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.metric.BatchMetricCallback.metric_fn">
<em class="property">property </em><code class="sig-name descname">metric_fn</code><a class="headerlink" href="#catalyst.callbacks.metric.BatchMetricCallback.metric_fn" title="Permalink to this definition">¶</a></dt>
<dd><p>Specifies used metric function.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="catalyst.callbacks.metric.LoaderMetricCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.metric.</code><code class="sig-name descname">LoaderMetricCallback</code><span class="sig-paren">(</span><em class="sig-param">prefix: str, metric_fn: Callable, input_key: Union[str, List[str], Dict[str, str]] = 'targets', output_key: Union[str, List[str], Dict[str, str]] = 'logits', multiplier: float = 1.0, **metric_kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metric.html#LoaderMetricCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metric.LoaderMetricCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.metric.ILoaderMetricCallback" title="catalyst.callbacks.metric.ILoaderMetricCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.metric.ILoaderMetricCallback</span></code></a></p>
<p>A callback that returns single metric on <cite>runner.on_batch_end</cite>.</p>
<dl class="method">
<dt id="catalyst.callbacks.metric.LoaderMetricCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">prefix: str, metric_fn: Callable, input_key: Union[str, List[str], Dict[str, str]] = 'targets', output_key: Union[str, List[str], Dict[str, str]] = 'logits', multiplier: float = 1.0, **metric_kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metric.html#LoaderMetricCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metric.LoaderMetricCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Init.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prefix</strong> – key prefix to store computed
batch/loader/epoch metrics</p></li>
<li><p><strong>input_key</strong> – input key to use for metric calculation;
specifies our <cite>y_true</cite></p></li>
<li><p><strong>output_key</strong> – output key to use for metric calculation;
specifies our <cite>y_pred</cite></p></li>
<li><p><strong>multiplier</strong> – scalar for metric reweighting</p></li>
<li><p><strong>**metrics_kwargs</strong> – extra metric params
to pass for metric computation</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.metric.LoaderMetricCallback.metric_fn">
<em class="property">property </em><code class="sig-name descname">metric_fn</code><a class="headerlink" href="#catalyst.callbacks.metric.LoaderMetricCallback.metric_fn" title="Permalink to this definition">¶</a></dt>
<dd><p>Specifies used metric function.</p>
</dd></dl>

</dd></dl>

<dl class="attribute">
<dt id="catalyst.callbacks.metric.MetricCallback">
<code class="sig-prename descclassname">catalyst.callbacks.metric.</code><code class="sig-name descname">MetricCallback</code><a class="headerlink" href="#catalyst.callbacks.metric.MetricCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#catalyst.callbacks.metric.BatchMetricCallback" title="catalyst.callbacks.metric.BatchMetricCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.metric.BatchMetricCallback</span></code></a></p>
</dd></dl>

<dl class="class">
<dt id="catalyst.callbacks.metric.MetricAggregationCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.metric.</code><code class="sig-name descname">MetricAggregationCallback</code><span class="sig-paren">(</span><em class="sig-param">prefix: str, metrics: Union[str, List[str], Dict[str, float]] = None, mode: str = 'mean', scope: str = 'batch', multiplier: float = 1.0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metric.html#MetricAggregationCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metric.MetricAggregationCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>A callback to aggregate several metrics in one value.</p>
<dl class="method">
<dt id="catalyst.callbacks.metric.MetricAggregationCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">prefix: str, metrics: Union[str, List[str], Dict[str, float]] = None, mode: str = 'mean', scope: str = 'batch', multiplier: float = 1.0</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/metric.html#MetricAggregationCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metric.MetricAggregationCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prefix</strong> – new key for aggregated metric.</p></li>
<li><p><strong>metrics</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>Dict</em><em>[</em><em>str</em><em>, </em><em>float</em><em>]</em><em>]</em>) – If not None,
it aggregates only the values from the metric by these keys.
for <code class="docutils literal notranslate"><span class="pre">weighted_sum</span></code> aggregation it must be a Dict[str, float].</p></li>
<li><p><strong>mode</strong> – function for aggregation.
Must be either <code class="docutils literal notranslate"><span class="pre">sum</span></code>, <code class="docutils literal notranslate"><span class="pre">mean</span></code> or <code class="docutils literal notranslate"><span class="pre">weighted_sum</span></code>.</p></li>
<li><p><strong>multiplier</strong> – scale factor for the aggregated metric.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.metric.MetricAggregationCallback.on_batch_end">
<code class="sig-name descname">on_batch_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/metric.html#MetricAggregationCallback.on_batch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metric.MetricAggregationCallback.on_batch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the metric and add it to the batch metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.metric.MetricAggregationCallback.on_epoch_end">
<code class="sig-name descname">on_epoch_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metric.html#MetricAggregationCallback.on_epoch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metric.MetricAggregationCallback.on_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the metric and add it to the epoch metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.metric.MetricAggregationCallback.on_loader_end">
<code class="sig-name descname">on_loader_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metric.html#MetricAggregationCallback.on_loader_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metric.MetricAggregationCallback.on_loader_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the metric and add it to the loader metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="catalyst.callbacks.metric.MetricManagerCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.metric.</code><code class="sig-name descname">MetricManagerCallback</code><a class="reference internal" href="../_modules/catalyst/callbacks/metric.html#MetricManagerCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metric.MetricManagerCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>Prepares metrics for logging, transferring values from PyTorch to numpy.</p>
<dl class="method">
<dt id="catalyst.callbacks.metric.MetricManagerCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metric.html#MetricManagerCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metric.MetricManagerCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Init.</p>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.metric.MetricManagerCallback.on_batch_end">
<code class="sig-name descname">on_batch_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/metric.html#MetricManagerCallback.on_batch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metric.MetricManagerCallback.on_batch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Batch end hook.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.metric.MetricManagerCallback.on_batch_start">
<code class="sig-name descname">on_batch_start</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/metric.html#MetricManagerCallback.on_batch_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metric.MetricManagerCallback.on_batch_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Batch start hook.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.metric.MetricManagerCallback.on_epoch_start">
<code class="sig-name descname">on_epoch_start</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/metric.html#MetricManagerCallback.on_epoch_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metric.MetricManagerCallback.on_epoch_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Epoch start hook.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.metric.MetricManagerCallback.on_loader_end">
<code class="sig-name descname">on_loader_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/metric.html#MetricManagerCallback.on_loader_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metric.MetricManagerCallback.on_loader_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Loader end hook.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.metric.MetricManagerCallback.on_loader_start">
<code class="sig-name descname">on_loader_start</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/metric.html#MetricManagerCallback.on_loader_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metric.MetricManagerCallback.on_loader_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Loader start hook.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.metric.MetricManagerCallback.to_single_value">
<em class="property">static </em><code class="sig-name descname">to_single_value</code><span class="sig-paren">(</span><em class="sig-param">value: Any</em><span class="sig-paren">)</span> &#x2192; float<a class="reference internal" href="../_modules/catalyst/callbacks/metric.html#MetricManagerCallback.to_single_value"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metric.MetricManagerCallback.to_single_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert any value to float.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>value</strong> – some value</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>result</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-catalyst.callbacks.optimizer">
<span id="optimizer"></span><h3><a class="toc-backref" href="#id10">Optimizer</a><a class="headerlink" href="#module-catalyst.callbacks.optimizer" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.optimizer.IOptimizerCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.optimizer.</code><code class="sig-name descname">IOptimizerCallback</code><span class="sig-paren">(</span><em class="sig-param">order: int</em>, <em class="sig-param">node: int = &lt;CallbackNode.All: 0&gt;</em>, <em class="sig-param">scope: int = &lt;CallbackScope.Stage: 0&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/optimizer.html#IOptimizerCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.optimizer.IOptimizerCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>Optimizer callback interface, abstraction over optimizer step.</p>
</dd></dl>

<dl class="class">
<dt id="catalyst.callbacks.optimizer.OptimizerCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.optimizer.</code><code class="sig-name descname">OptimizerCallback</code><span class="sig-paren">(</span><em class="sig-param">metric_key: str = None</em>, <em class="sig-param">optimizer_key: str = None</em>, <em class="sig-param">accumulation_steps: int = 1</em>, <em class="sig-param">grad_clip_params: Dict = None</em>, <em class="sig-param">decouple_weight_decay: bool = False</em>, <em class="sig-param">loss_key: str = None</em>, <em class="sig-param">use_fast_zero_grad: bool = False</em>, <em class="sig-param">xla_barrier: bool = True</em>, <em class="sig-param">use_amp: bool = None</em>, <em class="sig-param">use_apex: bool = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/optimizer.html#OptimizerCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.optimizer.OptimizerCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.optimizer.IOptimizerCallback" title="catalyst.callbacks.optimizer.IOptimizerCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.optimizer.IOptimizerCallback</span></code></a></p>
<p>Optimizer callback, abstraction over optimizer step.</p>
<dl class="method">
<dt id="catalyst.callbacks.optimizer.OptimizerCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">metric_key: str = None</em>, <em class="sig-param">optimizer_key: str = None</em>, <em class="sig-param">accumulation_steps: int = 1</em>, <em class="sig-param">grad_clip_params: Dict = None</em>, <em class="sig-param">decouple_weight_decay: bool = False</em>, <em class="sig-param">loss_key: str = None</em>, <em class="sig-param">use_fast_zero_grad: bool = False</em>, <em class="sig-param">xla_barrier: bool = True</em>, <em class="sig-param">use_amp: bool = None</em>, <em class="sig-param">use_apex: bool = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/optimizer.html#OptimizerCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.optimizer.OptimizerCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loss_key</strong> – key to get loss from <code class="docutils literal notranslate"><span class="pre">runner.batch_metrics</span></code></p></li>
<li><p><strong>optimizer_key</strong> – A key to take a optimizer in case
there are several of them and they are in a dictionary format.</p></li>
<li><p><strong>accumulation_steps</strong> – number of steps before <code class="docutils literal notranslate"><span class="pre">model.zero_grad()</span></code></p></li>
<li><p><strong>grad_clip_params</strong> – params for gradient clipping, example:
<code class="docutils literal notranslate"><span class="pre">{'func':</span> <span class="pre">'clip_grad_norm_',</span> <span class="pre">'max_norm':</span> <span class="pre">1,</span> <span class="pre">norm_type':</span> <span class="pre">2}</span></code></p></li>
<li><p><strong>decouple_weight_decay</strong> – If <code class="docutils literal notranslate"><span class="pre">True</span></code> - decouple weight decay
regularization, default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>use_fast_zero_grad</strong> – boost <code class="docutils literal notranslate"><span class="pre">optimizer.zero_grad()</span></code>,
default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>xla_barrier</strong> – barrier option for xla. Here you can find
more about usage of <a class="reference external" href="https://pytorch.org/xla/release/1.5/index.html?highlight=optimizer_step#torch_xla.core.xla_model.optimizer_step">barrier flag</a>
and <a class="reference external" href="https://pytorch.org/xla/release/1.5/index.html#running-on-a-single-xla-device">examples</a>.
Default is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>use_amp</strong> – whether to use native pytorch AMP, if None will be set
based on runner.experiment.distributed_params on stage start</p></li>
<li><p><strong>use_apex</strong> – whether to use apex, if None will be set
based on runner.experiment.distributed_params on stage start</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.optimizer.OptimizerCallback.grad_step">
<code class="sig-name descname">grad_step</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">optimizer: torch.optim.optimizer.Optimizer</em>, <em class="sig-param">grad_clip_fn: Callable = None</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/optimizer.html#OptimizerCallback.grad_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.optimizer.OptimizerCallback.grad_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes a gradient step for a given optimizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>optimizer</strong> – the optimizer</p></li>
<li><p><strong>grad_clip_fn</strong> – function for gradient clipping</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.optimizer.OptimizerCallback.on_batch_end">
<code class="sig-name descname">on_batch_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/optimizer.html#OptimizerCallback.on_batch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.optimizer.OptimizerCallback.on_batch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>On batch end event</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.optimizer.OptimizerCallback.on_batch_start">
<code class="sig-name descname">on_batch_start</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/optimizer.html#OptimizerCallback.on_batch_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.optimizer.OptimizerCallback.on_batch_start" title="Permalink to this definition">¶</a></dt>
<dd><p>On batch start event</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.optimizer.OptimizerCallback.on_epoch_end">
<code class="sig-name descname">on_epoch_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/optimizer.html#OptimizerCallback.on_epoch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.optimizer.OptimizerCallback.on_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>On epoch end event.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.optimizer.OptimizerCallback.on_epoch_start">
<code class="sig-name descname">on_epoch_start</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/optimizer.html#OptimizerCallback.on_epoch_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.optimizer.OptimizerCallback.on_epoch_start" title="Permalink to this definition">¶</a></dt>
<dd><p>On epoch start event.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.optimizer.OptimizerCallback.on_stage_end">
<code class="sig-name descname">on_stage_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/optimizer.html#OptimizerCallback.on_stage_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.optimizer.OptimizerCallback.on_stage_end" title="Permalink to this definition">¶</a></dt>
<dd><p>On stage end event.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.optimizer.OptimizerCallback.on_stage_start">
<code class="sig-name descname">on_stage_start</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/optimizer.html#OptimizerCallback.on_stage_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.optimizer.OptimizerCallback.on_stage_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Resolve amp/apex settings, prepare optimizer and scaler</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> (<a class="reference internal" href="core.html#catalyst.core.runner.IRunner" title="catalyst.core.runner.IRunner"><em>IRunner</em></a>) – current runner</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-catalyst.callbacks.periodic_loader">
<span id="periodicloadercallback"></span><h3><a class="toc-backref" href="#id11">PeriodicLoaderCallback</a><a class="headerlink" href="#module-catalyst.callbacks.periodic_loader" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.periodic_loader.PeriodicLoaderCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.periodic_loader.</code><code class="sig-name descname">PeriodicLoaderCallback</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/periodic_loader.html#PeriodicLoaderCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.periodic_loader.PeriodicLoaderCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>Callback for runing loaders with specified period.
To disable loader use <code class="docutils literal notranslate"><span class="pre">0</span></code> as period (if specified
<code class="docutils literal notranslate"><span class="pre">0</span></code> for validation loader then will be raised an
error).</p>
<p>For example, if you have <code class="docutils literal notranslate"><span class="pre">train</span></code>, <code class="docutils literal notranslate"><span class="pre">train_additional</span></code>,
<code class="docutils literal notranslate"><span class="pre">valid</span></code> and <code class="docutils literal notranslate"><span class="pre">valid_additional</span></code> loaders and wan’t to
use <code class="docutils literal notranslate"><span class="pre">train_additional</span></code> every 2 epochs, <code class="docutils literal notranslate"><span class="pre">valid</span></code> - every
3 epochs and <code class="docutils literal notranslate"><span class="pre">valid_additional</span></code> - every 5 epochs:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">catalyst.dl</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">SupervisedRunner</span><span class="p">,</span> <span class="n">PeriodicLoaderRunnerCallback</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">runner</span> <span class="o">=</span> <span class="n">SupervisedRunner</span><span class="p">()</span>
<span class="n">runner</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
    <span class="o">...</span>
    <span class="n">loaders</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span>
        <span class="s2">&quot;train_additional&quot;</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span>
        <span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span>
        <span class="s2">&quot;valid_additional&quot;</span><span class="p">:</span><span class="o">...</span>
    <span class="p">}</span>
    <span class="o">...</span>
    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span>
        <span class="o">...</span>
        <span class="n">PeriodicLoaderRunnerCallback</span><span class="p">(</span>
            <span class="n">train_additional</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">valid</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">valid_additional</span><span class="o">=</span><span class="mi">5</span>
        <span class="p">),</span>
        <span class="o">...</span>
    <span class="p">]</span>
    <span class="o">...</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="catalyst.callbacks.periodic_loader.PeriodicLoaderCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/periodic_loader.html#PeriodicLoaderCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.periodic_loader.PeriodicLoaderCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> – loader names and their run periods.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.periodic_loader.PeriodicLoaderCallback.on_epoch_end">
<code class="sig-name descname">on_epoch_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/periodic_loader.html#PeriodicLoaderCallback.on_epoch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.periodic_loader.PeriodicLoaderCallback.on_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if validation metric should be
dropped for current epoch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.periodic_loader.PeriodicLoaderCallback.on_epoch_start">
<code class="sig-name descname">on_epoch_start</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/periodic_loader.html#PeriodicLoaderCallback.on_epoch_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.periodic_loader.PeriodicLoaderCallback.on_epoch_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Set loaders for current epoch.
If validation is not required then the first loader
from loaders used in current epoch will be used
as validation loader.
Metrics from the latest epoch with true
validation loader will be used
in the epochs where this loader is missing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – if there are no loaders in epoch</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.periodic_loader.PeriodicLoaderCallback.on_stage_start">
<code class="sig-name descname">on_stage_start</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/periodic_loader.html#PeriodicLoaderCallback.on_stage_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.periodic_loader.PeriodicLoaderCallback.on_stage_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Collect information about loaders.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – if there are no loaders in epoch</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-catalyst.callbacks.pruning">
<span id="pruning"></span><h3><a class="toc-backref" href="#id12">Pruning</a><a class="headerlink" href="#module-catalyst.callbacks.pruning" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.pruning.PruningCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.pruning.</code><code class="sig-name descname">PruningCallback</code><span class="sig-paren">(</span><em class="sig-param">pruning_fn: Union[Callable, str], keys_to_prune: Optional[List[str]] = None, amount: Union[int, float, None] = 0.5, prune_on_epoch_end: Optional[bool] = False, prune_on_stage_end: Optional[bool] = True, remove_reparametrization_on_stage_end: Optional[bool] = True, reinitialize_after_pruning: Optional[bool] = False, layers_to_prune: Optional[List[str]] = None, dim: Optional[int] = None, l_norm: Optional[int] = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/pruning.html#PruningCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.pruning.PruningCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>Pruning Callback</p>
<p>This callback is designed to prune network parameters
during and/or after training.</p>
<dl class="method">
<dt id="catalyst.callbacks.pruning.PruningCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">pruning_fn: Union[Callable, str], keys_to_prune: Optional[List[str]] = None, amount: Union[int, float, None] = 0.5, prune_on_epoch_end: Optional[bool] = False, prune_on_stage_end: Optional[bool] = True, remove_reparametrization_on_stage_end: Optional[bool] = True, reinitialize_after_pruning: Optional[bool] = False, layers_to_prune: Optional[List[str]] = None, dim: Optional[int] = None, l_norm: Optional[int] = None</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/pruning.html#PruningCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.pruning.PruningCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Init method for pruning callback</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pruning_fn</strong> – function from torch.nn.utils.prune module
or your based on BasePruningMethod. Can be string e.g.
<cite>“l1_unstructured”</cite>. See pytorch docs for more details.</p></li>
<li><p><strong>keys_to_prune</strong> – list of strings. Determines
which tensor in modules will be pruned.</p></li>
<li><p><strong>amount</strong> – quantity of parameters to prune.
If float, should be between 0.0 and 1.0 and
represent the fraction of parameters to prune.
If int, it represents the absolute number
of parameters to prune.</p></li>
<li><p><strong>prune_on_epoch_end</strong> – bool flag determines call or not
to call pruning_fn on epoch end.</p></li>
<li><p><strong>prune_on_stage_end</strong> – bool flag determines call or not
to call pruning_fn on stage end.</p></li>
<li><p><strong>remove_reparametrization_on_stage_end</strong> – if True then all
reparametrization pre-hooks and tensors with mask
will be removed on stage end.</p></li>
<li><p><strong>reinitialize_after_pruning</strong> – if True then will reinitialize model
after pruning. (Lottery Ticket Hypothesis)</p></li>
<li><p><strong>layers_to_prune</strong> – list of strings - module names to be pruned.
If None provided then will try to prune every module in
model.</p></li>
<li><p><strong>dim</strong> – if you are using structured pruning method you need
to specify dimension.</p></li>
<li><p><strong>l_norm</strong> – if you are using ln_structured you need to specify l_norm.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.pruning.PruningCallback.on_epoch_end">
<code class="sig-name descname">on_epoch_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/pruning.html#PruningCallback.on_epoch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.pruning.PruningCallback.on_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>On epoch end action.</p>
<p>Active if prune_on_epoch_end is True.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – runner for your experiment</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.pruning.PruningCallback.on_stage_end">
<code class="sig-name descname">on_stage_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/pruning.html#PruningCallback.on_stage_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.pruning.PruningCallback.on_stage_end" title="Permalink to this definition">¶</a></dt>
<dd><p>On stage end action.</p>
<p>Active if prune_on_stage_end or
remove_reparametrization is True.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – runner for your experiment</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-catalyst.callbacks.quantization">
<span id="quantization"></span><h3><a class="toc-backref" href="#id13">Quantization</a><a class="headerlink" href="#module-catalyst.callbacks.quantization" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.quantization.DynamicQuantizationCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.quantization.</code><code class="sig-name descname">DynamicQuantizationCallback</code><span class="sig-paren">(</span><em class="sig-param">metric: str = 'loss'</em>, <em class="sig-param">minimize: bool = True</em>, <em class="sig-param">min_delta: float = 1e-06</em>, <em class="sig-param">mode: str = 'best'</em>, <em class="sig-param">do_once: bool = True</em>, <em class="sig-param">qconfig_spec: Union[Set</em>, <em class="sig-param">Dict</em>, <em class="sig-param">None] = None</em>, <em class="sig-param">dtype: Optional[torch.dtype] = torch.qint8</em>, <em class="sig-param">out_dir: Union[str</em>, <em class="sig-param">pathlib.Path] = None</em>, <em class="sig-param">out_model: Union[str</em>, <em class="sig-param">pathlib.Path] = None</em>, <em class="sig-param">backend: str = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/quantization.html#DynamicQuantizationCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.quantization.DynamicQuantizationCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>Dynamic Quantization Callback</p>
<p>This callback applying dynamic quantization to the model.</p>
<dl class="method">
<dt id="catalyst.callbacks.quantization.DynamicQuantizationCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">metric: str = 'loss'</em>, <em class="sig-param">minimize: bool = True</em>, <em class="sig-param">min_delta: float = 1e-06</em>, <em class="sig-param">mode: str = 'best'</em>, <em class="sig-param">do_once: bool = True</em>, <em class="sig-param">qconfig_spec: Union[Set</em>, <em class="sig-param">Dict</em>, <em class="sig-param">None] = None</em>, <em class="sig-param">dtype: Optional[torch.dtype] = torch.qint8</em>, <em class="sig-param">out_dir: Union[str</em>, <em class="sig-param">pathlib.Path] = None</em>, <em class="sig-param">out_model: Union[str</em>, <em class="sig-param">pathlib.Path] = None</em>, <em class="sig-param">backend: str = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/quantization.html#DynamicQuantizationCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.quantization.DynamicQuantizationCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Init method for callback</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metric</strong> – Metric key we should trace model based on</p></li>
<li><p><strong>minimize</strong> – Whether do we minimize metric or not</p></li>
<li><p><strong>min_delta</strong> – Minimum value of change for metric to be
considered as improved</p></li>
<li><p><strong>mode</strong> – One of <cite>best</cite> or <cite>last</cite></p></li>
<li><p><strong>do_once</strong> – Whether do we trace once per stage or every epoch</p></li>
<li><p><strong>qconfig_spec</strong> – torch.quantization.quantize_dynamic
parameter, you can define layers to be quantize</p></li>
<li><p><strong>dtype</strong> – type of the model parameters, default int8</p></li>
<li><p><strong>out_dir</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em>) – Directory to save model to</p></li>
<li><p><strong>out_model</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em>) – Path to save model to
(overrides <cite>out_dir</cite> argument)</p></li>
<li><p><strong>backend</strong> – defines backend for quantization</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.quantization.DynamicQuantizationCallback.on_epoch_end">
<code class="sig-name descname">on_epoch_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/quantization.html#DynamicQuantizationCallback.on_epoch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.quantization.DynamicQuantizationCallback.on_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Performing model quantization on epoch end if condition metric is
improved</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.quantization.DynamicQuantizationCallback.on_stage_end">
<code class="sig-name descname">on_stage_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/quantization.html#DynamicQuantizationCallback.on_stage_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.quantization.DynamicQuantizationCallback.on_stage_end" title="Permalink to this definition">¶</a></dt>
<dd><p>On stage end action.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – runner of your experiment</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-catalyst.callbacks.scheduler">
<span id="scheduler"></span><h3><a class="toc-backref" href="#id14">Scheduler</a><a class="headerlink" href="#module-catalyst.callbacks.scheduler" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.scheduler.ISchedulerCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.scheduler.</code><code class="sig-name descname">ISchedulerCallback</code><span class="sig-paren">(</span><em class="sig-param">order: int</em>, <em class="sig-param">node: int = &lt;CallbackNode.All: 0&gt;</em>, <em class="sig-param">scope: int = &lt;CallbackScope.Stage: 0&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/scheduler.html#ISchedulerCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.scheduler.ISchedulerCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>Scheduler callback interface, abstraction over scheduler step.</p>
</dd></dl>

<dl class="class">
<dt id="catalyst.callbacks.scheduler.SchedulerCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.scheduler.</code><code class="sig-name descname">SchedulerCallback</code><span class="sig-paren">(</span><em class="sig-param">scheduler_key: str = None</em>, <em class="sig-param">mode: str = None</em>, <em class="sig-param">reduced_metric: str = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/scheduler.html#SchedulerCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.scheduler.SchedulerCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.scheduler.ISchedulerCallback" title="catalyst.callbacks.scheduler.ISchedulerCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.scheduler.ISchedulerCallback</span></code></a></p>
<p>Callback for wrapping schedulers.</p>
<p>Notebook API example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">DataLoader</span><span class="p">,</span> <span class="n">TensorDataset</span>
<span class="kn">from</span> <span class="nn">catalyst.dl</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">SupervisedRunner</span><span class="p">,</span> <span class="n">AccuracyCallback</span><span class="p">,</span>
    <span class="n">CriterionCallback</span><span class="p">,</span> <span class="n">SchedulerCallback</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">num_samples</span><span class="p">,</span> <span class="n">num_features</span> <span class="o">=</span> <span class="mi">10_000</span><span class="p">,</span> <span class="mi">10</span>
<span class="n">n_classes</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_samples</span><span class="p">,</span> <span class="n">num_features</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_classes</span><span class="p">,</span> <span class="p">[</span><span class="n">num_samples</span><span class="p">])</span>
<span class="n">loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">TensorDataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">loaders</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="n">loader</span><span class="p">,</span> <span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="n">loader</span><span class="p">}</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">num_features</span><span class="p">,</span> <span class="n">n_classes</span><span class="p">)</span>
<span class="n">criterion</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>
<span class="n">scheduler</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">lr_scheduler</span><span class="o">.</span><span class="n">MultiStepLR</span><span class="p">(</span><span class="n">optimizer</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>

<span class="n">runner</span> <span class="o">=</span> <span class="n">SupervisedRunner</span><span class="p">()</span>
<span class="n">runner</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
    <span class="n">criterion</span><span class="o">=</span><span class="n">criterion</span><span class="p">,</span>
    <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
    <span class="n">scheduler</span><span class="o">=</span><span class="n">scheduler</span><span class="p">,</span>
    <span class="n">loaders</span><span class="o">=</span><span class="n">loaders</span><span class="p">,</span>
    <span class="n">logdir</span><span class="o">=</span><span class="s2">&quot;./logdir&quot;</span><span class="p">,</span>
    <span class="n">num_epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">main_metric</span><span class="o">=</span><span class="s2">&quot;accuracy03&quot;</span><span class="p">,</span>
    <span class="n">minimize_metric</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span>
        <span class="n">AccuracyCallback</span><span class="p">(</span>
            <span class="n">accuracy_args</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
        <span class="p">),</span>
        <span class="n">SchedulerCallback</span><span class="p">(</span><span class="n">reduced_metric</span><span class="o">=</span><span class="s2">&quot;loss&quot;</span><span class="p">)</span>
    <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Config API usage example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">stages</span><span class="p">:</span>
  <span class="l l-Scalar l-Scalar-Plain">...</span>
  <span class="l l-Scalar l-Scalar-Plain">scheduler_params</span><span class="p p-Indicator">:</span>
    <span class="nt">scheduler</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">MultiStepLR</span>
    <span class="nt">milestones</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">1</span><span class="p p-Indicator">]</span>
    <span class="nt">gamma</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.3</span>
  <span class="l l-Scalar l-Scalar-Plain">...</span>
  <span class="nt">stage_N</span><span class="p">:</span>
    <span class="l l-Scalar l-Scalar-Plain">...</span>
    <span class="l l-Scalar l-Scalar-Plain">callbacks_params</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">...</span>
      <span class="l l-Scalar l-Scalar-Plain">scheduler</span><span class="p p-Indicator">:</span>
        <span class="nt">callback</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">SchedulerCallback</span>
        <span class="c1"># arguments for SchedulerCallback</span>
        <span class="nt">reduced_metric</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">loss</span>
  <span class="l l-Scalar l-Scalar-Plain">...</span>
</pre></div>
</div>
<dl class="method">
<dt id="catalyst.callbacks.scheduler.SchedulerCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">scheduler_key: str = None</em>, <em class="sig-param">mode: str = None</em>, <em class="sig-param">reduced_metric: str = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/scheduler.html#SchedulerCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.scheduler.SchedulerCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scheduler_key</strong> – scheduler name, if <code class="docutils literal notranslate"><span class="pre">None</span></code>,
default is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>mode</strong> – scheduler mode, should be one of
<code class="docutils literal notranslate"><span class="pre">&quot;epoch&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;batch&quot;</span></code>, default is <code class="docutils literal notranslate"><span class="pre">None</span></code>.
If <code class="docutils literal notranslate"><span class="pre">None</span></code> and object is instance of <code class="docutils literal notranslate"><span class="pre">BatchScheduler</span></code>
or <code class="docutils literal notranslate"><span class="pre">OneCycleLRWithWarmup</span></code> then will be used <code class="docutils literal notranslate"><span class="pre">&quot;batch&quot;</span></code>
otherwise - <code class="docutils literal notranslate"><span class="pre">&quot;epoch&quot;</span></code>.</p></li>
<li><p><strong>reduced_metric</strong> – metric name to forward to scheduler
object, if <code class="docutils literal notranslate"><span class="pre">None</span></code> then will be used main metric
specified in experiment.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.scheduler.SchedulerCallback.on_batch_end">
<code class="sig-name descname">on_batch_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/scheduler.html#SchedulerCallback.on_batch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.scheduler.SchedulerCallback.on_batch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Batch end hook.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.scheduler.SchedulerCallback.on_epoch_end">
<code class="sig-name descname">on_epoch_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/scheduler.html#SchedulerCallback.on_epoch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.scheduler.SchedulerCallback.on_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Epoch end hook.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.scheduler.SchedulerCallback.on_loader_start">
<code class="sig-name descname">on_loader_start</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/scheduler.html#SchedulerCallback.on_loader_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.scheduler.SchedulerCallback.on_loader_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Loader start hook.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.scheduler.SchedulerCallback.on_stage_start">
<code class="sig-name descname">on_stage_start</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/scheduler.html#SchedulerCallback.on_stage_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.scheduler.SchedulerCallback.on_stage_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Stage start hook.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.scheduler.SchedulerCallback.step_batch">
<code class="sig-name descname">step_batch</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/scheduler.html#SchedulerCallback.step_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.scheduler.SchedulerCallback.step_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform scheduler step and update batch metrics</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.scheduler.SchedulerCallback.step_epoch">
<code class="sig-name descname">step_epoch</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/scheduler.html#SchedulerCallback.step_epoch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.scheduler.SchedulerCallback.step_epoch" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform scheduler step and update epoch metrics</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="catalyst.callbacks.scheduler.ILRUpdater">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.scheduler.</code><code class="sig-name descname">ILRUpdater</code><span class="sig-paren">(</span><em class="sig-param">optimizer_key: str = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/scheduler.html#ILRUpdater"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.scheduler.ILRUpdater" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code>, <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>Basic class that all Lr updaters inherit from.</p>
<dl class="method">
<dt id="catalyst.callbacks.scheduler.ILRUpdater.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">optimizer_key: str = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/scheduler.html#ILRUpdater.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.scheduler.ILRUpdater.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>optimizer_key</strong> – which optimizer key to use
for learning rate scheduling</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.scheduler.ILRUpdater.calc_lr">
<em class="property">abstract </em><code class="sig-name descname">calc_lr</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/scheduler.html#ILRUpdater.calc_lr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.scheduler.ILRUpdater.calc_lr" title="Permalink to this definition">¶</a></dt>
<dd><p>Interface for calculating learning rate.</p>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.scheduler.ILRUpdater.calc_momentum">
<em class="property">abstract </em><code class="sig-name descname">calc_momentum</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/scheduler.html#ILRUpdater.calc_momentum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.scheduler.ILRUpdater.calc_momentum" title="Permalink to this definition">¶</a></dt>
<dd><p>Interface for calculating momentum</p>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.scheduler.ILRUpdater.on_batch_end">
<code class="sig-name descname">on_batch_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/scheduler.html#ILRUpdater.on_batch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.scheduler.ILRUpdater.on_batch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Batch end hook.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.scheduler.ILRUpdater.on_loader_start">
<code class="sig-name descname">on_loader_start</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/scheduler.html#ILRUpdater.on_loader_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.scheduler.ILRUpdater.on_loader_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Loader start hook.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.scheduler.ILRUpdater.on_stage_start">
<code class="sig-name descname">on_stage_start</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/scheduler.html#ILRUpdater.on_stage_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.scheduler.ILRUpdater.on_stage_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Stage start hook.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.scheduler.ILRUpdater.update_optimizer">
<code class="sig-name descname">update_optimizer</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/scheduler.html#ILRUpdater.update_optimizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.scheduler.ILRUpdater.update_optimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Update learning rate and momentum in runner.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="catalyst.callbacks.scheduler.LRFinder">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.scheduler.</code><code class="sig-name descname">LRFinder</code><span class="sig-paren">(</span><em class="sig-param">final_lr</em>, <em class="sig-param">scale: str = 'log'</em>, <em class="sig-param">num_steps: Optional[int] = None</em>, <em class="sig-param">optimizer_key: str = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/scheduler.html#LRFinder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.scheduler.LRFinder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.scheduler.ILRUpdater" title="catalyst.callbacks.scheduler.ILRUpdater"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.scheduler.ILRUpdater</span></code></a></p>
<p>Helps you find an optimal learning rate for a model, as per suggestion of
<a class="reference external" href="https://arxiv.org/abs/1506.01186">Cyclical Learning Rates for Training Neural Networks</a> paper.
Learning rate is increased in linear or log scale, depending on user input.</p>
<p>See <a class="reference external" href="https://sgugger.github.io/how-do-you-find-a-good-learning-rate.html">How Do You Find A Good Learning Rate</a> article for details.</p>
<dl class="method">
<dt id="catalyst.callbacks.scheduler.LRFinder.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">final_lr</em>, <em class="sig-param">scale: str = 'log'</em>, <em class="sig-param">num_steps: Optional[int] = None</em>, <em class="sig-param">optimizer_key: str = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/scheduler.html#LRFinder.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.scheduler.LRFinder.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>final_lr</strong> – final learning rate to try with</p></li>
<li><p><strong>scale</strong> – learning rate increasing scale (“log” or “linear”)</p></li>
<li><p><strong>num_steps</strong> – number of batches to try;
if None - whole loader would be used.</p></li>
<li><p><strong>optimizer_key</strong> – which optimizer key to use
for learning rate scheduling</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.scheduler.LRFinder.calc_lr">
<code class="sig-name descname">calc_lr</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/scheduler.html#LRFinder.calc_lr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.scheduler.LRFinder.calc_lr" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates learning rate.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>learning rate.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.scheduler.LRFinder.calc_momentum">
<code class="sig-name descname">calc_momentum</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/scheduler.html#LRFinder.calc_momentum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.scheduler.LRFinder.calc_momentum" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates new momentum.</p>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.scheduler.LRFinder.on_batch_end">
<code class="sig-name descname">on_batch_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/scheduler.html#LRFinder.on_batch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.scheduler.LRFinder.on_batch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Batch end hook. Make scheduler step and stops iterating if needed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – at the end of LRFinder</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.scheduler.LRFinder.on_loader_start">
<code class="sig-name descname">on_loader_start</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/scheduler.html#LRFinder.on_loader_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.scheduler.LRFinder.on_loader_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Loader start hook. Updates scheduler statistics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-catalyst.callbacks.timer">
<span id="timer"></span><h3><a class="toc-backref" href="#id15">Timer</a><a class="headerlink" href="#module-catalyst.callbacks.timer" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.timer.TimerCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.timer.</code><code class="sig-name descname">TimerCallback</code><a class="reference internal" href="../_modules/catalyst/callbacks/timer.html#TimerCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.timer.TimerCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>Logs pipeline execution time.</p>
<dl class="method">
<dt id="catalyst.callbacks.timer.TimerCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/timer.html#TimerCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.timer.TimerCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialisation for TimerCallback.</p>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.timer.TimerCallback.on_batch_end">
<code class="sig-name descname">on_batch_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/timer.html#TimerCallback.on_batch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.timer.TimerCallback.on_batch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Batch end hook.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.timer.TimerCallback.on_batch_start">
<code class="sig-name descname">on_batch_start</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/timer.html#TimerCallback.on_batch_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.timer.TimerCallback.on_batch_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Batch start hook.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.timer.TimerCallback.on_loader_end">
<code class="sig-name descname">on_loader_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/timer.html#TimerCallback.on_loader_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.timer.TimerCallback.on_loader_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Loader end hook.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.timer.TimerCallback.on_loader_start">
<code class="sig-name descname">on_loader_start</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/timer.html#TimerCallback.on_loader_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.timer.TimerCallback.on_loader_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Loader start hook.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-catalyst.callbacks.tracing">
<span id="tracing"></span><h3><a class="toc-backref" href="#id16">Tracing</a><a class="headerlink" href="#module-catalyst.callbacks.tracing" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.tracing.TracingCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.tracing.</code><code class="sig-name descname">TracingCallback</code><span class="sig-paren">(</span><em class="sig-param">metric: str = 'loss'</em>, <em class="sig-param">minimize: bool = True</em>, <em class="sig-param">min_delta: float = 1e-06</em>, <em class="sig-param">mode: str = 'best'</em>, <em class="sig-param">do_once: bool = True</em>, <em class="sig-param">method_name: str = 'forward'</em>, <em class="sig-param">requires_grad: bool = False</em>, <em class="sig-param">opt_level: str = None</em>, <em class="sig-param">trace_mode: str = 'eval'</em>, <em class="sig-param">out_dir: Union[str</em>, <em class="sig-param">pathlib.Path] = None</em>, <em class="sig-param">out_model: Union[str</em>, <em class="sig-param">pathlib.Path] = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/tracing.html#TracingCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.tracing.TracingCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>Traces model during training if <cite>metric</cite> provided is improved.</p>
<dl class="method">
<dt id="catalyst.callbacks.tracing.TracingCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">metric: str = 'loss'</em>, <em class="sig-param">minimize: bool = True</em>, <em class="sig-param">min_delta: float = 1e-06</em>, <em class="sig-param">mode: str = 'best'</em>, <em class="sig-param">do_once: bool = True</em>, <em class="sig-param">method_name: str = 'forward'</em>, <em class="sig-param">requires_grad: bool = False</em>, <em class="sig-param">opt_level: str = None</em>, <em class="sig-param">trace_mode: str = 'eval'</em>, <em class="sig-param">out_dir: Union[str</em>, <em class="sig-param">pathlib.Path] = None</em>, <em class="sig-param">out_model: Union[str</em>, <em class="sig-param">pathlib.Path] = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/tracing.html#TracingCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.tracing.TracingCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metric</strong> – Metric key we should trace model based on</p></li>
<li><p><strong>minimize</strong> – Whether do we minimize metric or not</p></li>
<li><p><strong>min_delta</strong> – Minimum value of change for metric to be
considered as improved</p></li>
<li><p><strong>mode</strong> – One of <cite>best</cite> or <cite>last</cite></p></li>
<li><p><strong>do_once</strong> – Whether do we trace once per stage or every epoch</p></li>
<li><p><strong>method_name</strong> – Model’s method name that will be
used as entrypoint during tracing</p></li>
<li><p><strong>requires_grad</strong> – Flag to use grads</p></li>
<li><p><strong>opt_level</strong> – AMP FP16 init level</p></li>
<li><p><strong>trace_mode</strong> – Mode for model to trace
(<code class="docutils literal notranslate"><span class="pre">train</span></code> or <code class="docutils literal notranslate"><span class="pre">eval</span></code>)</p></li>
<li><p><strong>out_dir</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em>) – Directory to save model to</p></li>
<li><p><strong>out_model</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em>) – Path to save model to
(overrides <cite>out_dir</cite> argument)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.tracing.TracingCallback.on_epoch_end">
<code class="sig-name descname">on_epoch_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/tracing.html#TracingCallback.on_epoch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.tracing.TracingCallback.on_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Performing model tracing on epoch end if condition metric is improved</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.tracing.TracingCallback.on_stage_end">
<code class="sig-name descname">on_stage_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/tracing.html#TracingCallback.on_stage_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.tracing.TracingCallback.on_stage_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Performing model tracing on stage end if <cite>do_once</cite> is True.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="attribute">
<dt id="catalyst.callbacks.tracing.TracerCallback">
<code class="sig-prename descclassname">catalyst.callbacks.tracing.</code><code class="sig-name descname">TracerCallback</code><a class="headerlink" href="#catalyst.callbacks.tracing.TracerCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#catalyst.callbacks.tracing.TracingCallback" title="catalyst.callbacks.tracing.TracingCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.tracing.TracingCallback</span></code></a></p>
</dd></dl>

</div>
<div class="section" id="module-catalyst.callbacks.validation">
<span id="validation"></span><h3><a class="toc-backref" href="#id17">Validation</a><a class="headerlink" href="#module-catalyst.callbacks.validation" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.validation.ValidationManagerCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.validation.</code><code class="sig-name descname">ValidationManagerCallback</code><a class="reference internal" href="../_modules/catalyst/callbacks/validation.html#ValidationManagerCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.validation.ValidationManagerCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>A callback to aggregate runner.valid_metrics from runner.epoch_metrics.</p>
<dl class="method">
<dt id="catalyst.callbacks.validation.ValidationManagerCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/validation.html#ValidationManagerCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.validation.ValidationManagerCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialisation for ValidationManagerCallback.</p>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.validation.ValidationManagerCallback.on_epoch_end">
<code class="sig-name descname">on_epoch_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/validation.html#ValidationManagerCallback.on_epoch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.validation.ValidationManagerCallback.on_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Epoch end hook.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.validation.ValidationManagerCallback.on_epoch_start">
<code class="sig-name descname">on_epoch_start</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/validation.html#ValidationManagerCallback.on_epoch_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.validation.ValidationManagerCallback.on_epoch_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Epoch start hook.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-catalyst.callbacks.metrics">
<span id="metrics"></span><h2><a class="toc-backref" href="#id18">Metrics</a><a class="headerlink" href="#module-catalyst.callbacks.metrics" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-catalyst.callbacks.metrics.accuracy">
<span id="accuracy"></span><h3><a class="toc-backref" href="#id19">Accuracy</a><a class="headerlink" href="#module-catalyst.callbacks.metrics.accuracy" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.metrics.accuracy.AccuracyCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.metrics.accuracy.</code><code class="sig-name descname">AccuracyCallback</code><span class="sig-paren">(</span><em class="sig-param">input_key: str = 'targets'</em>, <em class="sig-param">output_key: str = 'logits'</em>, <em class="sig-param">prefix: str = 'accuracy'</em>, <em class="sig-param">topk_args: List[int] = None</em>, <em class="sig-param">num_classes: int = None</em>, <em class="sig-param">accuracy_args: List[int] = None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/accuracy.html#AccuracyCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.accuracy.AccuracyCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.metric.BatchMetricCallback" title="catalyst.callbacks.metric.BatchMetricCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.metric.BatchMetricCallback</span></code></a></p>
<p>Accuracy metric callback.
Computes multiclass <a class="reference external" href="mailto:accuracy&#37;&#52;&#48;topk">accuracy<span>&#64;</span>topk</a> for the specified values of <cite>topk</cite>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For multilabel accuracy please use
<cite>catalyst.callbacks.metrics.MultiLabelAccuracyCallback</cite></p>
</div>
<dl class="method">
<dt id="catalyst.callbacks.metrics.accuracy.AccuracyCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">input_key: str = 'targets'</em>, <em class="sig-param">output_key: str = 'logits'</em>, <em class="sig-param">prefix: str = 'accuracy'</em>, <em class="sig-param">topk_args: List[int] = None</em>, <em class="sig-param">num_classes: int = None</em>, <em class="sig-param">accuracy_args: List[int] = None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/accuracy.html#AccuracyCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.accuracy.AccuracyCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_key</strong> – input key to use for accuracy calculation;
specifies our <cite>y_true</cite></p></li>
<li><p><strong>output_key</strong> – output key to use for accuracy calculation;
specifies our <cite>y_pred</cite></p></li>
<li><p><strong>prefix</strong> – key for the metric’s name</p></li>
<li><p><strong>topk_args</strong> – specifies which accuracy&#64;K to log:
[1] - accuracy
[1, 3] - accuracy at 1 and 3
[1, 3, 5] - accuracy at 1, 3 and 5</p></li>
<li><p><strong>num_classes</strong> – number of classes to calculate <code class="docutils literal notranslate"><span class="pre">topk_args</span></code>
if <code class="docutils literal notranslate"><span class="pre">accuracy_args</span></code> is None</p></li>
<li><p><strong>**kwargs</strong> – key-value params to pass to the metric</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code> info, please follow
<code class="docutils literal notranslate"><span class="pre">catalyst.callbacks.metric.BatchMetricCallback</span></code> and
<code class="docutils literal notranslate"><span class="pre">catalyst.metrics.accuracy.accuracy</span></code> docs</p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="catalyst.callbacks.metrics.accuracy.MultiLabelAccuracyCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.metrics.accuracy.</code><code class="sig-name descname">MultiLabelAccuracyCallback</code><span class="sig-paren">(</span><em class="sig-param">input_key: str = 'targets'</em>, <em class="sig-param">output_key: str = 'logits'</em>, <em class="sig-param">prefix: str = 'multilabel_accuracy'</em>, <em class="sig-param">activation: str = 'Sigmoid'</em>, <em class="sig-param">threshold: float = None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/accuracy.html#MultiLabelAccuracyCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.accuracy.MultiLabelAccuracyCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.metric.BatchMetricCallback" title="catalyst.callbacks.metric.BatchMetricCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.metric.BatchMetricCallback</span></code></a></p>
<p>Accuracy metric callback.
Computes multiclass <a class="reference external" href="mailto:accuracy&#37;&#52;&#48;topk">accuracy<span>&#64;</span>topk</a> for the specified values of <cite>topk</cite>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For multilabel accuracy please use
<cite>catalyst.callbacks.metrics.MultiLabelAccuracyCallback</cite></p>
</div>
<dl class="method">
<dt id="catalyst.callbacks.metrics.accuracy.MultiLabelAccuracyCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">input_key: str = 'targets'</em>, <em class="sig-param">output_key: str = 'logits'</em>, <em class="sig-param">prefix: str = 'multilabel_accuracy'</em>, <em class="sig-param">activation: str = 'Sigmoid'</em>, <em class="sig-param">threshold: float = None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/accuracy.html#MultiLabelAccuracyCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.accuracy.MultiLabelAccuracyCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_key</strong> – input key to use for accuracy calculation;
specifies our <cite>y_true</cite></p></li>
<li><p><strong>output_key</strong> – output key to use for accuracy calculation;
specifies our <cite>y_pred</cite></p></li>
<li><p><strong>prefix</strong> – key for the metric’s name</p></li>
<li><p><strong>activation</strong> – An torch.nn activation applied to the outputs.
Must be one of <code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Sigmoid&quot;</span></code>, or <code class="docutils literal notranslate"><span class="pre">&quot;Softmax&quot;</span></code></p></li>
<li><p><strong>threshold</strong> – threshold for for model output</p></li>
<li><p><strong>**kwargs</strong> – key-value params to pass to the metric</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code> info, please follow
<code class="docutils literal notranslate"><span class="pre">catalyst.callbacks.metric.BatchMetricCallback</span></code> and
<code class="docutils literal notranslate"><span class="pre">catalyst.metrics.accuracy.multilabel_accuracy</span></code> docs</p>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-catalyst.callbacks.metrics.auc">
<span id="auc"></span><h3><a class="toc-backref" href="#id20">AUC</a><a class="headerlink" href="#module-catalyst.callbacks.metrics.auc" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.metrics.auc.AUCCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.metrics.auc.</code><code class="sig-name descname">AUCCallback</code><span class="sig-paren">(</span><em class="sig-param">input_key: str = 'targets'</em>, <em class="sig-param">output_key: str = 'logits'</em>, <em class="sig-param">prefix: str = 'auc'</em>, <em class="sig-param">activation: str = 'Sigmoid'</em>, <em class="sig-param">per_class: bool = False</em>, <em class="sig-param">class_args: List[str] = None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/auc.html#AUCCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.auc.AUCCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.metric.LoaderMetricCallback" title="catalyst.callbacks.metric.LoaderMetricCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.metric.LoaderMetricCallback</span></code></a></p>
<p>Calculates the AUC  per class for each loader.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently, supports binary and multilabel cases.</p>
</div>
<dl class="method">
<dt id="catalyst.callbacks.metrics.auc.AUCCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">input_key: str = 'targets'</em>, <em class="sig-param">output_key: str = 'logits'</em>, <em class="sig-param">prefix: str = 'auc'</em>, <em class="sig-param">activation: str = 'Sigmoid'</em>, <em class="sig-param">per_class: bool = False</em>, <em class="sig-param">class_args: List[str] = None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/auc.html#AUCCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.auc.AUCCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_key</strong> – input key to use for auc calculation
specifies our <code class="docutils literal notranslate"><span class="pre">y_true</span></code>.</p></li>
<li><p><strong>output_key</strong> – output key to use for auc calculation;
specifies our <code class="docutils literal notranslate"><span class="pre">y_pred</span></code>.</p></li>
<li><p><strong>prefix</strong> – key for the metric’s name</p></li>
<li><p><strong>activation</strong> – An torch.nn activation applied to the outputs.
Must be one of <code class="docutils literal notranslate"><span class="pre">'none'</span></code>, <code class="docutils literal notranslate"><span class="pre">'Sigmoid'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'Softmax'</span></code></p></li>
<li><p><strong>per_class</strong> – boolean flag to log per class metrics,
or use mean/macro statistics otherwise</p></li>
<li><p><strong>class_args</strong> – class names to display in the logs.
If None, defaults to indices for each class, starting from 0</p></li>
<li><p><strong>**kwargs</strong> – key-value params to pass to the metric</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code> info, please follow
<code class="docutils literal notranslate"><span class="pre">catalyst.callbacks.metric.LoaderMetricCallback</span></code> and
<code class="docutils literal notranslate"><span class="pre">catalyst.metrics.auc.auc</span></code> docs</p>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-catalyst.callbacks.metrics.cmc_score">
<span id="cmc-score"></span><h3><a class="toc-backref" href="#id21">CMC score</a><a class="headerlink" href="#module-catalyst.callbacks.metrics.cmc_score" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.metrics.cmc_score.CMCScoreCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.metrics.cmc_score.</code><code class="sig-name descname">CMCScoreCallback</code><span class="sig-paren">(</span><em class="sig-param">embeddings_key: str = 'logits'</em>, <em class="sig-param">labels_key: str = 'targets'</em>, <em class="sig-param">is_query_key: str = 'is_query'</em>, <em class="sig-param">prefix: str = 'cmc'</em>, <em class="sig-param">topk_args: List[int] = None</em>, <em class="sig-param">num_classes: int = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/cmc_score.html#CMCScoreCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.cmc_score.CMCScoreCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>Cumulative Matching Characteristics callback.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You should use it with <cite>ControlFlowCallback</cite>
and add all query/gallery sets to loaders.
Loaders should contain “is_query” and “label” key.</p>
</div>
<p>An usage example can be found in Readme.md under
“CV - MNIST with Metric Learning”.</p>
<dl class="method">
<dt id="catalyst.callbacks.metrics.cmc_score.CMCScoreCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">embeddings_key: str = 'logits'</em>, <em class="sig-param">labels_key: str = 'targets'</em>, <em class="sig-param">is_query_key: str = 'is_query'</em>, <em class="sig-param">prefix: str = 'cmc'</em>, <em class="sig-param">topk_args: List[int] = None</em>, <em class="sig-param">num_classes: int = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/cmc_score.html#CMCScoreCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.cmc_score.CMCScoreCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>This callback was designed to count
cumulative matching characteristics.
If current object is from query your dataset
should output <cite>True</cite> in <cite>is_query_key</cite>
and false if current object is from gallery.
You can see <cite>QueryGalleryDataset</cite> in
<cite>catalyst.contrib.datasets.metric_learning</cite> for more information.
On batch end callback accumulate all embeddings</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>embeddings_key</strong> – embeddings key in output dict</p></li>
<li><p><strong>labels_key</strong> – labels key in output dict</p></li>
<li><p><strong>is_query_key</strong> – bool key True if current
object is from query</p></li>
<li><p><strong>prefix</strong> – key for the metric’s name</p></li>
<li><p><strong>topk_args</strong> – specifies which cmc&#64;K to log.
[1] - cmc&#64;1
[1, 3] - cmc&#64;1 and cmc&#64;3
[1, 3, 5] - cmc&#64;1, cmc&#64;3 and cmc&#64;5</p></li>
<li><p><strong>num_classes</strong> – number of classes to calculate <code class="docutils literal notranslate"><span class="pre">accuracy_args</span></code>
if <code class="docutils literal notranslate"><span class="pre">topk_args</span></code> is None</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.metrics.cmc_score.CMCScoreCallback.on_batch_end">
<code class="sig-name descname">on_batch_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/cmc_score.html#CMCScoreCallback.on_batch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.cmc_score.CMCScoreCallback.on_batch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>On batch end action</p>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.metrics.cmc_score.CMCScoreCallback.on_loader_end">
<code class="sig-name descname">on_loader_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/cmc_score.html#CMCScoreCallback.on_loader_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.cmc_score.CMCScoreCallback.on_loader_end" title="Permalink to this definition">¶</a></dt>
<dd><p>On loader end action</p>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.metrics.cmc_score.CMCScoreCallback.on_loader_start">
<code class="sig-name descname">on_loader_start</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/cmc_score.html#CMCScoreCallback.on_loader_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.cmc_score.CMCScoreCallback.on_loader_start" title="Permalink to this definition">¶</a></dt>
<dd><p>On loader start action</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-catalyst.callbacks.metrics.dice">
<span id="dice"></span><h3><a class="toc-backref" href="#id22">Dice</a><a class="headerlink" href="#module-catalyst.callbacks.metrics.dice" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.metrics.dice.DiceCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.metrics.dice.</code><code class="sig-name descname">DiceCallback</code><span class="sig-paren">(</span><em class="sig-param">input_key: str = 'targets'</em>, <em class="sig-param">output_key: str = 'logits'</em>, <em class="sig-param">prefix: str = 'dice'</em>, <em class="sig-param">activation: str = 'Sigmoid'</em>, <em class="sig-param">per_class: bool = False</em>, <em class="sig-param">class_args: List[str] = None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/dice.html#DiceCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.dice.DiceCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.metric.BatchMetricCallback" title="catalyst.callbacks.metric.BatchMetricCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.metric.BatchMetricCallback</span></code></a></p>
<p>Dice metric callback.</p>
<dl class="method">
<dt id="catalyst.callbacks.metrics.dice.DiceCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">input_key: str = 'targets'</em>, <em class="sig-param">output_key: str = 'logits'</em>, <em class="sig-param">prefix: str = 'dice'</em>, <em class="sig-param">activation: str = 'Sigmoid'</em>, <em class="sig-param">per_class: bool = False</em>, <em class="sig-param">class_args: List[str] = None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/dice.html#DiceCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.dice.DiceCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_key</strong> – input key to use for iou calculation
specifies our <code class="docutils literal notranslate"><span class="pre">y_true</span></code></p></li>
<li><p><strong>output_key</strong> – output key to use for iou calculation;
specifies our <code class="docutils literal notranslate"><span class="pre">y_pred</span></code></p></li>
<li><p><strong>prefix</strong> – key to store in logs</p></li>
<li><p><strong>activation</strong> – An torch.nn activation applied to the outputs.
Must be one of <code class="docutils literal notranslate"><span class="pre">'none'</span></code>, <code class="docutils literal notranslate"><span class="pre">'Sigmoid'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'Softmax'</span></code></p></li>
<li><p><strong>per_class</strong> – boolean flag to log per class metrics,
or use mean/macro statistics otherwise</p></li>
<li><p><strong>class_args</strong> – class names to display in the logs.
If None, defaults to indices for each class, starting from 0</p></li>
<li><p><strong>**kwargs</strong> – key-value params to pass to the metric</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code> info, please follow
<code class="docutils literal notranslate"><span class="pre">catalyst.callbacks.metric.BatchMetricCallback</span></code> and
<code class="docutils literal notranslate"><span class="pre">catalyst.metrics.dice.dice</span></code> docs</p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="catalyst.callbacks.metrics.dice.MultiClassDiceMetricCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.metrics.dice.</code><code class="sig-name descname">MultiClassDiceMetricCallback</code><span class="sig-paren">(</span><em class="sig-param">input_key: str = 'targets'</em>, <em class="sig-param">output_key: str = 'logits'</em>, <em class="sig-param">prefix: str = 'dice'</em>, <em class="sig-param">class_names=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/dice.html#MultiClassDiceMetricCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.dice.MultiClassDiceMetricCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>Global multiclass Dice Metric Callback: calculates the exact
dice score across multiple batches. This callback is good for getting
the dice score with small batch sizes where the batchwise dice is noisier.</p>
<dl class="method">
<dt id="catalyst.callbacks.metrics.dice.MultiClassDiceMetricCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">input_key: str = 'targets'</em>, <em class="sig-param">output_key: str = 'logits'</em>, <em class="sig-param">prefix: str = 'dice'</em>, <em class="sig-param">class_names=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/dice.html#MultiClassDiceMetricCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.dice.MultiClassDiceMetricCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_key</strong> – input key to use for dice calculation;
specifies our <cite>y_true</cite></p></li>
<li><p><strong>output_key</strong> – output key to use for dice calculation;
specifies our <cite>y_pred</cite></p></li>
<li><p><strong>prefix</strong> – prefix for printing the metric</p></li>
<li><p><strong>class_names</strong> – if dictionary, should be:
{class_id: class_name, …} where class_id is an integer
This allows you to ignore class indices.
if list, make sure it corresponds to the number of classes</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.metrics.dice.MultiClassDiceMetricCallback.on_batch_end">
<code class="sig-name descname">on_batch_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/dice.html#MultiClassDiceMetricCallback.on_batch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.dice.MultiClassDiceMetricCallback.on_batch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Records the confusion matrix at the end of each batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.metrics.dice.MultiClassDiceMetricCallback.on_loader_end">
<code class="sig-name descname">on_loader_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/dice.html#MultiClassDiceMetricCallback.on_loader_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.dice.MultiClassDiceMetricCallback.on_loader_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Logs dice scores to the <code class="docutils literal notranslate"><span class="pre">loader_metrics</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="attribute">
<dt id="catalyst.callbacks.metrics.dice.MulticlassDiceMetricCallback">
<code class="sig-prename descclassname">catalyst.callbacks.metrics.dice.</code><code class="sig-name descname">MulticlassDiceMetricCallback</code><a class="headerlink" href="#catalyst.callbacks.metrics.dice.MulticlassDiceMetricCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#catalyst.callbacks.metrics.dice.MultiClassDiceMetricCallback" title="catalyst.callbacks.metrics.dice.MultiClassDiceMetricCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.metrics.dice.MultiClassDiceMetricCallback</span></code></a></p>
</dd></dl>

</div>
<div class="section" id="module-catalyst.callbacks.metrics.f1_score">
<span id="f1-score"></span><h3><a class="toc-backref" href="#id23">F1 score</a><a class="headerlink" href="#module-catalyst.callbacks.metrics.f1_score" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.metrics.f1_score.F1ScoreCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.metrics.f1_score.</code><code class="sig-name descname">F1ScoreCallback</code><span class="sig-paren">(</span><em class="sig-param">input_key: str = 'targets'</em>, <em class="sig-param">output_key: str = 'logits'</em>, <em class="sig-param">prefix: str = 'f1_score'</em>, <em class="sig-param">activation: str = 'Softmax'</em>, <em class="sig-param">per_class: bool = False</em>, <em class="sig-param">class_args: List[str] = None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/f1_score.html#F1ScoreCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.f1_score.F1ScoreCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.metric.BatchMetricCallback" title="catalyst.callbacks.metric.BatchMetricCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.metric.BatchMetricCallback</span></code></a></p>
<p>F1 score metric callback.</p>
<dl class="method">
<dt id="catalyst.callbacks.metrics.f1_score.F1ScoreCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">input_key: str = 'targets'</em>, <em class="sig-param">output_key: str = 'logits'</em>, <em class="sig-param">prefix: str = 'f1_score'</em>, <em class="sig-param">activation: str = 'Softmax'</em>, <em class="sig-param">per_class: bool = False</em>, <em class="sig-param">class_args: List[str] = None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/f1_score.html#F1ScoreCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.f1_score.F1ScoreCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_key</strong> – input key to use for iou calculation
specifies our <code class="docutils literal notranslate"><span class="pre">y_true</span></code></p></li>
<li><p><strong>output_key</strong> – output key to use for iou calculation;
specifies our <code class="docutils literal notranslate"><span class="pre">y_pred</span></code></p></li>
<li><p><strong>prefix</strong> – key for the metric’s name</p></li>
<li><p><strong>activation</strong> – An torch.nn activation applied to the outputs.
Must be one of <code class="docutils literal notranslate"><span class="pre">'none'</span></code>, <code class="docutils literal notranslate"><span class="pre">'Sigmoid'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'Softmax'</span></code></p></li>
<li><p><strong>per_class</strong> – boolean flag to log per class metrics,
or use mean/macro statistics otherwise</p></li>
<li><p><strong>class_args</strong> – class names to display in the logs.
If None, defaults to indices for each class, starting from 0</p></li>
<li><p><strong>**kwargs</strong> – key-value params to pass to the metric</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code> info, please follow
<code class="docutils literal notranslate"><span class="pre">catalyst.callbacks.metric.BatchMetricCallback</span></code> and
<code class="docutils literal notranslate"><span class="pre">catalyst.metrics.f1_score.fbeta_score</span></code> docs</p>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-catalyst.callbacks.metrics.iou">
<span id="iou"></span><h3><a class="toc-backref" href="#id24">IOU</a><a class="headerlink" href="#module-catalyst.callbacks.metrics.iou" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.metrics.iou.IouCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.metrics.iou.</code><code class="sig-name descname">IouCallback</code><span class="sig-paren">(</span><em class="sig-param">input_key: str = 'targets'</em>, <em class="sig-param">output_key: str = 'logits'</em>, <em class="sig-param">prefix: str = 'iou'</em>, <em class="sig-param">activation: str = 'Sigmoid'</em>, <em class="sig-param">per_class: bool = False</em>, <em class="sig-param">class_args: List[str] = None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/iou.html#IouCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.iou.IouCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.metric.BatchMetricCallback" title="catalyst.callbacks.metric.BatchMetricCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.metric.BatchMetricCallback</span></code></a></p>
<p>IoU (Jaccard) metric callback.</p>
<dl class="method">
<dt id="catalyst.callbacks.metrics.iou.IouCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">input_key: str = 'targets'</em>, <em class="sig-param">output_key: str = 'logits'</em>, <em class="sig-param">prefix: str = 'iou'</em>, <em class="sig-param">activation: str = 'Sigmoid'</em>, <em class="sig-param">per_class: bool = False</em>, <em class="sig-param">class_args: List[str] = None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/iou.html#IouCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.iou.IouCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_key</strong> – input key to use for iou calculation
specifies our <code class="docutils literal notranslate"><span class="pre">y_true</span></code></p></li>
<li><p><strong>output_key</strong> – output key to use for iou calculation;
specifies our <code class="docutils literal notranslate"><span class="pre">y_pred</span></code></p></li>
<li><p><strong>prefix</strong> – key to store in logs</p></li>
<li><p><strong>eps</strong> – epsilon to avoid zero division</p></li>
<li><p><strong>threshold</strong> – threshold for outputs binarization</p></li>
<li><p><strong>activation</strong> – An torch.nn activation applied to the outputs.
Must be one of <code class="docutils literal notranslate"><span class="pre">'none'</span></code>, <code class="docutils literal notranslate"><span class="pre">'Sigmoid'</span></code>, <code class="docutils literal notranslate"><span class="pre">'Softmax'</span></code></p></li>
<li><p><strong>per_class</strong> – boolean flag to log per class metrics,
or use mean/macro statistics otherwise</p></li>
<li><p><strong>class_args</strong> – class names to display in the logs.
If None, defaults to indices for each class, starting from 0</p></li>
<li><p><strong>**kwargs</strong> – key-value params to pass to the metric</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code> info, please follow
<code class="docutils literal notranslate"><span class="pre">catalyst.callbacks.metric.BatchMetricCallback</span></code> and
<code class="docutils literal notranslate"><span class="pre">catalyst.metrics.iou.iou</span></code> docs</p>
</div>
</dd></dl>

</dd></dl>

<dl class="attribute">
<dt id="catalyst.callbacks.metrics.iou.JaccardCallback">
<code class="sig-prename descclassname">catalyst.callbacks.metrics.iou.</code><code class="sig-name descname">JaccardCallback</code><a class="headerlink" href="#catalyst.callbacks.metrics.iou.JaccardCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#catalyst.callbacks.metrics.iou.IouCallback" title="catalyst.callbacks.metrics.iou.IouCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.metrics.iou.IouCallback</span></code></a></p>
</dd></dl>

</div>
<div class="section" id="module-catalyst.callbacks.metrics.mrr">
<span id="mrr"></span><h3><a class="toc-backref" href="#id25">MRR</a><a class="headerlink" href="#module-catalyst.callbacks.metrics.mrr" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.metrics.mrr.MRRCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.metrics.mrr.</code><code class="sig-name descname">MRRCallback</code><span class="sig-paren">(</span><em class="sig-param">input_key: str = 'targets'</em>, <em class="sig-param">output_key: str = 'logits'</em>, <em class="sig-param">prefix: str = 'mrr'</em>, <em class="sig-param">multiplier: float = 1.0</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/mrr.html#MRRCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.mrr.MRRCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.metric.BatchMetricCallback" title="catalyst.callbacks.metric.BatchMetricCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.metric.BatchMetricCallback</span></code></a></p>
<p>Calculates the MRR.</p>
<dl class="method">
<dt id="catalyst.callbacks.metrics.mrr.MRRCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">input_key: str = 'targets'</em>, <em class="sig-param">output_key: str = 'logits'</em>, <em class="sig-param">prefix: str = 'mrr'</em>, <em class="sig-param">multiplier: float = 1.0</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/mrr.html#MRRCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.mrr.MRRCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_key</strong> (<em>str</em>) – input key to use for mrr calculation
specifies our <code class="docutils literal notranslate"><span class="pre">y_true</span></code></p></li>
<li><p><strong>output_key</strong> (<em>str</em>) – output key to use for mrr calculation;
specifies our <code class="docutils literal notranslate"><span class="pre">y_pred</span></code></p></li>
<li><p><strong>prefix</strong> (<em>str</em>) – name to display for mrr when printing</p></li>
<li><p><strong>**kwargs</strong> – key-value params to pass to the metric</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For <cite>**kwargs</cite> info, please follow
<cite>catalyst.metrics.mrr.mrr</cite> docs</p>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-catalyst.callbacks.metrics.perplexity">
<span id="perplexity"></span><h3><a class="toc-backref" href="#id26">Perplexity</a><a class="headerlink" href="#module-catalyst.callbacks.metrics.perplexity" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.metrics.perplexity.PerplexityCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.metrics.perplexity.</code><code class="sig-name descname">PerplexityCallback</code><span class="sig-paren">(</span><em class="sig-param">input_key: str = 'targets'</em>, <em class="sig-param">output_key: str = 'logits'</em>, <em class="sig-param">prefix: str = 'perplexity'</em>, <em class="sig-param">ignore_index: int = None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/perplexity.html#PerplexityCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.perplexity.PerplexityCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.metric.BatchMetricCallback" title="catalyst.callbacks.metric.BatchMetricCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.metric.BatchMetricCallback</span></code></a></p>
<p>Perplexity is a very popular metric in NLP
especially in Language Modeling task.
It is 2^cross_entropy.</p>
<dl class="method">
<dt id="catalyst.callbacks.metrics.perplexity.PerplexityCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">input_key: str = 'targets'</em>, <em class="sig-param">output_key: str = 'logits'</em>, <em class="sig-param">prefix: str = 'perplexity'</em>, <em class="sig-param">ignore_index: int = None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/perplexity.html#PerplexityCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.perplexity.PerplexityCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_key</strong> – input key to use for perplexity calculation,
target tokens</p></li>
<li><p><strong>output_key</strong> – output key to use for perplexity calculation,
logits of the predicted tokens</p></li>
<li><p><strong>ignore_index</strong> – index to ignore, usually pad_index</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="attribute">
<dt id="catalyst.callbacks.metrics.perplexity.PerplexityMetricCallback">
<code class="sig-prename descclassname">catalyst.callbacks.metrics.perplexity.</code><code class="sig-name descname">PerplexityMetricCallback</code><a class="headerlink" href="#catalyst.callbacks.metrics.perplexity.PerplexityMetricCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#catalyst.callbacks.metrics.perplexity.PerplexityCallback" title="catalyst.callbacks.metrics.perplexity.PerplexityCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.metrics.perplexity.PerplexityCallback</span></code></a></p>
</dd></dl>

</div>
<div class="section" id="module-catalyst.callbacks.metrics.precision">
<span id="precision"></span><h3><a class="toc-backref" href="#id27">Precision</a><a class="headerlink" href="#module-catalyst.callbacks.metrics.precision" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.metrics.precision.AveragePrecisionCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.metrics.precision.</code><code class="sig-name descname">AveragePrecisionCallback</code><span class="sig-paren">(</span><em class="sig-param">input_key: str = 'targets'</em>, <em class="sig-param">output_key: str = 'logits'</em>, <em class="sig-param">prefix: str = 'average_precision'</em>, <em class="sig-param">activation: str = 'Sigmoid'</em>, <em class="sig-param">per_class: bool = False</em>, <em class="sig-param">class_args: List[str] = None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/precision.html#AveragePrecisionCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.precision.AveragePrecisionCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.metric.LoaderMetricCallback" title="catalyst.callbacks.metric.LoaderMetricCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.metric.LoaderMetricCallback</span></code></a></p>
<p>AveragePrecision metric callback.</p>
<dl class="method">
<dt id="catalyst.callbacks.metrics.precision.AveragePrecisionCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">input_key: str = 'targets'</em>, <em class="sig-param">output_key: str = 'logits'</em>, <em class="sig-param">prefix: str = 'average_precision'</em>, <em class="sig-param">activation: str = 'Sigmoid'</em>, <em class="sig-param">per_class: bool = False</em>, <em class="sig-param">class_args: List[str] = None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/precision.html#AveragePrecisionCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.precision.AveragePrecisionCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_key</strong> – input key to use for
calculation mean average precision;
specifies our <cite>y_true</cite>.</p></li>
<li><p><strong>output_key</strong> – output key to use for
calculation mean average precision;
specifies our <cite>y_pred</cite>.</p></li>
<li><p><strong>prefix</strong> – key for the metric’s name</p></li>
<li><p><strong>activation</strong> – An torch.nn activation applied to the outputs.
Must be one of <code class="docutils literal notranslate"><span class="pre">'none'</span></code>, <code class="docutils literal notranslate"><span class="pre">'Sigmoid'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'Softmax'</span></code></p></li>
<li><p><strong>per_class</strong> – boolean flag to log per class metrics,
or use mean/macro statistics otherwise</p></li>
<li><p><strong>class_args</strong> – class names to display in the logs.
If None, defaults to indices for each class, starting from 0</p></li>
<li><p><strong>**kwargs</strong> – key-value params to pass to the metric</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code> info, please follow
<code class="docutils literal notranslate"><span class="pre">catalyst.callbacks.metric.LoaderMetricCallback</span></code> and
<code class="docutils literal notranslate"><span class="pre">catalyst.metrics.precision.average_precision</span></code> docs</p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="catalyst.callbacks.metrics.precision.PrecisionCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.metrics.precision.</code><code class="sig-name descname">PrecisionCallback</code><span class="sig-paren">(</span><em class="sig-param">input_key: str = 'targets'</em>, <em class="sig-param">output_key: str = 'logits'</em>, <em class="sig-param">prefix: str = 'precision'</em>, <em class="sig-param">activation: str = 'Softmax'</em>, <em class="sig-param">per_class: bool = False</em>, <em class="sig-param">class_args: List[str] = None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/precision.html#PrecisionCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.precision.PrecisionCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.metric.BatchMetricCallback" title="catalyst.callbacks.metric.BatchMetricCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.metric.BatchMetricCallback</span></code></a></p>
<p>Precision score metric callback.</p>
<dl class="method">
<dt id="catalyst.callbacks.metrics.precision.PrecisionCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">input_key: str = 'targets'</em>, <em class="sig-param">output_key: str = 'logits'</em>, <em class="sig-param">prefix: str = 'precision'</em>, <em class="sig-param">activation: str = 'Softmax'</em>, <em class="sig-param">per_class: bool = False</em>, <em class="sig-param">class_args: List[str] = None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/precision.html#PrecisionCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.precision.PrecisionCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_key</strong> – input key to use for iou calculation
specifies our <code class="docutils literal notranslate"><span class="pre">y_true</span></code></p></li>
<li><p><strong>output_key</strong> – output key to use for iou calculation;
specifies our <code class="docutils literal notranslate"><span class="pre">y_pred</span></code></p></li>
<li><p><strong>prefix</strong> – key for the metric’s name</p></li>
<li><p><strong>activation</strong> – An torch.nn activation applied to the outputs.
Must be one of <code class="docutils literal notranslate"><span class="pre">'none'</span></code>, <code class="docutils literal notranslate"><span class="pre">'Sigmoid'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'Softmax'</span></code></p></li>
<li><p><strong>per_class</strong> – boolean flag to log per class metrics,
or use mean/macro statistics otherwise</p></li>
<li><p><strong>class_args</strong> – class names to display in the logs.
If None, defaults to indices for each class, starting from 0</p></li>
<li><p><strong>**kwargs</strong> – key-value params to pass to the metric</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For <cite>**kwargs</cite> info, please follow
<cite>catalyst.metrics.precision.precision</cite> docs</p>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-catalyst.callbacks.metrics.recall">
<span id="recall"></span><h3><a class="toc-backref" href="#id28">Recall</a><a class="headerlink" href="#module-catalyst.callbacks.metrics.recall" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.metrics.recall.RecallCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.metrics.recall.</code><code class="sig-name descname">RecallCallback</code><span class="sig-paren">(</span><em class="sig-param">input_key: str = 'targets'</em>, <em class="sig-param">output_key: str = 'logits'</em>, <em class="sig-param">prefix: str = 'recall'</em>, <em class="sig-param">activation: str = 'Softmax'</em>, <em class="sig-param">per_class: bool = False</em>, <em class="sig-param">class_args: List[str] = None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/recall.html#RecallCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.recall.RecallCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.metric.BatchMetricCallback" title="catalyst.callbacks.metric.BatchMetricCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.metric.BatchMetricCallback</span></code></a></p>
<p>Recall score metric callback.</p>
<dl class="method">
<dt id="catalyst.callbacks.metrics.recall.RecallCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">input_key: str = 'targets'</em>, <em class="sig-param">output_key: str = 'logits'</em>, <em class="sig-param">prefix: str = 'recall'</em>, <em class="sig-param">activation: str = 'Softmax'</em>, <em class="sig-param">per_class: bool = False</em>, <em class="sig-param">class_args: List[str] = None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/recall.html#RecallCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.recall.RecallCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_key</strong> – input key to use for iou calculation
specifies our <code class="docutils literal notranslate"><span class="pre">y_true</span></code></p></li>
<li><p><strong>output_key</strong> – output key to use for iou calculation;
specifies our <code class="docutils literal notranslate"><span class="pre">y_pred</span></code></p></li>
<li><p><strong>prefix</strong> – key for the metric’s name</p></li>
<li><p><strong>activation</strong> – An torch.nn activation applied to the outputs.
Must be one of <code class="docutils literal notranslate"><span class="pre">'none'</span></code>, <code class="docutils literal notranslate"><span class="pre">'Sigmoid'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'Softmax'</span></code></p></li>
<li><p><strong>per_class</strong> – boolean flag to log per class metrics,
or use mean/macro statistics otherwise</p></li>
<li><p><strong>class_args</strong> – class names to display in the logs.
If None, defaults to indices for each class, starting from 0</p></li>
<li><p><strong>**kwargs</strong> – key-value params to pass to the metric</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code> info, please follow
<code class="docutils literal notranslate"><span class="pre">catalyst.callbacks.metric.BatchMetricCallback</span></code> and
<code class="docutils literal notranslate"><span class="pre">catalyst.metrics.recall.recall</span></code> docs</p>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-catalyst.callbacks.metrics.ppv_tpr_f1">
<span id="global-precision-recall-and-f1-score"></span><h3><a class="toc-backref" href="#id29">Global precision, recall and F1-score</a><a class="headerlink" href="#module-catalyst.callbacks.metrics.ppv_tpr_f1" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.metrics.ppv_tpr_f1.PrecisionRecallF1ScoreCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.metrics.ppv_tpr_f1.</code><code class="sig-name descname">PrecisionRecallF1ScoreCallback</code><span class="sig-paren">(</span><em class="sig-param">input_key: str = 'targets'</em>, <em class="sig-param">output_key: str = 'logits'</em>, <em class="sig-param">class_names: List[str] = None</em>, <em class="sig-param">num_classes: int = 2</em>, <em class="sig-param">threshold: float = 0.5</em>, <em class="sig-param">activation: str = 'Sigmoid'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/ppv_tpr_f1.html#PrecisionRecallF1ScoreCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.ppv_tpr_f1.PrecisionRecallF1ScoreCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.meter.MeterMetricsCallback</span></code></p>
<p>Calculates the global precision (positive predictive value or ppv),
recall (true positive rate or tpr), and F1-score per class for each loader.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently, supports binary and multilabel cases.</p>
</div>
<dl class="method">
<dt id="catalyst.callbacks.metrics.ppv_tpr_f1.PrecisionRecallF1ScoreCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">input_key: str = 'targets'</em>, <em class="sig-param">output_key: str = 'logits'</em>, <em class="sig-param">class_names: List[str] = None</em>, <em class="sig-param">num_classes: int = 2</em>, <em class="sig-param">threshold: float = 0.5</em>, <em class="sig-param">activation: str = 'Sigmoid'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/ppv_tpr_f1.html#PrecisionRecallF1ScoreCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.ppv_tpr_f1.PrecisionRecallF1ScoreCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_key</strong> – input key to use for metric calculation
specifies our <code class="docutils literal notranslate"><span class="pre">y_true</span></code></p></li>
<li><p><strong>output_key</strong> – output key to use for metric calculation;
specifies our <code class="docutils literal notranslate"><span class="pre">y_pred</span></code></p></li>
<li><p><strong>class_names</strong> – class names to display in the logs.
If None, defaults to indices for each class, starting from 0.</p></li>
<li><p><strong>num_classes</strong> – Number of classes; must be &gt; 1</p></li>
<li><p><strong>threshold</strong> – threshold for outputs binarization</p></li>
<li><p><strong>activation</strong> – An torch.nn activation applied to the outputs.
Must be one of <code class="docutils literal notranslate"><span class="pre">'none'</span></code>, <code class="docutils literal notranslate"><span class="pre">'Sigmoid'</span></code>, <code class="docutils literal notranslate"><span class="pre">'Softmax'</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-catalyst.contrib.callbacks">
<span id="contrib"></span><h2><a class="toc-backref" href="#id30">Contrib</a><a class="headerlink" href="#module-catalyst.contrib.callbacks" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-catalyst.contrib.callbacks.alchemy_logger">
<span id="alchemylogger"></span><h3><a class="toc-backref" href="#id31">AlchemyLogger</a><a class="headerlink" href="#module-catalyst.contrib.callbacks.alchemy_logger" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.contrib.callbacks.alchemy_logger.AlchemyLogger">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.contrib.callbacks.alchemy_logger.</code><code class="sig-name descname">AlchemyLogger</code><span class="sig-paren">(</span><em class="sig-param">metric_names: List[str] = None</em>, <em class="sig-param">log_on_batch_end: bool = True</em>, <em class="sig-param">log_on_epoch_end: bool = True</em>, <em class="sig-param">**logging_params</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/alchemy_logger.html#AlchemyLogger"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.alchemy_logger.AlchemyLogger" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>Logger callback, translates <code class="docutils literal notranslate"><span class="pre">runner.*_metrics</span></code> to Alchemy.
Read about Alchemy here <a class="reference external" href="https://alchemy.host">https://alchemy.host</a></p>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">catalyst.dl</span> <span class="kn">import</span> <span class="n">SupervisedRunner</span><span class="p">,</span> <span class="n">AlchemyLogger</span>

<span class="n">runner</span> <span class="o">=</span> <span class="n">SupervisedRunner</span><span class="p">()</span>

<span class="n">runner</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
    <span class="n">criterion</span><span class="o">=</span><span class="n">criterion</span><span class="p">,</span>
    <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
    <span class="n">loaders</span><span class="o">=</span><span class="n">loaders</span><span class="p">,</span>
    <span class="n">logdir</span><span class="o">=</span><span class="n">logdir</span><span class="p">,</span>
    <span class="n">num_epochs</span><span class="o">=</span><span class="n">num_epochs</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">callbacks</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;logger&quot;</span><span class="p">:</span> <span class="n">AlchemyLogger</span><span class="p">(</span>
            <span class="n">token</span><span class="o">=</span><span class="s2">&quot;...&quot;</span><span class="p">,</span> <span class="c1"># your Alchemy token</span>
            <span class="n">project</span><span class="o">=</span><span class="s2">&quot;your_project_name&quot;</span><span class="p">,</span>
            <span class="n">experiment</span><span class="o">=</span><span class="s2">&quot;your_experiment_name&quot;</span><span class="p">,</span>
            <span class="n">group</span><span class="o">=</span><span class="s2">&quot;your_experiment_group_name&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Powered by Catalyst.Ecosystem.</p>
<dl class="method">
<dt id="catalyst.contrib.callbacks.alchemy_logger.AlchemyLogger.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">metric_names: List[str] = None</em>, <em class="sig-param">log_on_batch_end: bool = True</em>, <em class="sig-param">log_on_epoch_end: bool = True</em>, <em class="sig-param">**logging_params</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/alchemy_logger.html#AlchemyLogger.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.alchemy_logger.AlchemyLogger.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metric_names</strong> – list of metric names to log,
if none - logs everything</p></li>
<li><p><strong>log_on_batch_end</strong> – logs per-batch metrics if set True</p></li>
<li><p><strong>log_on_epoch_end</strong> – logs per-epoch metrics if set True</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.contrib.callbacks.alchemy_logger.AlchemyLogger.on_batch_end">
<code class="sig-name descname">on_batch_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/alchemy_logger.html#AlchemyLogger.on_batch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.alchemy_logger.AlchemyLogger.on_batch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Translate batch metrics to Alchemy.</p>
</dd></dl>

<dl class="method">
<dt id="catalyst.contrib.callbacks.alchemy_logger.AlchemyLogger.on_epoch_end">
<code class="sig-name descname">on_epoch_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/alchemy_logger.html#AlchemyLogger.on_epoch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.alchemy_logger.AlchemyLogger.on_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Translate epoch metrics to Alchemy.</p>
</dd></dl>

<dl class="method">
<dt id="catalyst.contrib.callbacks.alchemy_logger.AlchemyLogger.on_loader_end">
<code class="sig-name descname">on_loader_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/alchemy_logger.html#AlchemyLogger.on_loader_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.alchemy_logger.AlchemyLogger.on_loader_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Translate loader metrics to Alchemy.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-catalyst.contrib.callbacks.confusion_matrix_logger">
<span id="confusionmatrixcallback"></span><h3><a class="toc-backref" href="#id32">ConfusionMatrixCallback</a><a class="headerlink" href="#module-catalyst.contrib.callbacks.confusion_matrix_logger" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.contrib.callbacks.confusion_matrix_logger.ConfusionMatrixCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.contrib.callbacks.confusion_matrix_logger.</code><code class="sig-name descname">ConfusionMatrixCallback</code><span class="sig-paren">(</span><em class="sig-param">input_key: str = 'targets'</em>, <em class="sig-param">output_key: str = 'logits'</em>, <em class="sig-param">prefix: str = 'confusion_matrix'</em>, <em class="sig-param">mode: str = 'tnt'</em>, <em class="sig-param">class_names: List[str] = None</em>, <em class="sig-param">num_classes: int = None</em>, <em class="sig-param">plot_params: Dict = None</em>, <em class="sig-param">tensorboard_callback_name: str = '_tensorboard'</em>, <em class="sig-param">version: str = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/confusion_matrix_logger.html#ConfusionMatrixCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.confusion_matrix_logger.ConfusionMatrixCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>Callback to plot your confusion matrix to the Tensorboard.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_key</strong> – key to use from <code class="docutils literal notranslate"><span class="pre">runner.input</span></code>, specifies our <code class="docutils literal notranslate"><span class="pre">y_true</span></code></p></li>
<li><p><strong>output_key</strong> – key to use from <code class="docutils literal notranslate"><span class="pre">runner.output</span></code>, specifies our <code class="docutils literal notranslate"><span class="pre">y_pred</span></code></p></li>
<li><p><strong>prefix</strong> – tensorboard plot name</p></li>
<li><p><strong>mode</strong> – Strategy to compute confusion matrix.
Must be one of [tnt, sklearn]</p></li>
<li><p><strong>class_names</strong> – list with class names</p></li>
<li><p><strong>num_classes</strong> – number of classes</p></li>
<li><p><strong>plot_params</strong> – extra params for plt.figure rendering</p></li>
<li><p><strong>tensorboard_callback_name</strong> – name of the tensorboard logger callback</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="catalyst.contrib.callbacks.confusion_matrix_logger.ConfusionMatrixCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">input_key: str = 'targets'</em>, <em class="sig-param">output_key: str = 'logits'</em>, <em class="sig-param">prefix: str = 'confusion_matrix'</em>, <em class="sig-param">mode: str = 'tnt'</em>, <em class="sig-param">class_names: List[str] = None</em>, <em class="sig-param">num_classes: int = None</em>, <em class="sig-param">plot_params: Dict = None</em>, <em class="sig-param">tensorboard_callback_name: str = '_tensorboard'</em>, <em class="sig-param">version: str = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/confusion_matrix_logger.html#ConfusionMatrixCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.confusion_matrix_logger.ConfusionMatrixCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Callback initialisation.</p>
</dd></dl>

<dl class="method">
<dt id="catalyst.contrib.callbacks.confusion_matrix_logger.ConfusionMatrixCallback.on_batch_end">
<code class="sig-name descname">on_batch_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/confusion_matrix_logger.html#ConfusionMatrixCallback.on_batch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.confusion_matrix_logger.ConfusionMatrixCallback.on_batch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Batch end hook.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.contrib.callbacks.confusion_matrix_logger.ConfusionMatrixCallback.on_loader_end">
<code class="sig-name descname">on_loader_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/confusion_matrix_logger.html#ConfusionMatrixCallback.on_loader_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.confusion_matrix_logger.ConfusionMatrixCallback.on_loader_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Loader end hook.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.contrib.callbacks.confusion_matrix_logger.ConfusionMatrixCallback.on_loader_start">
<code class="sig-name descname">on_loader_start</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/confusion_matrix_logger.html#ConfusionMatrixCallback.on_loader_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.confusion_matrix_logger.ConfusionMatrixCallback.on_loader_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Loader start hook.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-catalyst.contrib.callbacks.cutmix_callback">
<span id="cutmixcallback"></span><h3><a class="toc-backref" href="#id33">CutmixCallback</a><a class="headerlink" href="#module-catalyst.contrib.callbacks.cutmix_callback" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.contrib.callbacks.cutmix_callback.CutmixCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.contrib.callbacks.cutmix_callback.</code><code class="sig-name descname">CutmixCallback</code><span class="sig-paren">(</span><em class="sig-param">fields: List[str] = ('features'</em>, <em class="sig-param">)</em>, <em class="sig-param">alpha=1.0</em>, <em class="sig-param">on_train_only=True</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/cutmix_callback.html#CutmixCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.cutmix_callback.CutmixCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.criterion.CriterionCallback" title="catalyst.callbacks.criterion.CriterionCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.criterion.CriterionCallback</span></code></a></p>
<p>Callback to do Cutmix augmentation that has been proposed in
<a class="reference external" href="https://arxiv.org/abs/1905.04899#noqa:W605,E501,W505">CutMix: Regularization Strategy to Train Strong Classifiers
with Localizable Features</a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><cite>catalyst.contrib.callbacks.CutmixCallback</cite> is inherited from
<cite>catalyst.callbacks.CriterionCallback</cite> and does its work.
You may not use them together.</p>
</div>
<dl class="method">
<dt id="catalyst.contrib.callbacks.cutmix_callback.CutmixCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">fields: List[str] = ('features'</em>, <em class="sig-param">)</em>, <em class="sig-param">alpha=1.0</em>, <em class="sig-param">on_train_only=True</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/cutmix_callback.html#CutmixCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.cutmix_callback.CutmixCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fields</strong> – list of features which must be affected.</p></li>
<li><p><strong>alpha</strong> – beta distribution parameter.</p></li>
<li><p><strong>on_train_only</strong> – Apply to train only.
So, if on_train_only is True, use a standard output/metric
for validation.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.contrib.callbacks.cutmix_callback.CutmixCallback.on_batch_start">
<code class="sig-name descname">on_batch_start</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/contrib/callbacks/cutmix_callback.html#CutmixCallback.on_batch_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.cutmix_callback.CutmixCallback.on_batch_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Mixes data according to Cutmix algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.contrib.callbacks.cutmix_callback.CutmixCallback.on_loader_start">
<code class="sig-name descname">on_loader_start</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/contrib/callbacks/cutmix_callback.html#CutmixCallback.on_loader_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.cutmix_callback.CutmixCallback.on_loader_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if it is needed for the loader.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-catalyst.contrib.callbacks.gradnorm_logger">
<span id="gradnormlogger"></span><h3><a class="toc-backref" href="#id34">GradNormLogger</a><a class="headerlink" href="#module-catalyst.contrib.callbacks.gradnorm_logger" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.contrib.callbacks.gradnorm_logger.GradNormLogger">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.contrib.callbacks.gradnorm_logger.</code><code class="sig-name descname">GradNormLogger</code><span class="sig-paren">(</span><em class="sig-param">norm_type: int = 2</em>, <em class="sig-param">accumulation_steps: int = 1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/gradnorm_logger.html#GradNormLogger"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.gradnorm_logger.GradNormLogger" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>Callback for logging model gradients.</p>
<dl class="method">
<dt id="catalyst.contrib.callbacks.gradnorm_logger.GradNormLogger.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">norm_type: int = 2</em>, <em class="sig-param">accumulation_steps: int = 1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/gradnorm_logger.html#GradNormLogger.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.gradnorm_logger.GradNormLogger.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>norm_type</strong> – norm type used to calculate norm of gradients.
If <cite>OptimizerCallback</cite> provides non-default argument
<cite>grad_clip_params</cite> with custom norm type, then corresponding
norm type should be used in this class.</p></li>
<li><p><strong>accumulation_steps</strong> – number of steps before
<code class="docutils literal notranslate"><span class="pre">model.zero_grad()</span></code>.
Should be the same as in <cite>OptimizerCallback</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.contrib.callbacks.gradnorm_logger.GradNormLogger.grad_norm">
<em class="property">static </em><code class="sig-name descname">grad_norm</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">model: torch.nn.modules.module.Module</em>, <em class="sig-param">prefix: str</em>, <em class="sig-param">norm_type: int</em><span class="sig-paren">)</span> &#x2192; Dict<a class="reference internal" href="../_modules/catalyst/contrib/callbacks/gradnorm_logger.html#GradNormLogger.grad_norm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.gradnorm_logger.GradNormLogger.grad_norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes gradient norms for a given model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – model which gradients to be saved.</p></li>
<li><p><strong>prefix</strong> – prefix for keys in resulting dictionary.</p></li>
<li><p><strong>norm_type</strong> – norm type of gradient norm.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dictionary in which gradient norms are stored.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Dict</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.contrib.callbacks.gradnorm_logger.GradNormLogger.on_batch_end">
<code class="sig-name descname">on_batch_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/contrib/callbacks/gradnorm_logger.html#GradNormLogger.on_batch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.gradnorm_logger.GradNormLogger.on_batch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>On batch end event</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-catalyst.contrib.callbacks.inference_callback">
<span id="infercallback"></span><h3><a class="toc-backref" href="#id35">InferCallback</a><a class="headerlink" href="#module-catalyst.contrib.callbacks.inference_callback" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.contrib.callbacks.inference_callback.InferCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.contrib.callbacks.inference_callback.</code><code class="sig-name descname">InferCallback</code><span class="sig-paren">(</span><em class="sig-param">out_dir=None</em>, <em class="sig-param">out_prefix=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/inference_callback.html#InferCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.inference_callback.InferCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>&#64;TODO: Docs. Contribution is welcome.</p>
<dl class="method">
<dt id="catalyst.contrib.callbacks.inference_callback.InferCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">out_dir=None</em>, <em class="sig-param">out_prefix=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/inference_callback.html#InferCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.inference_callback.InferCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>&#64;TODO</strong> – Docs. Contribution is welcome</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.contrib.callbacks.inference_callback.InferCallback.on_batch_end">
<code class="sig-name descname">on_batch_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/inference_callback.html#InferCallback.on_batch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.inference_callback.InferCallback.on_batch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Batch end hook.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.contrib.callbacks.inference_callback.InferCallback.on_loader_end">
<code class="sig-name descname">on_loader_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/inference_callback.html#InferCallback.on_loader_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.inference_callback.InferCallback.on_loader_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Loader end hook.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.contrib.callbacks.inference_callback.InferCallback.on_loader_start">
<code class="sig-name descname">on_loader_start</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/inference_callback.html#InferCallback.on_loader_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.inference_callback.InferCallback.on_loader_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Loader start hook.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.contrib.callbacks.inference_callback.InferCallback.on_stage_start">
<code class="sig-name descname">on_stage_start</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/inference_callback.html#InferCallback.on_stage_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.inference_callback.InferCallback.on_stage_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Stage start hook.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-catalyst.contrib.callbacks.kornia_transform">
<span id="batchtransformcallback"></span><h3><a class="toc-backref" href="#id36">BatchTransformCallback</a><a class="headerlink" href="#module-catalyst.contrib.callbacks.kornia_transform" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.contrib.callbacks.kornia_transform.BatchTransformCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.contrib.callbacks.kornia_transform.</code><code class="sig-name descname">BatchTransformCallback</code><span class="sig-paren">(</span><em class="sig-param">transform: Sequence[Union[dict, torch.nn.modules.module.Module]], input_key: Union[str, int] = 'image', additional_input_key: Optional[str] = None, output_key: Union[str, int, None] = None, additional_output_key: Optional[str] = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/kornia_transform.html#BatchTransformCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.kornia_transform.BatchTransformCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>Callback to perform data augmentations on GPU using kornia library.</p>
<p>Look at <a class="reference external" href="https://arxiv.org/pdf/1910.02190.pdf">Kornia: an Open Source Differentiable Computer Vision
Library for PyTorch</a> for details.</p>
<p>Usage example for notebook API:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">kornia</span> <span class="kn">import</span> <span class="n">augmentation</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch.nn</span> <span class="kn">import</span> <span class="n">functional</span> <span class="k">as</span> <span class="n">F</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">DataLoader</span>

<span class="kn">from</span> <span class="nn">catalyst</span> <span class="kn">import</span> <span class="n">dl</span>
<span class="kn">from</span> <span class="nn">catalyst.contrib.data.transforms</span> <span class="kn">import</span> <span class="n">ToTensor</span>
<span class="kn">from</span> <span class="nn">catalyst.contrib.datasets</span> <span class="kn">import</span> <span class="n">MNIST</span>
<span class="kn">from</span> <span class="nn">catalyst.contrib.callbacks.kornia_transform</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">BatchTransformCallback</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">catalyst</span> <span class="kn">import</span> <span class="n">metrics</span>


<span class="k">class</span> <span class="nc">CustomRunner</span><span class="p">(</span><span class="n">dl</span><span class="o">.</span><span class="n">Runner</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">predict_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">):</span>
        <span class="c1"># model inference step</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span>
            <span class="n">batch</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">batch</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_handle_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">):</span>
        <span class="c1"># model train/valid step</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">batch</span>
        <span class="n">y_hat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>

        <span class="n">loss</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">cross_entropy</span><span class="p">(</span><span class="n">y_hat</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">accuracy01</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy</span><span class="p">(</span><span class="n">y_hat</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">batch_metrics</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="p">{</span><span class="s2">&quot;loss&quot;</span><span class="p">:</span> <span class="n">loss</span><span class="p">,</span> <span class="s2">&quot;accuracy01&quot;</span><span class="p">:</span> <span class="n">accuracy01</span><span class="p">}</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_train_loader</span><span class="p">:</span>
            <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span> <span class="o">*</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span>

<span class="n">loaders</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="n">DataLoader</span><span class="p">(</span>
        <span class="n">MNIST</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ToTensor</span><span class="p">()),</span>
        <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="n">DataLoader</span><span class="p">(</span>
        <span class="n">MNIST</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ToTensor</span><span class="p">()),</span>
        <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
    <span class="p">),</span>
<span class="p">}</span>
<span class="n">transrorms</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">augmentation</span><span class="o">.</span><span class="n">RandomAffine</span><span class="p">(</span><span class="n">degrees</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="p">(</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">)),</span>
<span class="p">]</span>

<span class="n">runner</span> <span class="o">=</span> <span class="n">CustomRunner</span><span class="p">()</span>

<span class="c1"># model training</span>
<span class="n">runner</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
    <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
    <span class="n">loaders</span><span class="o">=</span><span class="n">loaders</span><span class="p">,</span>
    <span class="n">logdir</span><span class="o">=</span><span class="s2">&quot;./logs&quot;</span><span class="p">,</span>
    <span class="n">num_epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">BatchTransformCallback</span><span class="p">(</span><span class="n">transrorms</span><span class="p">,</span> <span class="n">input_key</span><span class="o">=</span><span class="mi">0</span><span class="p">)],</span>
<span class="p">)</span>
</pre></div>
</div>
<p>To apply augmentations only during specific loader e.g. only during
training <code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callbacks.control_flow.ControlFlowCallback</span></code>
callback can be used. For config API it can look like this:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">callbacks_params</span><span class="p">:</span>
  <span class="l l-Scalar l-Scalar-Plain">...</span>
  <span class="l l-Scalar l-Scalar-Plain">train_transforms</span><span class="p p-Indicator">:</span>
    <span class="nt">_wrapper</span><span class="p">:</span>
      <span class="nt">callback</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ControlFlowCallback</span>
      <span class="nt">loaders</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">train</span>
    <span class="nt">callback</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">BatchTransformCallback</span>
    <span class="nt">transforms</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">transform</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">kornia.RandomAffine</span>
        <span class="nt">degrees</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">-15</span><span class="p p-Indicator">,</span> <span class="nv">20</span><span class="p p-Indicator">]</span>
        <span class="nt">scale</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">0.75</span><span class="p p-Indicator">,</span> <span class="nv">1.25</span><span class="p p-Indicator">]</span>
        <span class="nt">return_transform</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
      <span class="p p-Indicator">-</span> <span class="nt">transform</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">kornia.ColorJitter</span>
        <span class="nt">brightness</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.1</span>
        <span class="nt">contrast</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.1</span>
        <span class="nt">saturation</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.1</span>
        <span class="nt">return_transform</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class="nt">input_key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">image</span>
    <span class="nt">additional_input_key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mask</span>
  <span class="l l-Scalar l-Scalar-Plain">...</span>
</pre></div>
</div>
<dl class="method">
<dt id="catalyst.contrib.callbacks.kornia_transform.BatchTransformCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">transform: Sequence[Union[dict, torch.nn.modules.module.Module]], input_key: Union[str, int] = 'image', additional_input_key: Optional[str] = None, output_key: Union[str, int, None] = None, additional_output_key: Optional[str] = None</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/contrib/callbacks/kornia_transform.html#BatchTransformCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.kornia_transform.BatchTransformCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor method for the <a class="reference internal" href="#catalyst.contrib.callbacks.kornia_transform.BatchTransformCallback" title="catalyst.contrib.callbacks.kornia_transform.BatchTransformCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">BatchTransformCallback</span></code></a> callback.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transform</strong> (<em>Sequence</em><em>[</em><em>Union</em><em>[</em><em>dict</em><em>, </em><em>nn.Module</em><em>]</em><em>]</em>) – <p>define
augmentations to apply on a batch</p>
<p>If a sequence of transforms passed, then each element
should be either <code class="docutils literal notranslate"><span class="pre">kornia.augmentation.AugmentationBase2D</span></code>,
<code class="docutils literal notranslate"><span class="pre">kornia.augmentation.AugmentationBase3D</span></code>, or <code class="docutils literal notranslate"><span class="pre">nn.Module</span></code>
compatible with kornia interface.</p>
<p>If a sequence of params (<code class="docutils literal notranslate"><span class="pre">dict</span></code>) passed, then each
element of the sequence must contain <code class="docutils literal notranslate"><span class="pre">'transform'</span></code> key with
an augmentation name as a value. Please note that in this case
to use custom augmentation you should add it to the
<cite>TRANSFORMS</cite> registry first.</p>
</p></li>
<li><p><strong>input_key</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>int</em><em>]</em>) – key in batch dict
mapping to transform, e.g. <cite>‘image’</cite></p></li>
<li><p><strong>additional_input_key</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>str</em><em>, </em><em>int</em><em>]</em><em>]</em>) – key of an
additional target in batch dict mapping to transform,
e.g. <cite>‘mask’</cite></p></li>
<li><p><strong>output_key</strong> – key to use to store the result
of the transform, defaults to <cite>input_key</cite> if not provided</p></li>
<li><p><strong>additional_output_key</strong> – key to use to store
the result of additional target transformation,
defaults to <cite>additional_input_key</cite> if not provided</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.contrib.callbacks.kornia_transform.BatchTransformCallback.on_batch_start">
<code class="sig-name descname">on_batch_start</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/contrib/callbacks/kornia_transform.html#BatchTransformCallback.on_batch_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.kornia_transform.BatchTransformCallback.on_batch_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply transforms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – сurrent runner</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-catalyst.contrib.callbacks.mask_inference">
<span id="infermaskcallback"></span><h3><a class="toc-backref" href="#id37">InferMaskCallback</a><a class="headerlink" href="#module-catalyst.contrib.callbacks.mask_inference" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.contrib.callbacks.mask_inference.InferMaskCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.contrib.callbacks.mask_inference.</code><code class="sig-name descname">InferMaskCallback</code><span class="sig-paren">(</span><em class="sig-param">out_dir=None</em>, <em class="sig-param">out_prefix=None</em>, <em class="sig-param">input_key=None</em>, <em class="sig-param">output_key=None</em>, <em class="sig-param">name_key=None</em>, <em class="sig-param">mean=None</em>, <em class="sig-param">std=None</em>, <em class="sig-param">threshold: float = 0.5</em>, <em class="sig-param">mask_strength: float = 0.5</em>, <em class="sig-param">mask_type: str = 'soft'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/mask_inference.html#InferMaskCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.mask_inference.InferMaskCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>&#64;TODO: Docs. Contribution is welcome.</p>
<dl class="method">
<dt id="catalyst.contrib.callbacks.mask_inference.InferMaskCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">out_dir=None</em>, <em class="sig-param">out_prefix=None</em>, <em class="sig-param">input_key=None</em>, <em class="sig-param">output_key=None</em>, <em class="sig-param">name_key=None</em>, <em class="sig-param">mean=None</em>, <em class="sig-param">std=None</em>, <em class="sig-param">threshold: float = 0.5</em>, <em class="sig-param">mask_strength: float = 0.5</em>, <em class="sig-param">mask_type: str = 'soft'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/mask_inference.html#InferMaskCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.mask_inference.InferMaskCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>&#64;TODO</strong> – Docs. Contribution is welcome</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.contrib.callbacks.mask_inference.InferMaskCallback.on_batch_end">
<code class="sig-name descname">on_batch_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/mask_inference.html#InferMaskCallback.on_batch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.mask_inference.InferMaskCallback.on_batch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Batch end hook.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.contrib.callbacks.mask_inference.InferMaskCallback.on_loader_start">
<code class="sig-name descname">on_loader_start</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/mask_inference.html#InferMaskCallback.on_loader_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.mask_inference.InferMaskCallback.on_loader_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Loader start hook.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.contrib.callbacks.mask_inference.InferMaskCallback.on_stage_start">
<code class="sig-name descname">on_stage_start</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/mask_inference.html#InferMaskCallback.on_stage_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.mask_inference.InferMaskCallback.on_stage_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Stage start hook.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-catalyst.contrib.callbacks.draw_masks_callback">
<span id="drawmaskscallback"></span><h3><a class="toc-backref" href="#id38">DrawMasksCallback</a><a class="headerlink" href="#module-catalyst.contrib.callbacks.draw_masks_callback" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.contrib.callbacks.draw_masks_callback.DrawMasksCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.contrib.callbacks.draw_masks_callback.</code><code class="sig-name descname">DrawMasksCallback</code><span class="sig-paren">(</span><em class="sig-param">output_key: str</em>, <em class="sig-param">input_image_key: Optional[str] = None</em>, <em class="sig-param">input_mask_key: Optional[str] = None</em>, <em class="sig-param">mask2show: Optional[Iterable[int]] = None</em>, <em class="sig-param">activation: Optional[str] = 'Sigmoid'</em>, <em class="sig-param">log_name: str = 'images'</em>, <em class="sig-param">summary_step: int = 50</em>, <em class="sig-param">threshold: float = 0.5</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/draw_masks_callback.html#DrawMasksCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.draw_masks_callback.DrawMasksCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.logging.ILoggerCallback" title="catalyst.callbacks.logging.ILoggerCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.logging.ILoggerCallback</span></code></a></p>
<p>Logger callback draw masks for common segmentation task: image -&gt; masks</p>
<dl class="method">
<dt id="catalyst.contrib.callbacks.draw_masks_callback.DrawMasksCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">output_key: str</em>, <em class="sig-param">input_image_key: Optional[str] = None</em>, <em class="sig-param">input_mask_key: Optional[str] = None</em>, <em class="sig-param">mask2show: Optional[Iterable[int]] = None</em>, <em class="sig-param">activation: Optional[str] = 'Sigmoid'</em>, <em class="sig-param">log_name: str = 'images'</em>, <em class="sig-param">summary_step: int = 50</em>, <em class="sig-param">threshold: float = 0.5</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/draw_masks_callback.html#DrawMasksCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.draw_masks_callback.DrawMasksCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_key</strong> – predicted mask key</p></li>
<li><p><strong>input_image_key</strong> – input image key. If None mask will be drawn on</p></li>
<li><p><strong>background</strong> (<em>white</em>) – </p></li>
<li><p><strong>input_mask_key</strong> – ground truth mask key. If None, will not be drawn</p></li>
<li><p><strong>mask2show</strong> – mask indexes to show, if None all mask will be drawn. By</p></li>
<li><p><strong>parameter you can change the mask order</strong> (<em>this</em>) – </p></li>
<li><p><strong>activation</strong> – An torch.nn activation applied to the outputs.</p></li>
<li><p><strong>be one of 'none'</strong><strong>, </strong><strong>'Sigmoid'</strong><strong>, </strong><strong>'Softmax'</strong> (<em>Must</em>) – </p></li>
<li><p><strong>log_name</strong> – logging name. If you use several such “callbacks”, they</p></li>
<li><p><strong>have different logging names</strong> (<em>must</em>) – </p></li>
<li><p><strong>summary_step</strong> – logging frequency</p></li>
<li><p><strong>threshold</strong> – threshold for predicted masks, must be in (0, 1)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.contrib.callbacks.draw_masks_callback.DrawMasksCallback.on_batch_end">
<code class="sig-name descname">on_batch_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/draw_masks_callback.html#DrawMasksCallback.on_batch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.draw_masks_callback.DrawMasksCallback.on_batch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Batch end hook.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.contrib.callbacks.draw_masks_callback.DrawMasksCallback.on_loader_start">
<code class="sig-name descname">on_loader_start</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/draw_masks_callback.html#DrawMasksCallback.on_loader_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.draw_masks_callback.DrawMasksCallback.on_loader_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Loader start hook.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-catalyst.contrib.callbacks.mixup_callback">
<span id="mixupcallback"></span><h3><a class="toc-backref" href="#id39">MixupCallback</a><a class="headerlink" href="#module-catalyst.contrib.callbacks.mixup_callback" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.contrib.callbacks.mixup_callback.MixupCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.contrib.callbacks.mixup_callback.</code><code class="sig-name descname">MixupCallback</code><span class="sig-paren">(</span><em class="sig-param">input_key: str = 'targets'</em>, <em class="sig-param">output_key: str = 'logits'</em>, <em class="sig-param">fields: List[str] = ('features'</em>, <em class="sig-param">)</em>, <em class="sig-param">alpha=1.0</em>, <em class="sig-param">on_train_only=True</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/mixup_callback.html#MixupCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.mixup_callback.MixupCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.criterion.CriterionCallback" title="catalyst.callbacks.criterion.CriterionCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.criterion.CriterionCallback</span></code></a></p>
<p>Callback to do mixup augmentation.</p>
<p>More details about mixin can be found in the paper
<a class="reference external" href="#noqa:W605https://arxiv.org/abs/1710.09412">mixup: Beyond Empirical Risk Minimization</a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><cite>catalyst.contrib.callbacks.MixupCallback</cite> is inherited from
<cite>catalyst.callbacks.CriterionCallback</cite> and does its work.
You may not use them together.</p>
</div>
<dl class="method">
<dt id="catalyst.contrib.callbacks.mixup_callback.MixupCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">input_key: str = 'targets'</em>, <em class="sig-param">output_key: str = 'logits'</em>, <em class="sig-param">fields: List[str] = ('features'</em>, <em class="sig-param">)</em>, <em class="sig-param">alpha=1.0</em>, <em class="sig-param">on_train_only=True</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/mixup_callback.html#MixupCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.mixup_callback.MixupCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fields</strong> – list of features which must be affected.</p></li>
<li><p><strong>alpha</strong> – beta distribution a=b parameters.
Must be &gt;=0. The more alpha closer to zero
the less effect of the mixup.</p></li>
<li><p><strong>on_train_only</strong> – Apply to train only.
As the mixup use the proxy inputs, the targets are also proxy.
We are not interested in them, are we?
So, if on_train_only is True, use a standard output/metric
for validation.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.contrib.callbacks.mixup_callback.MixupCallback.on_batch_start">
<code class="sig-name descname">on_batch_start</code><span class="sig-paren">(</span><em class="sig-param">runner: catalyst.core.runner.IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/contrib/callbacks/mixup_callback.html#MixupCallback.on_batch_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.mixup_callback.MixupCallback.on_batch_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Batch start hook.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.contrib.callbacks.mixup_callback.MixupCallback.on_loader_start">
<code class="sig-name descname">on_loader_start</code><span class="sig-paren">(</span><em class="sig-param">runner: catalyst.core.runner.IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/mixup_callback.html#MixupCallback.on_loader_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.mixup_callback.MixupCallback.on_loader_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Loader start hook.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-catalyst.contrib.callbacks.neptune_logger">
<span id="neptunelogger"></span><h3><a class="toc-backref" href="#id40">NeptuneLogger</a><a class="headerlink" href="#module-catalyst.contrib.callbacks.neptune_logger" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.contrib.callbacks.neptune_logger.NeptuneLogger">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.contrib.callbacks.neptune_logger.</code><code class="sig-name descname">NeptuneLogger</code><span class="sig-paren">(</span><em class="sig-param">metric_names: List[str] = None</em>, <em class="sig-param">log_on_batch_end: bool = True</em>, <em class="sig-param">log_on_epoch_end: bool = True</em>, <em class="sig-param">offline_mode: bool = False</em>, <em class="sig-param">**logging_params</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/neptune_logger.html#NeptuneLogger"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.neptune_logger.NeptuneLogger" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>Logger callback, translates <code class="docutils literal notranslate"><span class="pre">runner.*_metrics</span></code> to Neptune.
Read about Neptune here <a class="reference external" href="https://neptune.ai">https://neptune.ai</a></p>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">catalyst.runners</span> <span class="kn">import</span> <span class="n">SupervisedRunner</span>
<span class="kn">from</span> <span class="nn">catalyst.contrib.callbacks</span> <span class="kn">import</span> <span class="n">NeptuneLogger</span>

<span class="n">runner</span> <span class="o">=</span> <span class="n">SupervisedRunner</span><span class="p">()</span>

<span class="n">runner</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
    <span class="n">criterion</span><span class="o">=</span><span class="n">criterion</span><span class="p">,</span>
    <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
    <span class="n">loaders</span><span class="o">=</span><span class="n">loaders</span><span class="p">,</span>
    <span class="n">logdir</span><span class="o">=</span><span class="n">logdir</span><span class="p">,</span>
    <span class="n">num_epochs</span><span class="o">=</span><span class="n">num_epochs</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span>
        <span class="n">NeptuneLogger</span><span class="p">(</span>
            <span class="n">api_token</span><span class="o">=</span><span class="s2">&quot;...&quot;</span><span class="p">,</span> <span class="c1"># your Neptune token</span>
            <span class="n">project_name</span><span class="o">=</span><span class="s2">&quot;your_project_name&quot;</span><span class="p">,</span>
            <span class="n">offline_mode</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="c1"># turn off neptune for debug</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;your_experiment_name&quot;</span><span class="p">,</span>
            <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="o">...</span><span class="p">},</span>  <span class="c1"># your hyperparameters</span>
            <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;resnet&quot;</span><span class="p">,</span> <span class="s2">&quot;no-augmentations&quot;</span><span class="p">],</span> <span class="c1"># tags</span>
            <span class="n">upload_source_files</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;*.py&quot;</span><span class="p">],</span> <span class="c1"># files to save</span>
             <span class="p">)</span>
        <span class="p">]</span>
     <span class="p">)</span>
</pre></div>
</div>
<p>You can see an example experiment here:
<a class="reference external" href="https://ui.neptune.ai/o/shared/org/catalyst-integration/e/CAT-13/charts">https://ui.neptune.ai/o/shared/org/catalyst-integration/e/CAT-13/charts</a></p>
<p>You can log your experiments without registering.
Just use “ANONYMOUS” token:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">runner</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
    <span class="o">...</span>
    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;NepuneLogger(</span>
            <span class="n">api_token</span><span class="o">=</span><span class="s2">&quot;ANONYMOUS&quot;</span><span class="p">,</span>
            <span class="n">project_name</span><span class="o">=</span><span class="s2">&quot;shared/catalyst-integration&quot;</span><span class="p">,</span>
            <span class="o">...</span>
             <span class="p">)</span>
        <span class="p">]</span>
    <span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="catalyst.contrib.callbacks.neptune_logger.NeptuneLogger.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">metric_names: List[str] = None</em>, <em class="sig-param">log_on_batch_end: bool = True</em>, <em class="sig-param">log_on_epoch_end: bool = True</em>, <em class="sig-param">offline_mode: bool = False</em>, <em class="sig-param">**logging_params</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/neptune_logger.html#NeptuneLogger.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.neptune_logger.NeptuneLogger.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metric_names</strong> – list of metric names to log,
if none - logs everything</p></li>
<li><p><strong>log_on_batch_end</strong> – logs per-batch metrics if set True</p></li>
<li><p><strong>log_on_epoch_end</strong> – logs per-epoch metrics if set True</p></li>
<li><p><strong>offline_mode</strong> – whether logging to Neptune server should
be turned off. It is useful for debugging</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.contrib.callbacks.neptune_logger.NeptuneLogger.on_batch_end">
<code class="sig-name descname">on_batch_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/neptune_logger.html#NeptuneLogger.on_batch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.neptune_logger.NeptuneLogger.on_batch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Log batch metrics to Neptune.</p>
</dd></dl>

<dl class="method">
<dt id="catalyst.contrib.callbacks.neptune_logger.NeptuneLogger.on_loader_end">
<code class="sig-name descname">on_loader_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/neptune_logger.html#NeptuneLogger.on_loader_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.neptune_logger.NeptuneLogger.on_loader_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Translate epoch metrics to Neptune.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-catalyst.contrib.callbacks.optuna_callback">
<span id="optunacallback"></span><h3><a class="toc-backref" href="#id41">OptunaCallback</a><a class="headerlink" href="#module-catalyst.contrib.callbacks.optuna_callback" title="Permalink to this headline">¶</a></h3>
<dl class="attribute">
<dt id="catalyst.contrib.callbacks.optuna_callback.OptunaCallback">
<code class="sig-prename descclassname">catalyst.contrib.callbacks.optuna_callback.</code><code class="sig-name descname">OptunaCallback</code><a class="headerlink" href="#catalyst.contrib.callbacks.optuna_callback.OptunaCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#catalyst.contrib.callbacks.optuna_callback.OptunaPruningCallback" title="catalyst.contrib.callbacks.optuna_callback.OptunaPruningCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.contrib.callbacks.optuna_callback.OptunaPruningCallback</span></code></a></p>
</dd></dl>

<dl class="class">
<dt id="catalyst.contrib.callbacks.optuna_callback.OptunaPruningCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.contrib.callbacks.optuna_callback.</code><code class="sig-name descname">OptunaPruningCallback</code><span class="sig-paren">(</span><em class="sig-param">trial: optuna.trial._trial.Trial = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/optuna_callback.html#OptunaPruningCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.optuna_callback.OptunaPruningCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>Optuna callback for pruning unpromising runs</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">optuna</span>

<span class="kn">from</span> <span class="nn">catalyst.dl</span> <span class="kn">import</span> <span class="n">SupervisedRunner</span><span class="p">,</span> <span class="n">OptunaPruningCallback</span>

<span class="c1"># some python code ...</span>

<span class="k">def</span> <span class="nf">objective</span><span class="p">(</span><span class="n">trial</span><span class="p">:</span> <span class="n">optuna</span><span class="o">.</span><span class="n">Trial</span><span class="p">):</span>
    <span class="c1"># standard optuna code for model and/or optimizer suggestion ...</span>
    <span class="n">runner</span> <span class="o">=</span> <span class="n">SupervisedRunner</span><span class="p">()</span>
    <span class="n">runner</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
        <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
        <span class="n">loaders</span><span class="o">=</span><span class="n">loaders</span><span class="p">,</span>
        <span class="n">criterion</span><span class="o">=</span><span class="n">criterion</span><span class="p">,</span>
        <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
        <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span>
            <span class="n">OptunaPruningCallback</span><span class="p">(</span><span class="n">trial</span><span class="p">)</span>
            <span class="c1"># some other callbacks ...</span>
        <span class="p">],</span>
        <span class="n">num_epochs</span><span class="o">=</span><span class="n">num_epochs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">runner</span><span class="o">.</span><span class="n">best_valid_metrics</span><span class="p">[</span><span class="n">runner</span><span class="o">.</span><span class="n">main_metric</span><span class="p">]</span>

<span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">()</span>
<span class="n">study</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
</pre></div>
</div>
<p>Config API is supported through <cite>catalyst-dl tune</cite> command.</p>
<dl class="method">
<dt id="catalyst.contrib.callbacks.optuna_callback.OptunaPruningCallback.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">trial: optuna.trial._trial.Trial = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/optuna_callback.html#OptunaPruningCallback.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.optuna_callback.OptunaPruningCallback.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>This callback can be used for early stopping (pruning)
unpromising runs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>trial</strong> – Optuna.Trial for experiment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.contrib.callbacks.optuna_callback.OptunaPruningCallback.on_epoch_end">
<code class="sig-name descname">on_epoch_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/optuna_callback.html#OptunaPruningCallback.on_epoch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.optuna_callback.OptunaPruningCallback.on_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>On epoch end hook.</p>
<p>Considering prune or not to prune current run at current epoch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – runner for current experiment</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>TrialPruned</strong> – if current run should be pruned</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.contrib.callbacks.optuna_callback.OptunaPruningCallback.on_stage_start">
<code class="sig-name descname">on_stage_start</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/optuna_callback.html#OptunaPruningCallback.on_stage_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.optuna_callback.OptunaPruningCallback.on_stage_start" title="Permalink to this definition">¶</a></dt>
<dd><p>On stage start hook.
Takes <code class="docutils literal notranslate"><span class="pre">optuna_trial</span></code> from <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> for future usage if needed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – runner for current experiment</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – if no Optuna trial was found on stage start.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-catalyst.contrib.callbacks.telegram_logger">
<span id="telegramlogger"></span><h3><a class="toc-backref" href="#id42">TelegramLogger</a><a class="headerlink" href="#module-catalyst.contrib.callbacks.telegram_logger" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.contrib.callbacks.telegram_logger.TelegramLogger">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.contrib.callbacks.telegram_logger.</code><code class="sig-name descname">TelegramLogger</code><span class="sig-paren">(</span><em class="sig-param">token: str = None</em>, <em class="sig-param">chat_id: str = None</em>, <em class="sig-param">metric_names: List[str] = None</em>, <em class="sig-param">log_on_stage_start: bool = True</em>, <em class="sig-param">log_on_loader_start: bool = True</em>, <em class="sig-param">log_on_loader_end: bool = True</em>, <em class="sig-param">log_on_stage_end: bool = True</em>, <em class="sig-param">log_on_exception: bool = True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/telegram_logger.html#TelegramLogger"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.telegram_logger.TelegramLogger" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>Logger callback, translates <code class="docutils literal notranslate"><span class="pre">runner.metric_manager</span></code> to telegram channel.</p>
<dl class="method">
<dt id="catalyst.contrib.callbacks.telegram_logger.TelegramLogger.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">token: str = None</em>, <em class="sig-param">chat_id: str = None</em>, <em class="sig-param">metric_names: List[str] = None</em>, <em class="sig-param">log_on_stage_start: bool = True</em>, <em class="sig-param">log_on_loader_start: bool = True</em>, <em class="sig-param">log_on_loader_end: bool = True</em>, <em class="sig-param">log_on_stage_end: bool = True</em>, <em class="sig-param">log_on_exception: bool = True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/telegram_logger.html#TelegramLogger.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.telegram_logger.TelegramLogger.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>token</strong> – telegram bot’s token,
see <a class="reference external" href="https://core.telegram.org/bots">https://core.telegram.org/bots</a></p></li>
<li><p><strong>chat_id</strong> – Chat unique identifier</p></li>
<li><p><strong>metric_names</strong> – List of metric names to log.
if none - logs everything.</p></li>
<li><p><strong>log_on_stage_start</strong> – send notification on stage start</p></li>
<li><p><strong>log_on_loader_start</strong> – send notification on loader start</p></li>
<li><p><strong>log_on_loader_end</strong> – send notification on loader end</p></li>
<li><p><strong>log_on_stage_end</strong> – send notification on stage end</p></li>
<li><p><strong>log_on_exception</strong> – send notification on exception</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.contrib.callbacks.telegram_logger.TelegramLogger.on_exception">
<code class="sig-name descname">on_exception</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/telegram_logger.html#TelegramLogger.on_exception"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.telegram_logger.TelegramLogger.on_exception" title="Permalink to this definition">¶</a></dt>
<dd><p>Notify about raised <code class="docutils literal notranslate"><span class="pre">Exception</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="catalyst.contrib.callbacks.telegram_logger.TelegramLogger.on_loader_end">
<code class="sig-name descname">on_loader_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/telegram_logger.html#TelegramLogger.on_loader_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.telegram_logger.TelegramLogger.on_loader_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Translate <code class="docutils literal notranslate"><span class="pre">runner.metric_manager</span></code> to telegram channel.</p>
</dd></dl>

<dl class="method">
<dt id="catalyst.contrib.callbacks.telegram_logger.TelegramLogger.on_loader_start">
<code class="sig-name descname">on_loader_start</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/telegram_logger.html#TelegramLogger.on_loader_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.telegram_logger.TelegramLogger.on_loader_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Notify about starting running the new loader.</p>
</dd></dl>

<dl class="method">
<dt id="catalyst.contrib.callbacks.telegram_logger.TelegramLogger.on_stage_end">
<code class="sig-name descname">on_stage_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/telegram_logger.html#TelegramLogger.on_stage_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.telegram_logger.TelegramLogger.on_stage_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Notify about finishing a stage.</p>
</dd></dl>

<dl class="method">
<dt id="catalyst.contrib.callbacks.telegram_logger.TelegramLogger.on_stage_start">
<code class="sig-name descname">on_stage_start</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/telegram_logger.html#TelegramLogger.on_stage_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.telegram_logger.TelegramLogger.on_stage_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Notify about starting a new stage.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-catalyst.contrib.callbacks.wandb_logger">
<span id="wandblogger"></span><h3><a class="toc-backref" href="#id43">WandbLogger</a><a class="headerlink" href="#module-catalyst.contrib.callbacks.wandb_logger" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.contrib.callbacks.wandb_logger.WandbLogger">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.contrib.callbacks.wandb_logger.</code><code class="sig-name descname">WandbLogger</code><span class="sig-paren">(</span><em class="sig-param">metric_names: List[str] = None</em>, <em class="sig-param">log_on_batch_end: bool = False</em>, <em class="sig-param">log_on_epoch_end: bool = True</em>, <em class="sig-param">log: str = None</em>, <em class="sig-param">**logging_params</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/wandb_logger.html#WandbLogger"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.wandb_logger.WandbLogger" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>Logger callback, translates <code class="docutils literal notranslate"><span class="pre">runner.*_metrics</span></code> to Weights &amp; Biases.
Read about Weights &amp; Biases here <a class="reference external" href="https://docs.wandb.com/">https://docs.wandb.com/</a></p>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">catalyst</span> <span class="kn">import</span> <span class="n">dl</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">torch.optim</span> <span class="k">as</span> <span class="nn">optim</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">DataLoader</span><span class="p">,</span> <span class="n">TensorDataset</span>

<span class="k">class</span> <span class="nc">Projector</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_size</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linear</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">input_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">linear</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Projector</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">TensorDataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">runner</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">SupervisedRunner</span><span class="p">()</span>

<span class="n">runner</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
    <span class="n">loaders</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="n">loader</span><span class="p">,</span>
        <span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="n">loader</span>
    <span class="p">},</span>
    <span class="n">criterion</span><span class="o">=</span><span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">(),</span>
    <span class="n">optimizer</span><span class="o">=</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">()),</span>
    <span class="n">logdir</span><span class="o">=</span><span class="s2">&quot;log_example&quot;</span><span class="p">,</span>
    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span>
        <span class="n">dl</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">WandbLogger</span><span class="p">(</span>
            <span class="n">project</span><span class="o">=</span><span class="s2">&quot;wandb_logger_example&quot;</span>
        <span class="p">)</span>
    <span class="p">],</span>
    <span class="n">num_epochs</span><span class="o">=</span><span class="mi">10</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="catalyst.contrib.callbacks.wandb_logger.WandbLogger.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">metric_names: List[str] = None</em>, <em class="sig-param">log_on_batch_end: bool = False</em>, <em class="sig-param">log_on_epoch_end: bool = True</em>, <em class="sig-param">log: str = None</em>, <em class="sig-param">**logging_params</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/wandb_logger.html#WandbLogger.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.wandb_logger.WandbLogger.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metric_names</strong> – list of metric names to log,
if None - logs everything</p></li>
<li><p><strong>log_on_batch_end</strong> – logs per-batch metrics if set True</p></li>
<li><p><strong>log_on_epoch_end</strong> – logs per-epoch metrics if set True</p></li>
<li><p><strong>log</strong> – wandb.watch parameter. Can be “all”, “gradients”
or “parameters”</p></li>
<li><p><strong>**logging_params</strong> – any parameters of function <cite>wandb.init</cite>
except <cite>reinit</cite> which is automatically set to <cite>True</cite>
and <cite>dir</cite> which is set to <cite>&lt;logdir&gt;</cite></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.contrib.callbacks.wandb_logger.WandbLogger.on_batch_end">
<code class="sig-name descname">on_batch_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/wandb_logger.html#WandbLogger.on_batch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.wandb_logger.WandbLogger.on_batch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Translate batch metrics to Weights &amp; Biases.</p>
</dd></dl>

<dl class="method">
<dt id="catalyst.contrib.callbacks.wandb_logger.WandbLogger.on_epoch_end">
<code class="sig-name descname">on_epoch_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/wandb_logger.html#WandbLogger.on_epoch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.wandb_logger.WandbLogger.on_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Translate epoch metrics to Weights &amp; Biases.</p>
</dd></dl>

<dl class="method">
<dt id="catalyst.contrib.callbacks.wandb_logger.WandbLogger.on_loader_end">
<code class="sig-name descname">on_loader_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/wandb_logger.html#WandbLogger.on_loader_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.wandb_logger.WandbLogger.on_loader_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Translate loader metrics to Weights &amp; Biases.</p>
</dd></dl>

<dl class="method">
<dt id="catalyst.contrib.callbacks.wandb_logger.WandbLogger.on_stage_end">
<code class="sig-name descname">on_stage_end</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/wandb_logger.html#WandbLogger.on_stage_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.wandb_logger.WandbLogger.on_stage_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Finish logging to Weights &amp; Biases.</p>
</dd></dl>

<dl class="method">
<dt id="catalyst.contrib.callbacks.wandb_logger.WandbLogger.on_stage_start">
<code class="sig-name descname">on_stage_start</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/callbacks/wandb_logger.html#WandbLogger.on_stage_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.callbacks.wandb_logger.WandbLogger.on_stage_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize Weights &amp; Biases.</p>
</dd></dl>

</dd></dl>

</div>
</div>
</div>


             </article>
             
            </div>
            <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="contrib.html" class="btn btn-neutral float-right" title="Contrib" accesskey="n" rel="next">Next <img src="../_static/images/chevron-right-orange.svg" class="next-page"></a>
      
      
        <a href="../faq/optuna.html" class="btn btn-neutral" title="Optuna integration" accesskey="p" rel="prev"><img src="../_static/images/chevron-right-orange.svg" class="previous-page"> Previous</a>
      
    </div>
  

  <hr>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, Scitator.

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
     

</footer>

          </div>
        </div>

        <div class="catalyst-content-right" id="catalyst-content-right">
          <div class="catalyst-right-menu" id="catalyst-right-menu">
            <div class="catalyst-side-scroll" id="catalyst-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">Callbacks</a><ul>
<li><a class="reference internal" href="#module-catalyst.callbacks">Main</a><ul>
<li><a class="reference internal" href="#module-catalyst.callbacks.batch_overfit">BatchOverfitCallback</a></li>
<li><a class="reference internal" href="#module-catalyst.callbacks.checkpoint">Checkpoint</a></li>
<li><a class="reference internal" href="#module-catalyst.callbacks.control_flow">Control Flow</a></li>
<li><a class="reference internal" href="#module-catalyst.callbacks.criterion">Criterion</a></li>
<li><a class="reference internal" href="#module-catalyst.callbacks.early_stop">Early Stop</a></li>
<li><a class="reference internal" href="#module-catalyst.callbacks.exception">Exception</a></li>
<li><a class="reference internal" href="#module-catalyst.callbacks.logging">Logging</a></li>
<li><a class="reference internal" href="#module-catalyst.callbacks.metric">Metric</a></li>
<li><a class="reference internal" href="#module-catalyst.callbacks.optimizer">Optimizer</a></li>
<li><a class="reference internal" href="#module-catalyst.callbacks.periodic_loader">PeriodicLoaderCallback</a></li>
<li><a class="reference internal" href="#module-catalyst.callbacks.pruning">Pruning</a></li>
<li><a class="reference internal" href="#module-catalyst.callbacks.quantization">Quantization</a></li>
<li><a class="reference internal" href="#module-catalyst.callbacks.scheduler">Scheduler</a></li>
<li><a class="reference internal" href="#module-catalyst.callbacks.timer">Timer</a></li>
<li><a class="reference internal" href="#module-catalyst.callbacks.tracing">Tracing</a></li>
<li><a class="reference internal" href="#module-catalyst.callbacks.validation">Validation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-catalyst.callbacks.metrics">Metrics</a><ul>
<li><a class="reference internal" href="#module-catalyst.callbacks.metrics.accuracy">Accuracy</a></li>
<li><a class="reference internal" href="#module-catalyst.callbacks.metrics.auc">AUC</a></li>
<li><a class="reference internal" href="#module-catalyst.callbacks.metrics.cmc_score">CMC score</a></li>
<li><a class="reference internal" href="#module-catalyst.callbacks.metrics.dice">Dice</a></li>
<li><a class="reference internal" href="#module-catalyst.callbacks.metrics.f1_score">F1 score</a></li>
<li><a class="reference internal" href="#module-catalyst.callbacks.metrics.iou">IOU</a></li>
<li><a class="reference internal" href="#module-catalyst.callbacks.metrics.mrr">MRR</a></li>
<li><a class="reference internal" href="#module-catalyst.callbacks.metrics.perplexity">Perplexity</a></li>
<li><a class="reference internal" href="#module-catalyst.callbacks.metrics.precision">Precision</a></li>
<li><a class="reference internal" href="#module-catalyst.callbacks.metrics.recall">Recall</a></li>
<li><a class="reference internal" href="#module-catalyst.callbacks.metrics.ppv_tpr_f1">Global precision, recall and F1-score</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-catalyst.contrib.callbacks">Contrib</a><ul>
<li><a class="reference internal" href="#module-catalyst.contrib.callbacks.alchemy_logger">AlchemyLogger</a></li>
<li><a class="reference internal" href="#module-catalyst.contrib.callbacks.confusion_matrix_logger">ConfusionMatrixCallback</a></li>
<li><a class="reference internal" href="#module-catalyst.contrib.callbacks.cutmix_callback">CutmixCallback</a></li>
<li><a class="reference internal" href="#module-catalyst.contrib.callbacks.gradnorm_logger">GradNormLogger</a></li>
<li><a class="reference internal" href="#module-catalyst.contrib.callbacks.inference_callback">InferCallback</a></li>
<li><a class="reference internal" href="#module-catalyst.contrib.callbacks.kornia_transform">BatchTransformCallback</a></li>
<li><a class="reference internal" href="#module-catalyst.contrib.callbacks.mask_inference">InferMaskCallback</a></li>
<li><a class="reference internal" href="#module-catalyst.contrib.callbacks.draw_masks_callback">DrawMasksCallback</a></li>
<li><a class="reference internal" href="#module-catalyst.contrib.callbacks.mixup_callback">MixupCallback</a></li>
<li><a class="reference internal" href="#module-catalyst.contrib.callbacks.neptune_logger">NeptuneLogger</a></li>
<li><a class="reference internal" href="#module-catalyst.contrib.callbacks.optuna_callback">OptunaCallback</a></li>
<li><a class="reference internal" href="#module-catalyst.contrib.callbacks.telegram_logger">TelegramLogger</a></li>
<li><a class="reference internal" href="#module-catalyst.contrib.callbacks.wandb_logger">WandbLogger</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
      </section>
    </div>

  


  

     
       <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
         <script type="text/javascript" src="../_static/jquery.js"></script>
         <script type="text/javascript" src="../_static/underscore.js"></script>
         <script type="text/javascript" src="../_static/doctools.js"></script>
         <script type="text/javascript" src="../_static/language_data.js"></script>
         <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
     

  

  <script type="text/javascript" src="../_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="../_static/js/vendor/bootstrap.min.js"></script>
  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <!-- Begin Footer -->

  <footer class="site-footer" id="site-footer">
    <div class="container footer-container">
      <div class="footer-logo-wrapper">
        <a href="https://catalyst-team.com/" class="footer-logo"></a>
      </div>

      <div class="footer-links-wrapper">
        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://github.com/catalyst-team">Ecosystem</a></li>
            <li><a class="nav-dropdown-item" href="https://alchemy.host">Alchemy</a></li>
            <li><a class="nav-dropdown-item" href="https://github.com/catalyst-team/catalyst">Catalyst</a></li>
            <li><a class="nav-dropdown-item" href="https://github.com/catalyst-team/reaction">Reaction</a></li>
          </ul>
        </div>

        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://github.com/catalyst-team">Projects</a></li>
            <li><a class="nav-dropdown-item" href="https://github.com/catalyst-team/codestyle">Codestyle</a></li>
            <li><a class="nav-dropdown-item" href="https://github.com/catalyst-team/neuro">Catalyst.Neuro</a></li>
            <li><a class="nav-dropdown-item" href="https://github.com/catalyst-team/classification">Classification</a></li>
            <li><a class="nav-dropdown-item" href="https://github.com/catalyst-team/detection">Detection</a></li>
            <li><a class="nav-dropdown-item" href="https://github.com/catalyst-team/segmentation">Segmentation</a></li>
            <li><a class="nav-dropdown-item" href="https://github.com/catalyst-team/gan">Catalyst.GAN</a></li>
          </ul>
        </div>

        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://catalyst-team.com/">Support</a></li>
            <li><a href="https://github.com/catalyst-team/catalyst/issues" target="_blank">Github Issues</a></li>
            <li><a href="https://github.com/catalyst-team/catalyst/blob/master/CONTRIBUTING.md" target="_blank">Contributing</a></li>
            <li><a href="https://www.patreon.com/catalyst_team" target="_blank">Patreon</a></li>
          </ul>
        </div>

        <div class="footer-links-col follow-us-col">
          <div class="footer-social-icons">
            <a href="https://t.me/catalyst_team" target="_blank" class="telegram"></a>
            <a href="https://twitter.com/catalyst_core" target="_blank" class="twitter"></a>
            <a href="https://join.slack.com/t/catalyst-team-core/shared_invite/zt-d9miirnn-z86oKDzFMKlMG4fgFdZafw" target="_blank" class="ods"></a>
          </div>
        </div>
      </div>
    </div>
  </footer>


  <!-- End Footer -->

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://catalyst-team.com/" aria-label="Catalyst"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="">Get Started</a>
          </li>

          <li>
            <a href="https://github.com/catalyst-team/catalyst">Github</a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="../_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      catalystAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.catalyst-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>